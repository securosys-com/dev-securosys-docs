"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[97907],{18898:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>a,toc:()=>h});const a=JSON.parse('{"id":"Tutorials/Import-Key-Material","title":"AWS BYOK - Import Key Material","description":"After wrapping the import key material, import the key material to use within AWS KMS. To import key material, upload the wrapped import key material from the chapter Export and Wrap Key Material and the import token that was downloaded in chapter Download the Public key and Import Token. It is important to import key material into the same KMS key that was specified when downloading the public key and import token, otherwise the import will fail.","source":"@site/aws-byok/Tutorials/Import-Key-Material.md","sourceDirName":"Tutorials","slug":"/Tutorials/Import-Key-Material","permalink":"/aws-byok/Tutorials/Import-Key-Material","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"AWS BYOK - Import Key Material","sidebar_label":"Import Key Material"},"sidebar":"tutorialSidebar","previous":{"title":"Export & Wrap Key Material","permalink":"/aws-byok/Tutorials/Export&Wrap"},"next":{"title":"Concepts","permalink":"/aws-byok/category/concepts"}}');var n=r(74848),o=r(28453),i=r(65537),s=r(79329);const l={sidebar_position:7,title:"AWS BYOK - Import Key Material",sidebar_label:"Import Key Material"},d="Import Key Material",c={},h=[];function p(e){const t={a:"a",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"import-key-material",children:"Import Key Material"})}),"\n",(0,n.jsxs)(t.p,{children:["After wrapping the import key material, import the key material to use within AWS KMS. To import key material, upload the wrapped import key material from the chapter ",(0,n.jsx)(t.a,{href:"/aws-byok/Tutorials/Export&Wrap",children:"Export and Wrap Key Material"})," and the import token that was downloaded in chapter ",(0,n.jsx)(t.a,{href:"/aws-byok/Tutorials/Download-Pub-key",children:"Download the Public key and Import Token"}),". It is important to import key material into the same KMS key that was specified when downloading the public key and import token, otherwise the import will fail."]}),"\n",(0,n.jsx)(t.p,{children:"When key material is imported, the key state of the KMS key changes to Enabled. The key is now available to use in cryptographic operations."}),"\n",(0,n.jsx)(t.p,{children:"When importing key material, it is possible to set an optional expiration date for the key material. When the key material expires, AWS KMS deletes the key material and the KMS key becomes unusable. To use the KMS key in cryptographic operations, reimport the same key material. After importing the key material, it is not possible to set, change, or cancel the expiration date for the current import. To change these values, delete and reimport the same key material."}),"\n",(0,n.jsxs)(t.p,{children:["To import key material, use either the AWS KMS console or the ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," API request."]}),"\n",(0,n.jsxs)(t.p,{children:["When importing the key material, an ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," entry is added to the AWS CloudTrail log to record the ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," operation. The CloudTrail entry is the same whether using the AWS KMS console or the AWS KMS API."]}),"\n",(0,n.jsx)(t.p,{children:"After a successful import of the encrypted key material to the AWS KMS, it uses your corresponding account private key to decrypt the encrypted key material."}),"\n",(0,n.jsxs)(i.A,{groupId:"device-setup",children:[(0,n.jsxs)(s.A,{value:"ui",label:"Import (via API)",default:!0,children:[(0,n.jsxs)(t.p,{children:["To import key material, use the ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," request. The following example uses the AWS CLI.\nTo import the key material please use this example, please replace the variables with your own:"]}),(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"$ aws kms import-key-material --key-id 1234abcd-12ab-34cd-56ef-1234567890ab \\\n    --encrypted-key-material EncryptedKeyMaterial.bin \\\n    --import-token ImportToken.bin \\\n    --expiration-model KEY_MATERIAL_EXPIRES \\\n    --valid-to 2022-09-17T12:00:00-08:00\n"})}),(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Parameter"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--key-id"})}),(0,n.jsxs)(t.td,{children:["Replace ",(0,n.jsx)(t.code,{children:"1234abcd-12ab-34cd-56ef-1234567890ab"})," with a key ID of the KMS key that you specified when you downloaded the public key and import token. To identify the KMS key, use its key ID or key ARN."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--encrypted-key-material"})}),(0,n.jsxs)(t.td,{children:["Replace ",(0,n.jsx)(t.code,{children:"EncryptedKeyMaterial.bin"})," with the name of the file that contains the encrypted key material."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--import-token"})}),(0,n.jsxs)(t.td,{children:["Replace ",(0,n.jsx)(t.code,{children:"ImportToken.bin"})," with the name of the file that contains the import token."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--expiration-model"})}),(0,n.jsxs)(t.td,{children:["To enable expiration of the imported key material, insert the value of the",(0,n.jsx)(t.code,{children:" --expiration-model"})," parameter to its default value, ",(0,n.jsx)(t.code,{children:"KEY_MATERIAL_EXPIRES"}),", or omit the parameter. To set the imported key material so it does not expire, insert the value of the parameter to ",(0,n.jsx)(t.code,{children:"KEY_MATERIAL_DOES_NOT_EXPIRE"}),"."]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--valid-to"})}),(0,n.jsxs)(t.td,{children:["If the ",(0,n.jsx)(t.code,{children:"--expiration-model"})," parameter was set to ",(0,n.jsx)(t.code,{children:"KEY_MATERIAL_EXPIRES"})," then introduce the ",(0,n.jsx)(t.code,{children:"--valid-to"})," parameter to the command and replace the example date to the desired key expiration date and time. The date and time can be up to a maximum of 365 days from the time of the request. The parameter value corresponds to ISO 8601. Omit the ",(0,n.jsx)(t.code,{children:"--valid-to"})," parameter from the command, if parameter ",(0,n.jsx)(t.code,{children:"--expiration-model"})," wasn\u2019t added."]})]})]})]}),(0,n.jsxs)(t.p,{children:["If the key import was successful the key state of the KMS key changes to ",(0,n.jsx)(t.code,{children:"Enabled"}),", and the KMS key is now available to use in cryptographic operations. An ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," entry has been added to the AWS CloudTrail log to record the ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," operation."]})]}),(0,n.jsxs)(s.A,{value:"console",label:"Import (via Console)",default:!0,children:[(0,n.jsx)(t.p,{children:"To import key material with the AWS Management Console please follow these next steps:"}),(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["If you are on the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Download wrapping key and import token"})})," page, skip to Step 8."]}),"\n",(0,n.jsx)(t.li,{children:"Sign in to the AWS Management Console and open the AWS Key Management Service (AWS KMS) console."}),"\n",(0,n.jsx)(t.li,{children:"To change the AWS Region, use the Region selector in the upper-right corner of the page."}),"\n",(0,n.jsxs)(t.li,{children:["In the navigation pane, choose ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Customer managed keys"})}),"."]}),"\n",(0,n.jsx)(t.li,{children:"Choose the key ID or alias of the KMS key for which you downloaded the public key and import token."}),"\n",(0,n.jsxs)(t.li,{children:["Choose the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Cryptographic configuration"})})," tab and view its values. The tabs are on the detail page for a KMS key below the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"General configuration"})})," section."]}),"\n",(0,n.jsxs)(t.li,{children:["Choose the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Key material"})})," tab and then choose ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Upload key material"})}),".","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["In the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Encrypted key material and import token"})})," section, under ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Wrapped key material"})}),", select ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Choose file"})}),". Then upload the file that contains your wrapped (encrypted) key material."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["In the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Encrypted key material and import token"})})," section, under ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Import token"})}),", select ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Choose file"})}),". Upload the file that contains the import token that was downloaded in chapter ",(0,n.jsx)(t.a,{href:"/aws-byok/Tutorials/Download-Pub-key",children:"Download the Public key and Import Token"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["In the ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Expiration option"})})," section, determine whether the key material should expire. To set an expiration date and time, choose ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Key material expires"})}),", and use the calendar to select a date and time. It is possible to specify a date up to 365 days from the current date and time."]}),"\n",(0,n.jsxs)(t.li,{children:["Choose ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Finish"})})," or ",(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"Upload key material"})}),"."]}),"\n"]}),(0,n.jsxs)(t.p,{children:["If the key import was successful the key state of the KMS key changes to ",(0,n.jsx)(t.code,{children:"Enabled"}),", and the KMS key is now available to use in cryptographic operations. An ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," entry has been added to the AWS CloudTrail log to record the ",(0,n.jsx)(t.code,{children:"ImportKeyMaterial"})," operation."]})]})]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>s});var a=r(96540);const n={},o=a.createContext(n);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(o.Provider,{value:t},e.children)}},65537:(e,t,r)=>{r.d(t,{A:()=>w});var a=r(96540),n=r(34164),o=r(65627),i=r(56347),s=r(50372),l=r(30604),d=r(11861),c=r(78749);function h(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:r}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:r,attributes:a,default:n}}=e;return{value:t,label:r,attributes:a,default:n}}))}(r);return function(e){const t=(0,d.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function u(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:r}=e;const n=(0,i.W6)(),o=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l.aZ)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(n.location.search);t.set(o,e),n.replace({...n.location,search:t.toString()})}),[o,n])]}function y(e){const{defaultValue:t,queryString:r=!1,groupId:n}=e,o=p(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!u({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[d,h]=m({queryString:r,groupId:n}),[y,x]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,o]=(0,c.Dv)(r);return[n,(0,a.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:n}),f=(()=>{const e=d??y;return u({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{f&&l(f)}),[f]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!u({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),x(e)}),[h,x,o]),tabValues:o}}var x=r(9136);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=r(74848);function j(e){let{className:t,block:r,selectedValue:a,selectValue:i,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),c=e=>{const t=e.currentTarget,r=l.indexOf(t),n=s[r].value;n!==a&&(d(t),i(n))},h=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;t=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;t=l[r]??l[l.length-1];break}}t?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":r},t),children:s.map((e=>{let{value:t,label:r,attributes:o}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{l.push(e)},onKeyDown:h,onClick:c,...o,className:(0,n.A)("tabs__item",f.tabItem,o?.className,{"tabs__item--active":a===t}),children:r??t},t)}))})}function k(e){let{lazy:t,children:r,selectedValue:o}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:(0,n.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function g(e){const t=y(e);return(0,b.jsxs)("div",{className:(0,n.A)("tabs-container",f.tabList),children:[(0,b.jsx)(j,{...t,...e}),(0,b.jsx)(k,{...t,...e})]})}function w(e){const t=(0,x.A)();return(0,b.jsx)(g,{...e,children:h(e.children)},String(t))}},79329:(e,t,r)=>{r.d(t,{A:()=>i});r(96540);var a=r(34164);const n={tabItem:"tabItem_Ymn6"};var o=r(74848);function i(e){let{children:t,hidden:r,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(n.tabItem,i),hidden:r,children:t})}}}]);