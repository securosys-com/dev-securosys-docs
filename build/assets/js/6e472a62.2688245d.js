"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[2652],{236:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>p,contentTitle:()=>t,default:()=>c,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Use-Cases/EMV","title":"EMV and Primus Tools","description":"EMV with Securosys Primus Tools and Hardware Security Modules (HSMs)","source":"@site/primus-tools/Use-Cases/EMV.md","sourceDirName":"Use-Cases","slug":"/Use-Cases/EMV","permalink":"/primus-tools/Use-Cases/EMV","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"EMV and Primus Tools","sidebar_label":"EMV","description":"EMV with Securosys Primus Tools and Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Salesforce - BYOK","permalink":"/primus-tools/Use-Cases/Salesforce-byok"},"next":{"title":"Self-Signed Certificate","permalink":"/primus-tools/Use-Cases/certificate-sign-request"}}');var a=n(74848),o=n(28453);const i={sidebar_position:4,title:"EMV and Primus Tools",sidebar_label:"EMV",description:"EMV with Securosys Primus Tools and Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},t="EMV",p={},d=[{value:"EMV Procedure Example",id:"emv-procedure-example",level:2},{value:"Import Split Key ZMK1",id:"import-split-key-zmk1",level:3},{value:"Import Split Key ZMK2",id:"import-split-key-zmk2",level:3},{value:"Import Wrapped Key",id:"import-wrapped-key",level:3},{value:"Import Wrapped Key (DDEA wrapped with ZMK2/AES-128)",id:"import-wrapped-key-ddea-wrapped-with-zmk2aes-128",level:3},{value:"Re-Export Imported Key",id:"re-export-imported-key",level:3},{value:"List Keys",id:"list-keys",level:3}];function l(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"emv",children:"EMV"})}),"\n",(0,a.jsx)(s.p,{children:"EMV standards from the payment sector also define procedures and key ceremonies how to import, export and transfer keys between two entities."}),"\n",(0,a.jsx)(s.p,{children:"EMV is a trademark of EMVCo LLC, the regulator agency, originally formed by Europay International, Master-\nCard International and Visa International, to manage, maintain and enhance the EMV Integrated Circuit Card\nspecification for Payment Systems"}),"\n",(0,a.jsxs)(s.p,{children:["Commands will require an established HSM connection and credentials to be able to execute properly. For further assistance on how to configure your HSM connection and credentials please see ",(0,a.jsx)(s.a,{href:"/primus-tools/Installation/Provider",children:"HSM Connection and Access Credentials"}),"."]}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsx)(s.p,{children:"TDEA and DDEA keys and algorithms are outdated and just supported for migration compatibility."})}),"\n",(0,a.jsx)(s.p,{children:"With EMV-related commands perform import or export of a split 3DES key into or out of the HSM."}),"\n",(0,a.jsx)(s.h2,{id:"emv-procedure-example",children:"EMV Procedure Example"}),"\n",(0,a.jsxs)(s.p,{children:["Prepare the credentials in blinded files stored on a USB drive ",(0,a.jsx)(s.code,{children:"D:\\"})," (Windows OS; path notations differ on Linux)."]}),"\n",(0,a.jsx)(s.p,{children:"Having the temporary Setup Password noted in the below format, e.g.:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"g3z7Y-5knqc-hkQAs-9A4kE-Ppr6v \n"})}),"\n",(0,a.jsxs)(s.p,{children:["Blinding and storing the temporary Setup Password to ",(0,a.jsx)(s.code,{children:"D:\\pwsetup"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar BlindPassword consoleinput: -outputfile d:\\pwsetup\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Results in having a file ",(0,a.jsx)(s.code,{children:"D:\\pwsetup"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"blinded-aes:c775dbe31d545d38dcb342ccadee236e3ec\u2026\u20266005d6766808e7fc522ef60d5a670b6e9c111837fe451041\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Blinding and storing the Proxy Password to ",(0,a.jsx)(s.code,{children:"D:\\pwproxy"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar BlindPassword consoleinput: -outputfile d:\\pwproxy\n"})}),"\n",(0,a.jsxs)(s.p,{children:["As the setup password will expire you may want to retrieve the permanent secret, which does not expire, blinded and stored to ",(0,a.jsx)(s.code,{children:"D:\\pwsecret"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar GetUserSecret /\n-host a-api.cloudshsm.com -port 2300 /\n-user DEMO-TEST -password consoleinput: /\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy /\n-blinded -outputfile d:\\pwsecret\n"})}),"\n",(0,a.jsxs)(s.p,{children:["In the following examples, the file ",(0,a.jsx)(s.code,{children:"pwsetup"})," should be swapped with the permanent secret blinded file ",(0,a.jsx)(s.code,{children:"pwsecret"}),"."]}),"\n",(0,a.jsx)(s.h3,{id:"import-split-key-zmk1",children:"Import Split Key ZMK1"}),"\n",(0,a.jsxs)(s.p,{children:["Import a split key named ",(0,a.jsx)(s.code,{children:"myZMK1-2DES"})," as a 16 Byte DDEA Type (112-bit 2DES Key):"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ImportKeySplit \n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-deskeyname myZMK1-2DES\n"})}),"\n",(0,a.jsx)(s.p,{children:"Output of command - insert required components:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"Please enter Component 1:   0CD215E5BD36125B732E40DD8165E779\nPlease enter KCV 1:         148887\n\nPlease enter Component 2:   107FC8809EE74017940E473B727201B7\nPlease enter KCV 2:         123BEC\n\nPlease enter Component 3:   B60777CF897BF8E65C9BBC5D48AC5D75\nPlease enter KCV 3:         497DAB\n\noverall KCV: E1CC69\n\nkey myZMK-2DES successfully imported\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsx)(s.p,{children:"The component and KCV values are not visible."})}),"\n",(0,a.jsxs)(s.p,{children:["DDEA plain key/KCV in this example: ",(0,a.jsx)(s.code,{children:"AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB / E1CC69"})]}),"\n",(0,a.jsx)(s.h3,{id:"import-split-key-zmk2",children:"Import Split Key ZMK2"}),"\n",(0,a.jsxs)(s.p,{children:["Import a split key named ",(0,a.jsx)(s.code,{children:"myZMK2-AES128"})," as a 16 Byte AES-128 Type:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ImportKeySplit \n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-aeskeyname myZMK2-AES128\n"})}),"\n",(0,a.jsx)(s.p,{children:"Output of command - insert required components:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"Please enter Component 1:   DF766747988EA9B5E898F6015BB122DD\nPlease enter KCV 1:         097915\n\nPlease enter Component 2:   B3D486605DEA808E075141AEB70C1605\nPlease enter KCV 2:         CD5452\n\nPlease enter Component 3:   75C329A701615AC7C76B525A11AA9493\nPlease enter KCV 3:         9BBE82\n\noverall KCV: 9604F9\n\nkey myZMK-AES128 successfully imported\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsx)(s.p,{children:"The component and KCV values are not visible."})}),"\n",(0,a.jsxs)(s.p,{children:["AES-128 plain key/KCV in this example: ",(0,a.jsx)(s.code,{children:"1961C880C40573FC28A2E5F5FD17A04B / 9604F9"})]}),"\n",(0,a.jsx)(s.h3,{id:"import-wrapped-key",children:"Import Wrapped Key"}),"\n",(0,a.jsxs)(s.p,{children:["Import the wrapped key named ",(0,a.jsx)(s.code,{children:"myZMK1-Imp-2DES"})," as DDEA wrapped with ZMK1/DDEA:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ImportKeyWrapped \n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-zmkname myZMK1-2DES\n-key 79BD62F07F33FD7323DF0634ED50BE8D -kcv DBCDB0\n-keyname myZMK1-Imp-2DES -keytype DDEA -ecb\n"})}),"\n",(0,a.jsx)(s.p,{children:"Output of command:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"key myZMK1-Imp-2DES successfully imported\n"})}),"\n",(0,a.jsxs)(s.p,{children:["2DES plain key/KCV in this example: ",(0,a.jsx)(s.code,{children:"AAAAAAAAAAAAAAAACCCCCCCCCCCCCCCC / DBCDB0"})]}),"\n",(0,a.jsx)(s.h3,{id:"import-wrapped-key-ddea-wrapped-with-zmk2aes-128",children:"Import Wrapped Key (DDEA wrapped with ZMK2/AES-128)"}),"\n",(0,a.jsxs)(s.p,{children:["Import the wrapped key named ",(0,a.jsx)(s.code,{children:"myZMK2-Imp-2DES"})," as DDEA wrapped with ZMK2/AES-128:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ImportKeyWrapped \n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-zmkname myZMK2-AES-128\n-key 8CAA88DD20222C4529F83D228D70BC53 -kcv DBCDB0\n-keyname myZMK2-Imp-2DES -keytype DDEA -ecb\n"})}),"\n",(0,a.jsx)(s.p,{children:"Output of command:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"key myZMK1-Imp-2DES successfully imported\n"})}),"\n",(0,a.jsxs)(s.p,{children:["2DES plain key/KCV in this example: ",(0,a.jsx)(s.code,{children:"AAAAAAAAAAAAAAAACCCCCCCCCCCCCCCC / DBCDB0"})]}),"\n",(0,a.jsx)(s.h3,{id:"re-export-imported-key",children:"Re-Export Imported Key"}),"\n",(0,a.jsxs)(s.p,{children:["Export a key named ",(0,a.jsx)(s.code,{children:"ZMK1-Imp-2DES"})," wrapped with ",(0,a.jsx)(s.code,{children:"ZMK2-AES128"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ExportKeyWrapped \n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-zmkname myZMK2-AES128\n-keyname myZMK1-Imp-2DES\n-ecb\n\n8CAA88DD20222C4529F83D228D70BC53\n\nKCV: DBCDB0\n"})}),"\n",(0,a.jsxs)(s.p,{children:["2DES plain key/KCV in this example: ",(0,a.jsx)(s.code,{children:"AAAAAAAAAAAAAAAACCCCCCCCCCCCCCCC / DBCDB0"})]}),"\n",(0,a.jsx)(s.h3,{id:"list-keys",children:"List Keys"}),"\n",(0,a.jsx)(s.p,{children:"List keys on the partition to verify changes:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"java -jar primus-tools.jar ListKeyStoreObjects\n-host a-api.cloudshsm.com -port 2300\n-user DEMO-TEST -password file:d:\\pwsetup\n-primusproxyuser DEMO-TESTP -primusproxypassword file:d:\\pwproxy\n-keysonly -prefixes\n"})}),"\n",(0,a.jsx)(s.p,{children:"Output:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"ONAME: myZMK1-2DES OTYPE: DDEA KSIZE: 112 OFLAGS: unextractable OHASH: BB4AE3\nONAME: myZMK1-Imp-2DES OTYPE: DDEA KSIZE: 112 OFLAGS: encrypted-extractable OHASH: 77CF89\nONAME: myZMK2-AES128 OTYPE: AES KSIZE: 128 OFLAGS: unextractable OHASH: 0469C2\n"})})]})}function c(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>t});var r=n(96540);const a={},o=r.createContext(a);function i(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);