"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[1288],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(96540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},28993:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>f,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Tutorials/Signing-files","title":"How to sign Files with Microsoft SignTool?","description":"Learn how to sign files with Microsoft SignTool and Securosys Hardware Security Modules (HSMs)","source":"@site/ms-signtool/Tutorials/Signing-files.md","sourceDirName":"Tutorials","slug":"/Tutorials/Signing-files","permalink":"/ms-signtool/Tutorials/Signing-files","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"How to sign Files with Microsoft SignTool?","sidebar_label":"Signing Files","description":"Learn how to sign files with Microsoft SignTool and Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Tutorial","permalink":"/ms-signtool/category/tutorial"},"next":{"title":"Concepts","permalink":"/ms-signtool/category/concepts"}}');var s=t(74848),r=t(28453),o=t(65537),a=t(79329);const l={sidebar_position:0,title:"How to sign Files with Microsoft SignTool?",sidebar_label:"Signing Files",description:"Learn how to sign files with Microsoft SignTool and Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},c="How to Sign Files with Microsoft SignTool?",u={},d=[{value:"Verifying Signed File",id:"verifying-signed-file",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"how-to-sign-files-with-microsoft-signtool",children:"How to Sign Files with Microsoft SignTool?"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"signtool.exe"})," is used to sign or timestamp codes, certificates, etc. Depending on the OS version the tool may be located in different folders (e.g. Windows 10/x64: ",(0,s.jsx)(n.code,{children:"C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64\\signtool.exe"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:["For more information on the tool location, please refer to the ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/windows/win32/seccrypto/signtool",children:"Microsoft documentation"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Example \u2013 with certificate reference by subject name:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'signtool.exe sign /v /fd sha256 /sm /n "signtooldemo.hsmdemo.test" Application-ToSign.exe\n\nThe following certificate was selected:\n    Issued to: signtooldemo.hsmdemo.test\n    Issued by: signtooldemo.hsmdemo.test\n    Expires:   Thu Feb 14 16:31:30 2019\n    SHA1 hash: CB1A55F6AB8CCACEDAB3FCD9DE48BD69BE16B88D\n\nDone Adding Additional Store\nSuccessfully signed: ApplicationToSign.exe\n\nNumber of files successfully Signed: 1\nNumber of warnings: 0\nNumber of errors: 0\n'})}),"\n",(0,s.jsx)(n.p,{children:"Example \u2013 with certificate reference by SHA1 hash:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'signtool.exe sign /v /fd sha256 /sm /sha1 "cb1a55f6ab8ccacedab3fcd9de48bd69be16b88d" ApplicationToSign.exe\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Take care, that the certificate references are unique, otherwise, the signing process could fail (subject name, or sha1 value of the certificate). Referencing the certificate by CSP (/csp) and key container (/kc) seems to fail (reason yet not known)."})}),"\n",(0,s.jsxs)(n.p,{children:["For signing and verification options, please refer to ",(0,s.jsx)(n.code,{children:"signtool.exe"})," help and the ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/windows/win32/seccrypto/signtool",children:"Microsoft documentation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"verifying-signed-file",children:"Verifying Signed File"}),"\n",(0,s.jsx)(n.p,{children:"The signature can be verified either on the command line or using the file properties dialog (Digital Signatures). The signature can be verified either via Graphical User Interface (GUI) or via Command line interface (CLI)."}),"\n",(0,s.jsx)(n.p,{children:"Here is an example for each case:"}),"\n",(0,s.jsxs)(o.A,{groupId:"device-setup",children:[(0,s.jsxs)(a.A,{value:"ui",label:"Graphical User Interface (GUI)",default:!0,children:[(0,s.jsx)(n.p,{children:"Below is an example of how to verify using the file properties:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Navigate to the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"properties"})})," of the signed file you would like to verify,"]}),"\n",(0,s.jsxs)(n.li,{children:["Open the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Digital Signatures"})})," tab,"]}),"\n",(0,s.jsxs)(n.li,{children:["Double click the signature in the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"Signature list"})}),","]}),"\n",(0,s.jsxs)(n.li,{children:["On the ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"General"})})," tab click on ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"View Certificate"})}),","]}),"\n",(0,s.jsxs)(n.li,{children:["The certificate information is shown.\n",(0,s.jsx)(n.img,{src:t(88982).A+"",width:"530",height:"629"})]}),"\n"]})]}),(0,s.jsxs)(a.A,{value:"cli",label:"Command Line Interface (CLI)",default:!0,children:[(0,s.jsxs)(n.p,{children:["Verification can also be done via CLI using ",(0,s.jsx)(n.code,{children:"signtool.exe"}),". Example of how to verify the signature via CLI:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"signtool.exe verify /pa /v ApplicationToSign.exe\nVerifying: ApplicationToSign.exe\nSignature Index: 0 (Primary Signature)\nHash of file (sha256): 02B5134F2AB32A9638284AC016BDFA528F963016D17885F9C009167108A1BC85\n\nSigning Certificate Chain:\n    Issued to: signtooldemo.hsmdemo.test\n    Issued by: signtooldemo.hsmdemo.test\n    Expires:   Thu Feb 14 16:31:30 2019\n    SHA1 hash: CB1A55F6AB8CCACEDAB3FCD9DE48BD69BE16B88D\n\nFile is not timestamped.\n\nSuccessfully verified: ApplicationToSign.exe\n\nNumber of files successfully Verified: 1\nNumber of warnings: 0\nNumber of errors: 0\n"})})]})]})]})}function f(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},65537:(e,n,t)=>{t.d(n,{A:()=>j});var i=t(96540),s=t(34164),r=t(65627),o=t(56347),a=t(50372),l=t(30604),c=t(11861),u=t(78749);function d(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:s}}=e;return{value:n,label:t,attributes:i,default:s}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function f(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const s=(0,o.W6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(r),(0,i.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(s.location.search);n.set(r,e),s.replace({...s.location,search:n.toString()})}),[r,s])]}function p(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=h(e),[o,l]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!f({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:r}))),[c,d]=g({queryString:t,groupId:s}),[p,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,r]=(0,u.Dv)(t);return[s,(0,i.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:s}),b=(()=>{const e=c??p;return f({value:e,tabValues:r})?e:null})();(0,a.A)((()=>{b&&l(b)}),[b]);return{selectedValue:o,selectValue:(0,i.useCallback)((e=>{if(!f({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,r]),tabValues:r}}var m=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function v(e){let{className:n,block:t,selectedValue:i,selectValue:o,tabValues:a}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),s=a[t].value;s!==i&&(c(n),o(s))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:a.map((e=>{let{value:n,label:t,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...r,className:(0,s.A)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:r}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===r));return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function y(e){const n=p(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,x.jsx)(v,{...n,...e}),(0,x.jsx)(w,{...n,...e})]})}function j(e){const n=(0,m.A)();return(0,x.jsx)(y,{...e,children:d(e.children)},String(n))}},79329:(e,n,t)=>{t.d(n,{A:()=>o});t(96540);var i=t(34164);const s={tabItem:"tabItem_Ymn6"};var r=t(74848);function o(e){let{children:n,hidden:t,className:o}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(s.tabItem,o),hidden:t,children:n})}},88982:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/Verify-d057ee3d7e85a7c820edb7b3cdb7f072.png"}}]);