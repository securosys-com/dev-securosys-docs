"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[80837],{28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(96540);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}},59495:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"Tutorials/Wrapping/wrap-unwrap","title":"Wrapping with Hardware Security Module (HSM)","description":"Learn about managing keys securely with Hardware Security Modules (HSMs) for key wrapping and unwrapping.","source":"@site/tsb/Tutorials/Wrapping/wrap-unwrap.md","sourceDirName":"Tutorials/Wrapping","slug":"/Tutorials/Wrapping/wrap-unwrap","permalink":"/tsb/Tutorials/Wrapping/wrap-unwrap","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Wrapping with Hardware Security Module (HSM)","sidebar_label":"Wrap & Unwrap","description":"Learn about managing keys securely with Hardware Security Modules (HSMs) for key wrapping and unwrapping.","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","REST API license","EC Key","Elliptic Curve","create key request","sign request","verify signature","synchronous sign","signature algorithm","supported EC-Curves"]},"sidebar":"tutorialSidebar","previous":{"title":"Sign & Verify","permalink":"/tsb/Tutorials/Signing/SignRequest"},"next":{"title":"Concepts","permalink":"/tsb/category/concepts"}}');var a=r(74848),t=r(28453);const i={sidebar_position:0,title:"Wrapping with Hardware Security Module (HSM)",sidebar_label:"Wrap & Unwrap",description:"Learn about managing keys securely with Hardware Security Modules (HSMs) for key wrapping and unwrapping.",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","REST API license","EC Key","Elliptic Curve","create key request","sign request","verify signature","synchronous sign","signature algorithm","supported EC-Curves"]},l="Wrap & Unwrap",c={},p=[{value:"Create AES Wrapping Key",id:"create-aes-wrapping-key",level:2},{value:"Create Key to be Wrapped (EC-Key)",id:"create-key-to-be-wrapped-ec-key",level:2},{value:"Create Wrap Request (AES Wraps EC)",id:"create-wrap-request-aes-wraps-ec",level:2},{value:"Create Unwrap Request (AES Unwraps EC)",id:"create-unwrap-request-aes-unwraps-ec",level:2},{value:"Fetch Attributes of Unwrap Key",id:"fetch-attributes-of-unwrap-key",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"wrap--unwrap",children:"Wrap & Unwrap"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"REST_API"})," license is required to create and use keys without policy."]}),"\n",(0,a.jsxs)(n.p,{children:["In this example we are using an Symmetric AES-Key to Wrap an EC-Key, using the wrapping method ",(0,a.jsx)(n.code,{children:"AES_WRAP_EC"}),". Different algorithm requires different wrapping methods such as:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["AES_WRAP, AES_WRAP_",(0,a.jsx)(n.strong,{children:"DSA"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"EC"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"ED"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"RSA"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"BLS"}),", AES_WRAP_PAD, AES_WRAP_",(0,a.jsx)(n.strong,{children:"PAD_DSA"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"PAD_EC"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"PAD_ED"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"PAD_RSA"}),", AES_WRAP_",(0,a.jsx)(n.strong,{children:"PAD_BLS"}),","]}),"\n",(0,a.jsxs)(n.li,{children:["RSA_WRAP_",(0,a.jsx)(n.strong,{children:"PAD"}),", RSA_WRAP_",(0,a.jsx)(n.strong,{children:"OAEP"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"create-aes-wrapping-key",children:"Create AES Wrapping Key"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"POST"}),": ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Description"}),": Create key request."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Instead of creating an AES-Key, the wrapping-key can be imported. ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/importPlainKey",children:"/v1/import/plain"})]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "label": "kms-wrapping-key-aes",\n    "algorithm": "AES",\n    "keySize": 256,\n    "attributes": {\n        "encrypt": true,\n        "decrypt": true,\n        "verify": true,\n        "sign": false,\n        "wrap": true,\n        "unwrap": true,\n        "derive": false,\n        "bip32": false,\n        "slip10": false,\n        "extractable": true,\n        "modifiable": true,\n        "destroyable": true,\n        "sensitive": true,\n        "copyable": true\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-key-to-be-wrapped-ec-key",children:"Create Key to be Wrapped (EC-Key)"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"POST"}),": ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Description"}),": Create key request."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "label": "test-ec-key",\n    "algorithm": "EC",\n    "curveOid": "1.3.132.0.10",\n        "attributes": {\n        "encrypt": true,\n        "decrypt": true,\n        "verify": true,\n        "sign": true,\n        "wrap": true,\n        "unwrap": true,\n        "derive": true,\n        "bip32": true,\n        "slip10": false,\n        "extractable": true,\n        "modifiable": true,\n        "destroyable": true,\n        "sensitive": false,\n        "copyable": true,\n        "neverExtractable": false,\n        "alwaysSensitive": false\n        }\n    }\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-wrap-request-aes-wraps-ec",children:"Create Wrap Request (AES Wraps EC)"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"POST"}),": ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/wrap",children:"/v1/wrap"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Description"}),": Create wrap request"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "wrapKeyRequest": {\n        "keyToBeWrapped": "test-ec-key",\n        "wrapKeyName": "kms-wrapping-key-aes",\n        "wrapMethod": "AES_WRAP_EC"\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Response:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n  "wrappedKey": "FgqsoaNa7nA2RoHnUUWUpnZXz6RvkPNma5bLOFwU4+xSGt7O3+WKmq3SSWe9BEHSvdhKE7cTGyvaJIt2QX0XpXh6eYKXmgSwGqfsPxuAFXXAyZg+PXdrpF5waqvTVLjG/UufzRGiEiJmQ2vLsxtkFgqNy8SwPeWi7IZ9jC62QZQ0psH0EuYBCG/bzx/FaVRRozmK4SlgvVzcwGDA5JdpOQJwCg9jKAkIiDrnN8uzfnm3vpkpoV0kgg=="\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"create-unwrap-request-aes-unwraps-ec",children:"Create Unwrap Request (AES Unwraps EC)"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"POST"}),": ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/synchronousUnwrap",children:"/v1/unwrap"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Description"}),": Create unwrap request"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n  "unwrapKeyRequest": {\n    "wrappedKey": "FgqsoaNa7nA2RoHnUUWUpnZXz6RvkPNma5bLOFwU4+xSGt7O3+WKmq3SSWe9BEHSvdhKE7cTGyvaJIt2QX0XpXh6eYKXmgSwGqfsPxuAFXXAyZg+PXdrpF5waqvTVLjG/UufzRGiEiJmQ2vLsxtkFgqNy8SwPeWi7IZ9jC62QZQ0psH0EuYBCG/bzx/FaVRRozmK4SlgvVzcwGDA5JdpOQJwCg9jKAkIiDrnN8uzfnm3vpkpoV0kgg==",\n    "label": "unwrapped-ec-key",\n    "attributes": {\n        "encrypt": true,\n        "decrypt": true,\n        "verify": true,\n        "sign": true,\n        "wrap": true,\n        "unwrap": true,\n        "derive": false,\n        "bip32": false,\n        "slip10": false,\n        "extractable": false,\n        "modifiable": true,\n        "destroyable": false,\n        "sensitive": true,\n        "copyable": false\n    },\n    "unwrapKeyName": "kms-wrapping-key-aes",\n    "wrapMethod": "AES_WRAP_EC"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"fetch-attributes-of-unwrap-key",children:"Fetch Attributes of Unwrap Key"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"POST"}),": ",(0,a.jsx)(n.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/getKeyAttributesWithKeyPassword",children:"/v1/key/attributes"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Description"}),": Create unwrap request"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n  "label": "unwrapped-ec-key"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Response:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'{\n    "label": "unwrapped-ec-key",\n    "id": null,\n    "uuid": null,\n    "algorithm": "EC",\n    "algorithmOid": "1.2.840.10045.2.1",\n    "curveOid": "1.3.132.0.10",\n    "derivedAttributes": null,\n    "keySize": null,\n    "keyUsageCount": 0,\n    "createTime": "2024-11-21T12:05:20Z",\n    "attestTime": "2024-11-21T12:06:46Z",\n    "publicKey": "MFYwEAYHKoZIzj0CAQYFK4EEAAoDQgAE1JcyDgnYVd+GMis78x6ZkPMPBbAjJsgt7vDZKo8GtkZoN9lnR1ZyvVqGYk/iyS6DB2A4SA5JEnKil29LQsGH0g==",\n    "addressTruncated": null,\n    "attributes": {\n      "decrypt": true,\n      "sign": true,\n      "ekaSign": null,\n      "unwrap": true,\n      "derive": false,\n      "sensitive": true,\n      "alwaysSensitive": false,\n      "extractable": false,\n      "neverExtractable": false,\n      "modifiable": true,\n      "copyable": false,\n      "destroyable": false\n    },\n    "policy": null\n  },\n  "xmlSignature": "cXC7BlSUlKy+v28BsUeYw301nhioBCxsq2CBAkGvppIcjQV6gxl4f786uiZLSDAGxwwlXD/hr2GyTut5xOn7i+79xMUckiWKCfoab/YSBqS/Cu6AY2dAUFQA0suxh8v1ptbpTdv1oJwie+x3vU/ABfgARbb4LLkSa9iP5OVTypH9RTu0Ayhk2un6YlIcNuL0n0TJcKN3dSIDbIcOdIWzr9pKsq+ahzRAWKMRjzHLQKwbz/yVQ9vH6TMycCb+xKlVPyaFQFU/xZIimaMyGos4ORNTll3DgF4pGak/YPku9KnpkW+/uzvGuGYMgu40iccm74Rc5a1Wj4DmATSMon7myg==",\n  "attestationKeyName": "attestation-key"\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}}}]);