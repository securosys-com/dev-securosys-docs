"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[628],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>c});var a=s(96540);const i={},t=a.createContext(i);function r(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(t.Provider,{value:n},e.children)}},50412:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"Tutorials/Mac/hmac","title":"Sign a Payload with HMAC","description":"Learn how to sign a payload using REST API and HMAC keys.","source":"@site/tsb/Tutorials/Mac/hmac.md","sourceDirName":"Tutorials/Mac","slug":"/Tutorials/Mac/hmac","permalink":"/tsb/Tutorials/Mac/hmac","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Sign a Payload with HMAC","sidebar_label":"HMAC Signing","description":"Learn how to sign a payload using REST API and HMAC keys.","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hmac signing","REST API","create HMAC key","cloud security","digital signatures","cryptographic operations","secure signing"]},"sidebar":"tutorialSidebar","previous":{"title":"Import Locally Generated Keys","permalink":"/tsb/Tutorials/Import/importKey"},"next":{"title":"Post-Quantum Cryptography","permalink":"/tsb/Tutorials/Post-Quantum-Cryptography/pqc"}}');var i=s(74848),t=s(28453);const r={sidebar_position:0,title:"Sign a Payload with HMAC",sidebar_label:"HMAC Signing",description:"Learn how to sign a payload using REST API and HMAC keys.",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hmac signing","REST API","create HMAC key","cloud security","digital signatures","cryptographic operations","secure signing"]},c="Sign a Payload with HMAC",o={},d=[{value:"Create HMAC Key",id:"create-hmac-key",level:2},{value:"Sign a Payload",id:"sign-a-payload",level:2},{value:"Verify HMAC Signature",id:"verify-hmac-signature",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"sign-a-payload-with-hmac",children:"Sign a Payload with HMAC"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"REST_API"})," license is required to create and use keys without policy."]}),"\n",(0,i.jsx)(n.p,{children:"HMAC (Hash-based Message Authentication Code) is a mechanism that uses a cryptographic hash function and a secret cryptographic key to verify both the data integrity and the authenticity of a message. HMAC can be used with any iterative cryptographic hash function, such as SHA-256, in combination with a secret shared key."}),"\n",(0,i.jsx)(n.h2,{id:"create-hmac-key",children:"Create HMAC Key"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"}),": ",(0,i.jsx)(n.a,{href:"https://tsb-demo.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Create key request."]}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"<keyname>"})," as needed. The password is optional and can be deleted completely."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:"{4}",children:'{\n    "label": "<keyname>",\n    "password": null,\n    "algorithm": "HMACSHA256",\n    "attributes": {\n        "sign": true,\n        "extractable": false,\n        "modifiable": false,\n        "destroyable": false,\n        "sensitive": true,\n        "decrypt": false,\n        "unwrap": false\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"sign-a-payload",children:"Sign a Payload"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"}),": ",(0,i.jsx)(n.a,{href:"https://tsb-demo.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/hmac",children:"/v1/synchronousHmac"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description"}),": Contains a sign request without metadata."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"hmacRequest.payload"})," = the data to be signed. It must be Base64-encoded.",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.code,{children:"hmacRequest.keyName"})," = the key to be used for signing."]}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"<keyname>"})," with the name of your key."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'{\n    "hmacRequest": {\n        "keyName": "<keyname>",\n        "payload": "YXNk"\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'{\n  "keyedHash": "D8xCI255hjQf+x4cfO3l97WC8K+Lg+ARiXHMkvGAGOU="\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"verify-hmac-signature",children:"Verify HMAC Signature"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST:"})," ",(0,i.jsx)(n.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/verifyHmac",children:"/v1/verify"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description"})," Verify the HMAC signature of a payload."]}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"hmac"})," from the previous response and set the initial ",(0,i.jsx)(n.code,{children:"payload"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'{\n  "verifyHmacRequest": {\n    "keyName": "<keyname>",\n    "payload": "YXNk",\n    "signature": "D8xCI255hjQf+x4cfO3l97WC8K+Lg+ARiXHMkvGAGOU="\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'{\n  "signatureValid": true\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"This documentation provides step-by-step instructions for creating an HMAC key, signing a payload using the HMAC key, and verifying the HMAC signature using REST API endpoints."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);