"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[747],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>o});var t=r(96540);const s={},i=t.createContext(s);function c(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(i.Provider,{value:n},e.children)}},64406:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Use-Cases/certificate-request","title":"Using Certreq with an HSM","description":"Securing Microsoft Certutil with Securosys Hardware Security Modules (HSMs)","source":"@site/mscng/Use-Cases/certificate-request.md","sourceDirName":"Use-Cases","slug":"/Use-Cases/certificate-request","permalink":"/mscng/Use-Cases/certificate-request","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Using Certreq with an HSM","sidebar_label":"CSR request with Certreq","description":"Securing Microsoft Certutil with Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Certutil","permalink":"/mscng/Use-Cases/Certutil"},"next":{"title":"Microsoft Outlook","permalink":"/mscng/Use-Cases/MS-Outlook"}}');var s=r(74848),i=r(28453);const c={sidebar_position:0,title:"Using Certreq with an HSM",sidebar_label:"CSR request with Certreq",description:"Securing Microsoft Certutil with Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},o=void 0,a={},d=[{value:"Certificate Signing Request",id:"certificate-signing-request",level:2}];function l(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"certreq.exe"})," is a Windows command-line tool for generating, submitting, and managing certificate requests, primarily in Active Directory Certificate Services (ADCS) or external CAs. It allows precise control over CSR attributes via an INF file, making it ideal for automation."]}),"\n",(0,s.jsxs)(n.p,{children:["When used with the Securosys HSM, ",(0,s.jsx)(n.code,{children:"certreq"})," ensures private keys are generated and stored securely within the hardware, leveraging the Securosys Primus HSM Key Storage Provider (KSP)."]}),"\n",(0,s.jsx)(n.h2,{id:"certificate-signing-request",children:"Certificate Signing Request"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"certreq"})," command-line tool can be used to generate a Certificate Signing Request (CSR) on Windows."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create a file named ",(0,s.jsx)(n.code,{children:"request.inf"})," with the contents of the CSR."]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'[Version]\nSignature="$Windows NT$"\n\n[NewRequest]\nSubject="CN=yourdomain.com, O=Your Organization, L=YourCity, S=YourState, C=YourCountry"\nKeySpec=1\nKeyLength=2048\nExportable=TRUE\nMachineKeySet=TRUE\nSMIME=FALSE\nPrivateKeyArchive=FALSE\nUserProtected=FALSE\nUseExistingKeySet=FALSE\nProviderName="Securosys Primus HSM Key Storage Provider"\nProviderType=12\nRequestType=PKCS10\nKeyUsage=0xA0\n\n[Extensions]\n2.5.29.17 = "{text}"\n_continue_ = "dns=yourdomain.com&"\n_continue_ = "dns=www.yourdomain.com"\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:'ProviderName="Securosys Primus HSM Key Storage Provider"'})," must not be changed."]}),"\n",(0,s.jsxs)(n.li,{children:["Replace ",(0,s.jsx)(n.code,{children:"yourdomain.com"})," and other fields with your values."]}),"\n",(0,s.jsxs)(n.li,{children:["The if desired ",(0,s.jsx)(n.code,{children:"KeyLength=2048"})," can be changed to ",(0,s.jsx)(n.code,{children:"4096"})," for stronger encryption."]}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After saving ",(0,s.jsx)(n.code,{children:"request.inf"}),", Run ",(0,s.jsx)(n.strong,{children:"Command Prompt"})," as Administrator and execute:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmd",children:"certreq -new -f request.inf request.csr\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This will generate the CSR file (",(0,s.jsx)(n.code,{children:"request.csr"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The CSR file ",(0,s.jsx)(n.code,{children:"request.csr"})," is now ready to be submitted to a CA for certificate issuance. Optionally submit the CSR with the following command:"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'certreq -submit -config "CA_SERVER\\CA_NAME" request.csr\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["Optionally verify the content of the generated CSR with ",(0,s.jsx)(n.code,{children:"certutil"}),":","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmd",children:"certutil -dump request.csr\n"})}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);