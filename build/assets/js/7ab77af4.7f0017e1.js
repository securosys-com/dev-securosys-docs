"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[11812],{4219:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/TSB_Architecture-668e7b112dabd51dd6f4d8adc5f51cfa.png"},10605:(e,t,n)=>{n.d(t,{A:()=>s});const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAATCAMAAACwcE1OAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAC3UExURQAAAMTExMLCwsvLy83Nzb29xsfHx9LS0o6Os9XV1WtrqldXpdzc3D09nDMzmTMzq0BAn0ZGo01NplFRqFozmVpamVpaq1p/vGFhsGRksWZms21ttnBwt3FxuHV1unh4u3l5vH19vn9aq39/vH9/zo2NxqB/q6B/vKCgvMnJ1szM5dLS6d6kWd/f3+CwceSpXuW0duXl8uzs9e+6d/GxYPSuVfawVvfr2/jv4/ny6Pn5/P+8XP///2V9oJ4AAAAOdFJOUwDH6+/v8PDx8vP4+/v+KgtL/gAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUKFNjYGRjhgJWbnTAwcDAYgMDhnzogJeBgRMqiZAWVpSTkJWUlpGX5cMmjQSoIG1prGeAR9rc2tQMj7SFiY4+HmkoGGBpMRGQoJiSKJA0FEKX5ldRE9dQUddQVuLj07LSlsZjuJSRgiBQmh0qiWG3qgDIcCYeXSjQhIojABcDXsDAAABTKDqoeYm/EgAAAABJRU5ErkJggg=="},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(96540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}},65537:(e,t,n)=>{n.d(t,{A:()=>S});var s=n(96540),r=n(34164),i=n(65627),o=n(56347),a=n(50372),l=n(30604),c=n(11861),d=n(78749);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,s.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:s,default:r}}=e;return{value:t,label:n,attributes:s,default:r}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function x(e){let{queryString:t=!1,groupId:n}=e;const r=(0,o.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(i),(0,s.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(r.location.search);t.set(i,e),r.replace({...r.location,search:t.toString()})}),[i,r])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,i=u(e),[o,l]=(0,s.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:i}))),[c,h]=x({queryString:n,groupId:r}),[m,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,i]=(0,d.Dv)(n);return[r,(0,s.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:r}),j=(()=>{const e=c??m;return p({value:e,tabValues:i})?e:null})();(0,a.A)((()=>{j&&l(j)}),[j]);return{selectedValue:o,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),g(e)}),[h,g,i]),tabValues:i}}var g=n(9136);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(74848);function y(e){let{className:t,block:n,selectedValue:s,selectValue:o,tabValues:a}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),r=a[n].value;r!==s&&(c(t),o(r))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},t),children:a.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...i,className:(0,r.A)("tabs__item",j.tabItem,i?.className,{"tabs__item--active":s===t}),children:n??t},t)}))})}function b(e){let{lazy:t,children:n,selectedValue:i}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===i));return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:o.map(((e,t)=>(0,s.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function v(e){const t=m(e);return(0,f.jsxs)("div",{className:(0,r.A)("tabs-container",j.tabList),children:[(0,f.jsx)(y,{...t,...e}),(0,f.jsx)(b,{...t,...e})]})}function S(e){const t=(0,g.A)();return(0,f.jsx)(v,{...e,children:h(e.children)},String(t))}},68935:(e,t,n)=>{n.d(t,{A:()=>s});const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAVCAMAAAD7JKfbAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD/UExURQAAAL+/v7+/v76yssPDw7+/v8PDw8PDw8vLy83NzbGJicTExMfHx8PDw8fHx9XV1Z9NTZ1HR6JZWZcwMIYAAIYAOoYBAYcCAooICI0YGI4QEJUfH5UgIJgmJpwAAJwvL5w6AJw6OpxmZp0wMJ4yMqA3N6E4OKE5OadGRqhHR6hwcKlJSalxcat1daxQUKxRUax3d615ea5UVLBYWLBZWbE6OrFmZrFmkLKEhLRgYLmSkr2bm794eMVmOsVmZsWQZsmnp8rKys/Pz9+rZt/f3+G/v+THx+a9hujFmOjPz+7Wtu/v7/Df3/G3bPLexPOtVfPFivTn5/v39/+6W////wYLdqsAAAAUdFJOUwAwSFNdgL7P7+/w8PDx8fP4+vr7TTabBwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAMBJREFUKFPFzlUXwiAYgGGMOTuxc3Z31+xu/f+/RXCoU3fGpc8F5wDv4QNojNonxze7Cjzobi/wh55hGAUAFhIg5CJez6VKiUy6VoVZtLVKNSL5sN8FKU026IbUBi9Cczgtqc3qeqQ2m/2U2hCP4w//brgQPuQaEbT2O5KNszWI8q0h32xA2FnPi7RZQrMLyP4Hz6pcFjHUmLYv5FKkfa75UKNmWdYwnmA9pFsWKXiTHjwLU5pnTyPywptNaGQBcAfcm2j/kcqBYAAAAABJRU5ErkJggg=="},79329:(e,t,n)=>{n.d(t,{A:()=>o});n(96540);var s=n(34164);const r={tabItem:"tabItem_Ymn6"};var i=n(74848);function o(e){let{children:t,hidden:n,className:o}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,o),hidden:n,children:t})}},90173:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"Installation/On-Premise-Installation","title":"Installing REST-API on On-Premise HSM","description":"Document Information and Revision Control","source":"@site/tsb/Installation/On-Premise-Installation.md","sourceDirName":"Installation","slug":"/Installation/On-Premise-Installation","permalink":"/tsb/Installation/On-Premise-Installation","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Installing REST-API on On-Premise HSM","sidebar_label":"Rest-API Installation"},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/tsb/category/installation"},"next":{"title":"Primus HSM Setup","permalink":"/tsb/Installation/hsm-device-setup-tsb"}}');var r=n(74848),i=n(28453),o=n(65537),a=n(79329);const l={sidebar_position:1,title:"Installing REST-API on On-Premise HSM",sidebar_label:"Rest-API Installation"},c="Installation Guide (On-Prem)",d={},h=[{value:"Notification and Symbols",id:"notification-and-symbols",level:2},{value:"Support Contacts",id:"support-contacts",level:2},{value:"Abbreviations",id:"abbreviations",level:2},{value:"5.1 Download Configuration Files",id:"51-download-configuration-files",level:2},{value:"5.1.1 docker-compose.yml",id:"511-docker-composeyml",level:3},{value:"5.1.2 application-local.yml",id:"512-application-localyml",level:3},{value:"5.1.3 application-local-access-token.yml",id:"513-application-local-access-tokenyml",level:3},{value:"5.1.4 application-external-keystore.yml",id:"514-application-external-keystoreyml",level:3},{value:"6.1 Run Container",id:"61-run-container",level:2},{value:"6.2 Testing",id:"62-testing",level:2},{value:"6.3 Sample Application startup",id:"63-sample-application-startup",level:2},{value:"6.4 Connection Setup - OnPremise",id:"64-connection-setup---onpremise",level:2},{value:"6.5 Connection Setup - CloudHSM",id:"65-connection-setup---cloudhsm",level:2},{value:"7 Example of Setting up Proxy Service for HSMaaS",id:"7-example-of-setting-up-proxy-service-for-hsmaas",level:2},{value:"8 Logging",id:"8-logging",level:2},{value:"9 Setting up Trusted Execution Environment Configuration (Optional)",id:"9-setting-up-trusted-execution-environment-configuration-optional",level:2},{value:"11 Testing and Troubleshooting",id:"11-testing-and-troubleshooting",level:2},{value:"11.1 User Login to Artifactory but fails due to lack or misconfiguration of credential store.",id:"111-user-login-to-artifactory-but-fails-due-to-lack-or-misconfiguration-of-credential-store",level:3}];function u(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"installation-guide-on-prem",children:"Installation Guide (On-Prem)"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Document Information and Revision Control"})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Version"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Date"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Author"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Description, Changes"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"V1.0"}),(0,r.jsx)(t.td,{children:"19.11.2020"}),(0,r.jsx)(t.td,{children:"PM"}),(0,r.jsx)(t.td,{children:"Initial document"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"V2.0"}),(0,r.jsx)(t.td,{children:"26.01.2022"}),(0,r.jsx)(t.td,{children:"PM"}),(0,r.jsx)(t.td,{children:"Docker-Compose support added"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"V3.0"}),(0,r.jsx)(t.td,{children:"21.04.2022"}),(0,r.jsx)(t.td,{children:"PM"}),(0,r.jsx)(t.td,{children:"Version upgrade"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"V4.0"}),(0,r.jsx)(t.td,{children:"05.07.2023"}),(0,r.jsx)(t.td,{children:"PM"}),(0,r.jsx)(t.td,{children:"Added more detailed HSM setup, Added troubleshooting chapter, updated application-configuration files to latest version 1.15.1.1, added connection parameter endpoints, added sample application startup"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"V5.0"}),(0,r.jsx)(t.td,{children:"01.09.2023"}),(0,r.jsx)(t.td,{children:"PM"}),(0,r.jsx)(t.td,{children:"Add Infinite keystore configuration setup"})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"notification-and-symbols",children:"Notification and Symbols"}),"\n",(0,r.jsx)(t.admonition,{title:"SKA",type:"tip",children:(0,r.jsx)(t.p,{children:"This symbol contains helpful or important information for setting up TSB onPremise"})}),"\n",(0,r.jsx)(t.admonition,{title:"Take care",type:"danger",children:(0,r.jsx)(t.p,{children:"This symbol means to be careful and obey all instructions. You might do something that could result in data loss"})}),"\n",(0,r.jsx)(t.p,{children:"Feature or action requires role activation using"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Genesis Card ",(0,r.jsx)(t.img,{src:n(10605).A+"",width:"30",height:"19"})]}),"\n",(0,r.jsxs)(t.li,{children:["Security Officer (SO) Cards 2 of n ",(0,r.jsx)(t.img,{src:n(68935).A+"",width:"35",height:"21"})]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"The following symbols are used for HSM configuration setup:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["HSM Graphical User Interface, Menu Navigation, e.g.\n",(0,r.jsx)(t.code,{children:"Setup \u2192 Configuration \u2192 Network \u2192 Services \u2192 JCE \u2192 TCP Port :2300"})]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["and HSM console commands, e.g.\n",(0,r.jsx)(t.code,{children:"hsm_net_list_config serv=2 serv_port"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.h1,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(t.p,{children:"This document provides instructions for installing the Securosys REST API, a standalone software that facilitates language-independent integration with Securosys Primus HSM. It also includes the installation steps for the Transaction Security Broker (TSB) license, which incorporates an approval workflow engine for Securosys Smart Key Attributes. The instructions cover both Linux and Windows platforms."}),"\n",(0,r.jsx)(t.p,{children:"This guide has been tested on RHEL 7 and CentOS 8, Docker 19.03, and MariaDB 10.4"}),"\n",(0,r.jsx)(t.p,{children:"The Transaction Security Broker Software is designed to be deployable on Kubernetes as well as standalone Docker containers. This flexibility allows for easy integration into containerized environments, providing scalability and resource efficiency for managing the software's JVM-based framework and connecting to databases for state management, HSM cluster for key operations and policy enforcement, and various logging mechanisms."}),"\n",(0,r.jsx)(t.admonition,{title:"SKA",type:"tip",children:(0,r.jsxs)(t.p,{children:["TSB software supports three ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.a,{href:"/tsb/Installation/Miscellaneous/architectures",children:"security architecture types"})})," (",(0,r.jsx)(t.em,{children:"Type1, Type2, Type3"}),"), and the document provides detailed instructions or references for their setup."]})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.img,{src:n(4219).A+"",width:"1071",height:"799"}),"\n",(0,r.jsxs)(t.em,{children:["Figure 1",":REST"," API Various deployment Architectures"]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"support-contacts",children:"Support Contacts"}),"\n",(0,r.jsxs)(t.p,{children:["If you encounter a problem while installing, registering, or operating this product, please make sure that you have read the documentation. If you cannot resolve the issue, contact your supplier or Securosys Customer Support. The support portal is reachable under: ",(0,r.jsx)(t.a,{href:"https://support.securosys.com/",children:"https://support.securosys.com/"})," Your level of access to this service is governed by the support plan agreement made between Securosys and your organization. Please consult your support plan for further information about your entitlements, service level agreements and contact details."]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"abbreviations",children:"Abbreviations"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Acronym"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Definition"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"TSB"})}),(0,r.jsx)(t.td,{children:"Transaction Security Broker"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"TEE"})}),(0,r.jsx)(t.td,{children:"Trusted Execution Environment"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"SKA"})}),(0,r.jsx)(t.td,{children:"Smart Key Attributes"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"HSMaaS"})}),(0,r.jsx)(t.td,{children:"Hardware Security Module as a Service"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"mTLS"})}),(0,r.jsx)(t.td,{children:"Mutual Authentication or client-authentication"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"REST"})}),(0,r.jsx)(t.td,{children:"Representational State Transfer"})]})]})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h1,{id:"hsm---device-setup-and-configuration",children:"HSM - Device setup and configuration"}),"\n",(0,r.jsxs)(t.p,{children:["Before we can install and configure the Securosys Transaction Security Broker (Rest-API) we need to configure the Securosys on-premises Primus HSM. If you are using Securosys CloudHSM you can skip the HSM setup and jump to chapter ",(0,r.jsx)(t.a,{href:"/tsb/Installation/Miscellaneous/supported_platforms",children:"Transaction Security Broker Service Requirements"})]}),"\n",(0,r.jsxs)(t.p,{children:["If you operate your own PrimusHSM and have not initially setup the HSM, please follow the instructions of ",(0,r.jsx)(t.a,{href:"/hsm/Installation/Setup/UserGuide/GetStarted/HSM-Setup-v2-11-1#initial-setup-of-the-hsm-firmware-v211",children:"Running the initial wizard"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"After completing the initial setup (running the initial wizard), ensure that the HSM has a correct network configuration and can be accessed from the server where TSB will be installed. The HSM can be reached through the default port (port: 2300) unless it has been configured differently. Keep in mind that the service may be assigned to one of the four network interfaces available."}),"\n",(0,r.jsx)(t.p,{children:"Use one of the following commands to ensure a valid network configuration:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:":~# telnet 10.10.10.10 2300\n:~# ping 10.10.10.10\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h1,{id:"tsb---setup-and-configuration",children:"TSB - Setup and Configuration"}),"\n",(0,r.jsx)(t.p,{children:"During the installation of the Transaction Security Broker, you will need to apply the following application configuration:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Download the necessary configuration files."}),"\n",(0,r.jsx)(t.li,{children:"Set up docker-compose (optional, depending on your setup)."}),"\n",(0,r.jsx)(t.li,{children:"Configure the HSM-Connection properties in the application-local.yml file."}),"\n",(0,r.jsx)(t.li,{children:"Adjust the logging behaviour according to your requirements."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"These steps ensure the proper setup and configuration of the Transaction Security Broker application."}),"\n",(0,r.jsx)(t.h2,{id:"51-download-configuration-files",children:"5.1 Download Configuration Files"}),"\n",(0,r.jsxs)(t.p,{children:["Head to the ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.a,{href:"/tsb/Download/downloads",children:"Downloads"})})," page to get instructions on how to get the software and download the Cofiguration Files."]}),"\n",(0,r.jsx)(t.p,{children:"The previously downloaded zip file contains the following files:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Installation Directory"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Files"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/ ",(0,r.jsx)(t.strong,{children:"docker-compose.yml"})," (required)"]}),(0,r.jsx)(t.td,{children:"A Docker Compose file (docker-compose.yml) is a configuration file that describes the various services, networks, and volumes required to run a multi-container Docker application."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/ ",(0,r.jsx)(t.strong,{children:"application-local.yml"})," (required)"]}),(0,r.jsx)(t.td,{children:"The application-local.yml file is a configuration file specific to the application, containing HSM connection settings and properties that can be customized to tailor the behavior and functionality of TSB."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/ ",(0,r.jsx)(t.strong,{children:"application-local-access-token.yml"})]}),(0,r.jsx)(t.td,{children:"The application-local-access-token.yml file is utilized to configure JWT authentication access and necessitates the creation of JWT tokens for secure system access. Notably, this configuration supports a one-to-many deployment model, allowing a single TSB instance to connect with multiple HSM partitions."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/ ",(0,r.jsx)(t.strong,{children:"application-tee.yml"})]}),(0,r.jsx)(t.td,{children:"The application-tee.yml file is used for setting up the Trusted Execution Environment (TEE) configuration in the TSB, providing a secure and isolated environment for executing sensitive operations or computations."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/ ",(0,r.jsx)(t.strong,{children:"template.yml"})]}),(0,r.jsx)(t.td,{children:"The template.yml file contains a comprehensive list of all available configuration properties for easy reference and customization within the application."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/log/ ",(0,r.jsx)(t.strong,{children:"logback.xml"})]}),(0,r.jsx)(t.td,{children:"The logback.xml file is used to configure the logging behavior of the application, defining settings such as log levels, output formats, and log file destinations."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/ ",(0,r.jsx)(t.strong,{children:"docker-compose-external-keystore.yml"})]}),(0,r.jsx)(t.td,{children:"A Docker Compose file (docker-compose-external-keystore.yml) for storing and managing large volumes of cryptographic keys."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[":~/config-files/ ",(0,r.jsx)(t.strong,{children:"application-external-keystore.yml"})]}),(0,r.jsx)(t.td,{children:"The application-external-keystore.yml file is a configuration file specific to the application for external keystore usage, (e.g. using the database for external storage option)."})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h3,{id:"511-docker-composeyml",children:"5.1.1 docker-compose.yml"}),"\n",(0,r.jsx)(t.p,{children:"Docker Compose simplifies the configuration and deployment of multi-container Docker applications. By defining services in the docker-compose.yml file and customizing the parameters to suit your needs, you can easily create and start all the specified services with a single command."}),"\n",(0,r.jsx)(t.admonition,{title:"Take care",type:"danger",children:(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Ensure the hierarchical structure of the configuration remains intact by using spaces instead of tabs"}),"\n",(0,r.jsxs)(t.li,{children:["To maintain proper ",(0,r.jsx)(t.strong,{children:"volumes"})," mapping in Docker Compose, refrain from altering the mapping after the colon (:) symbol and only modify the bold-marked (host-mapped) directory."]}),"\n"]})}),"\n",(0,r.jsx)(t.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(t.p,{children:["For first startup of Transaction Security Broker (with default configuration) you do not need to touch the ",(0,r.jsx)(t.code,{children:"docker-compose.yml"})," file."]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:'version: "3.3"\nservices:    \n    securosys_sql:\n        image: docker.io/mariadb:10.4\n        container_name: securosys_sql\n        ports:\n        - 3306:3306\n        volumes:\n        - ./securosys_sql/mysql-lib:/var/lib/mysql\n        environment:\n        - MYSQL_USER=replace-me_db-username\n        - MYSQL_PASSWORD=replace-me_db-password\n        - MYSQL_DATABASE=securosys\n        - MYSQL_PORT=3306\n        - MYSQL_ROOT_PASSWORD=replace-me_db-root-password\n        - MYSQL_LOWER_CASE_TABLE_NAMES=0\n    securosys_tsb:\n        image: securosys.jfrog.io/external-tsb/securosys-tsb:latest\n        container_name: securosys_tsb\n        restart: always\n        depends_on:\n        - securosys_sql\n        ports:\n        - 8080:8080\n        volumes:\n        - ./config-files:/etc/app/config\n        - ./output:/etc/app/output\n        environment:\n        - spring.profiles.active=local  # by specifying profile=local, tsb takes the application-local.yml config file\n        - logging.config=/etc/app/config/log/logback.xml\n'})}),"\n",(0,r.jsxs)(t.p,{children:["The first service ",(0,r.jsx)(t.strong,{children:"securosys_sql"})," block contains the fields:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"services"}),(0,r.jsx)(t.td,{children:"Root tier describes the underlying services"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"securosys_sql"}),(0,r.jsx)(t.td,{children:"The name of the maria database service. This is also the name if the service is to be resolved using the internal docker network"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"image"}),(0,r.jsx)(t.td,{children:"The Docker image of Maria Database which is automatically pulled from DockerHub"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"container_name"}),(0,r.jsx)(t.td,{children:"The name of the docker container"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ports"}),(0,r.jsx)(t.td,{children:"3307 the port that is mapped to the host network, 3306 the port that is used in the docker internal default network"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"volumes"}),(0,r.jsx)(t.td,{children:"./mysql-lib is the host mounted directory and stores my mysql schema data. This directory is created automatically at first startup. /var/lib/mysql is the internal docker directory which is used by the mysql database"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"environment"}),(0,r.jsx)(t.td,{children:"Application specific environment variables that are injected during startup"})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["The second service ",(0,r.jsx)(t.strong,{children:"securosys_tsb"})," block contains the fields:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"securosys-ska"}),(0,r.jsx)(t.td,{children:"The name of the Securosys-TSB service."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"image"}),(0,r.jsx)(t.td,{children:"The Docker image of Securosys-TSB available at the Securosys Jfrog-Artifactory"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"container_name"}),(0,r.jsx)(t.td,{children:"The name of the docker container"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"restart"}),(0,r.jsx)(t.td,{children:"The command that enables auto restart if the application fail"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"depends_on"}),(0,r.jsx)(t.td,{children:"Expresses the dependency between services. Starts service in dependency order. In this example mariadb_securosys starts before securosys-ska (with this command services do not wait until the startup is completed!)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ports"}),(0,r.jsx)(t.td,{children:"The port mapping for internal (Docker) and external (Host) network binding"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"volumes"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.strong,{children:"./config"}),", the directory in which securosys-ska configuration files are stored (e.g. application config, TLS config, TEE config, Logging Config, \u2026) ",(0,r.jsx)("br",{}),(0,r.jsx)(t.strong,{children:"./output"}),", the directory where the log output is written to (if logging is configured to file)"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"environment"}),(0,r.jsxs)(t.td,{children:["Environment variables that are injected during startup spring.profile.active=local e.g. tells the springboot application to map another application configuration file (profiles are used for this). ",(0,r.jsx)("br",{})," In this example application-local.yml is used as additional application configuration file. ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," Note: Change 'spring.profiles.active' to application-external-keystore.yml to switch to external key usage."]})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h3,{id:"512-application-localyml",children:"5.1.2 application-local.yml"}),"\n",(0,r.jsxs)(t.p,{children:["The application-local.yml is used for ",(0,r.jsx)(t.code,{children:"securosys-ska"})," container. Configure your specific HSM connection details within the configuration file: ",(0,r.jsx)(t.code,{children:"config-files/application-local.yml"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["Adapt the ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"replace-me_*"})})," parameters according to your HSM setup (cluster configuration)."]}),"\n",(0,r.jsx)(t.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(t.p,{children:["Default HSM connection details for CloudHSM ",(0,r.jsx)(t.code,{children:"host"})," & ",(0,r.jsx)(t.code,{children:"port"}),") are shown in ",(0,r.jsx)(t.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"HSMaaS - Connectivity Details"})]})}),"\n",(0,r.jsx)(t.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(t.p,{children:["Chapter ",(0,r.jsx)(t.a,{href:"#7-example-of-setting-up-proxy-service-for-hsmaas",children:"Example of Setting up Proxy Service for HSMaaS"})," gives an example how to configure CloudHSM access using a Proxy (Security Architecture: Type2, Type3)."]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:"{5,6,10-16}",children:"spring:\n## DATABASE CONFIG\n  datasource:\n    url: jdbc:mysql://securosys_sql:3306/securosys\n    username: replace-me_db-username\n    password: replace-me_db-password\n    swaggerUI.enabled: true\n##HSM CONFIG\n  hsm:\n    host: 'nufenen.securosys.ch,grimsel.securosys.ch'\n    port: '2300'\n    user: replace-me_hsm-username\n    setupPassword: replace-me_hsm-setupPassword\n    encryptionPassword: replace-me_db-encryptionPassword\n    #proxyUser: replace-me_proxy-username # used for CloudHSM access\n    #proxyPassword: replace-me_proxy-password # used for CloudHSM access\n    timeout: 1800\n    maxTimeDifferenceToHsm: 100\n    attestationKeyName: 'attestation-key'\n    timestampKeyName: 'test-time-key'\n\n## HTTPS CONFIG\n  tls:\n    enabled: false\n    keyStore: 'file:/etc/app/config/tls/securosys-ska-server.p12'\n    keyStorePassword: secret\n    trustStore: 'file:/etc/app/config/tls/securosys-ska-truststore-server.jks'\n    trustStorePassword: secret\n    clientAuthentication: none\n"})}),"\n",(0,r.jsxs)(t.p,{children:["The first block ",(0,r.jsx)(t.code,{children:"spring.datasource"})," contains the fields"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Parameter"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"url"}),(0,r.jsx)(t.td,{children:"Connection string to the database. The domain points to the service name, Docker-compose in the above example is configured to use the service name."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"username"}),(0,r.jsx)(t.td,{children:"The username for the sql database, which is defined in docker-compose.yml file at line number 13"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"password"}),(0,r.jsx)(t.td,{children:"The password for the sql database, which is defined in docker-compose.yml file at line number 14"})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["The second block ",(0,r.jsx)(t.code,{children:"hsm"})," contains the fields"]}),"\n",(0,r.jsxs)(t.admonition,{type:"tip",children:[(0,r.jsxs)(t.mdxAdmonitionTitle,{children:["Load-Balancing: ",(0,r.jsx)(t.code,{children:"hsm.host"})]}),(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Specify multiple hosts separated by commas, and TSB will randomly select one host, falling back to the others if the first one fails (e.g., hsm.host: ",(0,r.jsx)(t.em,{children:"'grimsel.securosys.ch, nufenen.securosys.ch'"}),")."]}),"\n",(0,r.jsxs)(t.li,{children:["Provide multiple hosts separated by semicolons, and TSB will always choose the first record, falling back to the others if the first one fails (e.g., hsm.host: ",(0,r.jsx)(t.em,{children:"'grimsel.securosys.ch**;** nufenen.securosys.ch'"}),")."]}),"\n"]})]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"host"}),(0,r.jsx)(t.td,{children:"The hostname or IP address of the HSM"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"port"}),(0,r.jsx)(t.td,{children:"The port of the JCE API on the HSM, default JCE-Port: 2300"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"user"}),(0,r.jsx)(t.td,{children:"The name (case sensitive) of the HSM user (partition)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"setupPassword"}),(0,r.jsxs)(t.td,{children:["The setup password is a 29-alphanumeric dash separated string in form of ",(0,r.jsx)(t.code,{children:"FXAJX-XWVQ3-DC0O5-3SLQF-LJ9L3"})," with ",(0,r.jsx)(t.strong,{children:"limited time validity"}),". ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," \u2022\tHSM-OnPremise (default): 3 days;",(0,r.jsx)("br",{})," \u2022\tCloudHSM default: 1 week;",(0,r.jsx)("br",{})," \u2022\tDeveloper account: 1 year",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," The initial partition setup password, provided by Securosys, is used to obtain or update a permanent secret."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"encryptionPassword"}),(0,r.jsx)(t.td,{children:"This password is used to encrypt the user secret retrieved from the HSM. This password can be freely chosen (should possess high entropy)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"proxyUser"}),(0,r.jsxs)(t.td,{children:["HSMaaS (",(0,r.jsx)(t.em,{children:"Type 2, Type3"}),") only: the name of the service user (proxy), as provided by Securosys"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"proxyPassword"}),(0,r.jsxs)(t.td,{children:["HSMaaS (",(0,r.jsx)(t.em,{children:"Type 2, Type3"}),") only: the password of the service user (proxy), as provided by Securosys"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"attestationKeyName"}),(0,r.jsx)(t.td,{children:"The attestation key, which is generated upon startup, that asserts the origin of keys and the HSM environment"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"timestampKeyName"}),(0,r.jsx)(t.td,{children:"Timestamp key, which is generated upon startup, that asserts the origin of the keys"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"rfcTimestampKeyName"}),(0,r.jsx)(t.td,{children:"rfc3161 timestamp key, which is generated upon startup, that asserts the validity of signatures and certificates"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"maxTimeDifferenceToHsm"}),(0,r.jsxs)(t.td,{children:["The unit is seconds, log appears on CLI: ",(0,r.jsx)(t.strong,{children:"WARN"})," if the difference between the system time and the hsm time is greater than the specified value"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"useExternalKeyStore"}),(0,r.jsx)(t.td,{children:"Storing encrypted keys in database, default: false (additional license required)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"useKeyReplicationService"}),(0,r.jsx)(t.td,{children:"Using built\u2014in key replication service, rather than SQL clustering logic, slave datasource must be configured, default: false (additional license required, only in combination with externalKeystore)"})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["The third and ",(0,r.jsx)(t.strong,{children:"optional"})," for ",(0,r.jsx)(t.strong,{children:"development"})," environments ",(0,r.jsx)(t.code,{children:"tls"})," contains the fields."]}),"\n",(0,r.jsx)(t.admonition,{title:"SKA",type:"tip",children:(0,r.jsx)(t.p,{children:"Further information on setting up TLS and mTLS files can be found at the end of this document."})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tls.enabled"}),(0,r.jsx)(t.td,{children:"true"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tls.keyStore"}),(0,r.jsx)(t.td,{children:"The keystore which holds the server key and server certificate"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tls.keyStorePassword"}),(0,r.jsx)(t.td,{children:"The password that was set when the key-store was created"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tls.trustStore"}),(0,r.jsx)(t.td,{children:"The Truststore which holds the CA certificate"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tls.trustStorePassword"}),(0,r.jsx)(t.td,{children:"The password that was set when the trust-store was created"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"clientAuthentication"}),(0,r.jsxs)(t.td,{children:["mutualTLS configuration, an enum consists of: ",(0,r.jsx)("br",{}),"\u2022\t",(0,r.jsx)(t.code,{children:"need"}),": Client Authentication is needed and mandatory",(0,r.jsx)("br",{})," \u2022\t",(0,r.jsx)(t.code,{children:"want"}),": Client authentication is wanted but not mandatory ",(0,r.jsx)("br",{}),"\u2022\t",(0,r.jsx)(t.code,{children:"none"}),": Client authentication is not wanted e.g. none"]})]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h3,{id:"513-application-local-access-tokenyml",children:"5.1.3 application-local-access-token.yml"}),"\n",(0,r.jsx)(t.p,{children:"The application-local-access-token.yml file is utilized to configure JWT authentication access and necessitates the creation of JWT tokens for secure system access. Notably, this configuration supports a one-to-many deployment model, allowing a single TSB instance to connect with multiple HSM partitions. Please contact your sales representative or open a ticket at the Securosys support portal to setup TSB as multi-auth service."}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h3,{id:"514-application-external-keystoreyml",children:"5.1.4 application-external-keystore.yml"}),"\n",(0,r.jsxs)(t.p,{children:["Different use cases in blockchain, IoT or signing (TSP) industries require very big numers of keys to be protected by HSM. The Infinite Key Store (IKS) offers a scalable and efficient solution for securely storing and managing large volumes of cryptographic keys for ",(0,r.jsx)(t.strong,{children:"on-premises"})," and ",(0,r.jsx)(t.strong,{children:"CloudHSM"})," environments when integrated using Transaction Security Broker (TSB)."]}),"\n",(0,r.jsx)(t.p,{children:"With IKS, keys are stored as external key objects in the TSB inherent database, encrypted by the Partition Key stored inside the HSM. Thus, the storage size can theoretically grow limitless and provide storage for an infinite number of keys. Please contact your sales representative or open a ticket at the Securosys support portal."}),"\n",(0,r.jsx)(t.admonition,{title:"Infinite Keystore",type:"info",children:(0,r.jsx)(t.p,{children:"The Infinite Key Store (IKS) is limited to specific enterprise use cases. Reach out to your Securosys Support or your Sales representative for further details on IKS."})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h1,{id:"6-startup",children:"6 Startup"}),"\n",(0,r.jsx)(t.p,{children:"In this chapter, you will initiate the Transaction Security Broker to verify its setup correctness by following these steps:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Start the multi-container application."}),"\n",(0,r.jsx)(t.li,{children:"Validate the state of the containers and software."}),"\n",(0,r.jsx)(t.li,{children:"Perform testing using Swagger-UI and CURL."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"These steps ensure that the Transaction Security Broker application is properly set up and configured."}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"61-run-container",children:"6.1 Run Container"}),"\n",(0,r.jsxs)(t.p,{children:["To launch the multi-container application, execute the following command in the directory where the docker-compose.yml file is located. This command initiates the startup process for the two containers: ",(0,r.jsx)(t.code,{children:"securosys_sql"})," and ",(0,r.jsx)(t.code,{children:"securosys_tsb"})]}),"\n",(0,r.jsx)(t.admonition,{title:"TSB - Dispatched",type:"tip",children:(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"docker-compose up -d"})," starts the containers in dispatched mode",(0,r.jsx)("br",{})]}),"\n",(0,r.jsxs)(t.li,{children:["Password for jfrog user:  ",(0,r.jsx)(t.code,{children:"robot.reader.tsb"})," here: ",(0,r.jsx)(t.a,{href:"/tsb/Download/downloads",children:"Downloads"})]}),"\n"]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:":~/securosys_tsb$ docker login securosys.jfrog.io -u robot.reader.tsb\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:":~/securosys_tsb$ docker-compose up\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"62-testing",children:"6.2 Testing"}),"\n",(0,r.jsxs)(t.p,{children:["Replace ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"<your_machine_ip>"})})," with either localhost, 127.0.0.1, or DNS-Name (if configured)."]}),"\n",(0,r.jsxs)(o.A,{groupId:"os",children:[(0,r.jsx)(a.A,{value:"curl",label:"Curl",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"curl -X 'GET' 'https://<your_machine_ip>:8080/v1/licenseInfo' -H 'accept: application/json'\n"})})}),(0,r.jsx)(a.A,{value:"curl_mtls",label:"Curl (mTLS)",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"curl -v --cert-type P12 \u2013cert client-cert.p12:<password> https://<your_machine_ip>:8080/v1/licenseInfo\n"})})}),(0,r.jsx)(a.A,{value:"browser",label:"Browser",default:!0,children:(0,r.jsxs)(t.p,{children:["http://",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"<your_machine_ip>"})}),":8080/swagger-ui/index.html"]})})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"63-sample-application-startup",children:"6.3 Sample Application startup"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-java",children:"  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::                (v3.0.6)\n\n2023.07.0515:04:55.660INFO  [kground-preinit] [alidator.internal.util.Version] HV000001: Hibernate Validator 8.0.0.Final\n2023.07.0515:04:55.744INFO  [ restartedMain] [com.securosys.ska.SKA_EXTERNAL] The following 1 profile is active: \"local\"\n2023.07.0515:04:55.836INFO  [ restartedMain] [sPropertyDefaultsPostProcessor] For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'\n2023.07.0515:04:57.853INFO  [ restartedMain] [epositoryConfigurationDelegate] Bootstrapping Spring Data JPA repositories in DEFAULT mode.\n2023.07.0515:04:57.956INFO  [ restartedMain] [epositoryConfigurationDelegate] Finished Spring Data repository scanning in 88 ms. Found 9 JPA repository interfaces.\n2023.07.0515:04:59.850INFO  [ restartedMain] [mbedded.tomcat.TomcatWebServer] Tomcat initialized with port(s): 8080 (http)\n2023.07.0515:04:59.864INFO  [ restartedMain] [oyote.http11.Http11NioProtocol] Initializing ProtocolHandler [\"http-nio-8080\"]\n2023.07.0515:04:59.865INFO  [ restartedMain] [.catalina.core.StandardService] Starting service [Tomcat]\n2023.07.0515:04:59.866INFO  [ restartedMain] [e.catalina.core.StandardEngine] Starting Servlet engine: [Apache Tomcat/10.1.8]\n2023.07.0515:05:00.072INFO  [ restartedMain] [rBase.[Tomcat].[localhost].[/]] Initializing Spring embedded WebApplicationContext\n2023.07.0515:05:00.074INFO  [ restartedMain] [letWebServerApplicationContext] Root WebApplicationContext: initialization completed in 4237 ms\n2023.07.0515:05:00.470INFO  [ restartedMain] [nternal.license.VersionPrinter] Flyway Community Edition 9.17.0 by Redgate\n2023.07.0515:05:00.470INFO  [ restartedMain] [nternal.license.VersionPrinter] See release notes here: https://rd.gt/416ObMi\n2023.07.0515:05:00.471INFO  [ restartedMain] [nternal.license.VersionPrinter]\n2023.07.0515:09:41.576INFO  [ restartedMain] [database.base.BaseDatabaseType] Database: jdbc:mysql://localhost:4405/securosys (MySQL 8.0)\n2023.07.0515:09:41.753INFO  [ restartedMain] [re.internal.command.DbValidate] Successfully validated 19 migrations (execution time 00:00.093s)\n2023.07.0515:09:41.803INFO  [ restartedMain] [ore.internal.command.DbMigrate] Current version of schema 'securosys': 1.15.2.100\n2023.07.0515:09:41.805INFO  [ restartedMain] [ore.internal.command.DbMigrate] Schema 'securosys' is up to date. No migration necessary.\n2023.07.0515:05:04.609INFO  [ restartedMain] [te.jpa.internal.util.LogHelper] HHH000204: Processing PersistenceUnitInfo [name: SECUROSYS-UNIT]\n2023.07.0515:05:04.725INFO  [ restartedMain] [        org.hibernate.Version] HHH000412: Hibernate ORM core version 6.1.7.Final\n2023.07.0515:05:05.438INFO  [ restartedMain] [                  SQL dialect] HHH000400: Using dialect: org.hibernate.dialect.MySQL8Dialect\n2023.07.0515:05:07.294INFO  [ restartedMain] [.internal.JtaPlatformInitiator] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]\n2023.07.0515:05:07.312INFO  [ restartedMain] [tainerEntityManagerFactoryBean] Initialized JPA EntityManagerFactory for persistence unit 'SECUROSYS-UNIT'\n2023.07.0515:05:11.258INFO  [ restartedMain] [igure.OptionalLiveReloadServer] LiveReload server is running on port 35729\n2023.07.0515:05:11.284INFO  [ restartedMain] [oyote.http11.Http11NioProtocol] Starting ProtocolHandler [\"http-nio-8080\"]\n2023.07.0515:05:11.320INFO  [ restartedMain] [mbedded.tomcat.TomcatWebServer] Tomcat started on port(s): 8080 (http) with context path ''\n2023.07.0515:05:11.340INFO  [ restartedMain] [com.securosys.ska.SKA_EXTERNAL] Started SKA_EXTERNAL in 16.413 seconds (process running for 17.706)\n2023.07.0515:05:11.343INFO  [ restartedMain] [.business.BootstrappingProcess] Executing application bootstrapping\n2023.07.0515:05:11.536INFO  [ restartedMain] [ka.service.business.HsmService] First time login. Logging in using the provided secret to fetch user secret.\n2023.07.0515:05:13.678INFO  [ restartedMain] [ka.service.business.HsmService] grimsel.securosys.ch:2300:TSBDEV connected\n2023.07.0515:05:14.163INFO  [ restartedMain] [ka.service.business.HsmService] Logged out from HSM.\n2023.07.0515:05:15.193INFO  [ restartedMain] [ka.service.business.HsmService] grimsel.securosys.ch:2300:TSBDEV connected\n"})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"64-connection-setup---onpremise",children:"6.4 Connection Setup - OnPremise"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.a,{href:"/connectivity-details/on-premises-connectivity-details",children:"This Link"})})," holds the configuration parameter for ",(0,r.jsx)(t.code,{children:"hsm.host"}),", ",(0,r.jsx)(t.code,{children:"hsm.port"}),", if not specified differently by your Security Officer (SO)"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"65-connection-setup---cloudhsm",children:"6.5 Connection Setup - CloudHSM"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"This Link"})})," holds the SaaS endpoints for Securosys CloudHSM"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"7-example-of-setting-up-proxy-service-for-hsmaas",children:"7 Example of Setting up Proxy Service for HSMaaS"}),"\n",(0,r.jsx)(t.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(t.p,{children:["For Security Architecture Type 2 and Type 3 proxy service configuration must be held.\nThis is done in the ",(0,r.jsx)(t.code,{children:"application-local.yml"})," under hsm block"]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:"{7,8}",children:"hsm:\n  host: 'grimsel.securosys.ch'\n  port: '2300'\n  user: PRIMUSDEVXXX # replace with your credentials\n  setupPassword: eoVyt-a7gGg-gjXSw-ESx2t-jv5GF# replace with your credentials\n  encryptionPassword: MqV1c3-a7v1g-C9Kaw-fqwe2t-jv55GF # this password is used to encrypt the user secret retrieved from the HSM, is choosen randomly\n  proxyUser: replace-me_proxy-username # used for CloudHSM access (proxy)\n  proxyPassword: replace-me_proxy-password # used for CloudHSM access (proxy)\n  attestationKeyName: 'attestation-key'\n  timestampKeyName: 'timestamp-key'\n  rfcTimestampKeyName: 'rfcTimestampKeyName'\n  maxTimeDifferenceToHsm: 100\n"})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"proxyUser"}),(0,r.jsx)(t.td,{children:"HSMaaS (Type 2, Type3) only: the name of the service user (proxy), as provided by Securosys"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"proxyPassword"}),(0,r.jsx)(t.td,{children:"HSMaaS (Type 2, Type3) only: the password of the service user (proxy), as provided by Securosys"})]})]})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"8-logging",children:"8 Logging"}),"\n",(0,r.jsx)(t.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(t.p,{children:["This current log configuration ",(0,r.jsx)(t.code,{children:"config-files\\log\\logback.yml"})," shows how to write logging information to the console and a file on the host machine located at ",(0,r.jsx)(t.code,{children:":~/securosys_tsb/output"})]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<configuration scan="true" scanPeriod="300 seconds">\n\t\x3c!-- infrastructure logging (journalctl, docker, IDE output) --\x3e\n\t<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">\n\t\t<withJansi>true</withJansi>\n\t\t<encoder>\n\t\t\t<charset>UTF-8</charset>\n\t\t\t<pattern>%d{yyyy.MM.dd HH:mm:ss.SSS} %highlight(%-5.5p) [%15.15t] %cyan([%30.30c]) %X{indent}%m%n</pattern>\n\t\t</encoder>\n\t</appender>\n\t\x3c!-- history logging, disabled for openshift/docker deployment --\x3e\n\t<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">\n\t\t<file>/etc/app/output/service.log</file>\n\t\t<append>true</append>\n\t\t<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\\\n\t\t\t<fileNamePattern>logs/service-%d{yyyy-MM-dd}.log</fileNamePattern>\n\t\t\t<maxHistory>13</maxHistory>\n\t\t\t<totalSizeCap>100MB</totalSizeCap>\n\t\t</rollingPolicy>\n\t\t<encoder>\n\t\t\t<pattern>%d %-5.5p [%15.15t] [%30.30c] %X{indent}%m%n</pattern>\n\t\t</encoder>\n\t</appender>\n\n\t\x3c!-- profile --\x3e\n\t\x3c!-- Uncomment if you want to "debug" the TSB: --\x3e\n\t<logger name="com.securosys.ska" level="INFO" />\n\t<logger name="net.javacrumbs.shedlock" level="INFO" />\n\t\x3c!-- Uncomment if you want to "debug" JPA queries: --\x3e\n\t\x3c!-- <logger name="org.hibernate.SQL" level="DEBUG" /> --\x3e\n\t\x3c!-- <logger name="org.hibernate.type.descriptor.sql.BasicBinder" level="TRACE" /> --\x3e\n\t\n    \x3c!-- channels --\x3e\n\t<root level="INFO"> \x3c!-- set the logging level for all appenders --\x3e\n\t\t<appender-ref ref="CONSOLE" />\n\t\t<appender-ref ref="FILE" />\n\t\t\x3c!-- <appender-ref ref="SYSLOG" /> --\x3e\n\t\t\x3c!-- <appender-ref ref="SPLUNK" /> --\x3e\n\t\t\x3c!-- <appender-ref ref="SplunkHEC" /> --\x3e\n\t\t\x3c!-- <appender-ref ref="Socket" /> --\x3e\n\t</root>\n</configuration>\n'})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Log level \u2013 TRACE"}),(0,r.jsx)(t.td,{children:"the lowest level of information, mostly used for very deep code debugging, usually not included in production logs"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Log level - DEBUG"}),(0,r.jsx)(t.td,{children:"low level of information used for debugging purposes, usually not included in production logs"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Log level \u2013 INFO"}),(0,r.jsx)(t.td,{children:"log severity carrying information, like an operation that stared or finished"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Log level - WARN"}),(0,r.jsx)(t.td,{children:"log level informing about an event that may require attention, but is not critical and may be expected"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Log level - ERROR"}),(0,r.jsx)(t.td,{children:"log level telling that an error, expected or unexpected, usually meaning that part of the system in not working properly"})]})]})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"9-setting-up-trusted-execution-environment-configuration-optional",children:"9 Setting up Trusted Execution Environment Configuration (Optional)"}),"\n",(0,r.jsx)(t.p,{children:"Securosys Imunes is a confidential computing platform that offers a trusted execution environment (TEE) for secure code execution on tamper-protected hardware. It can be deployed as a single unit or a cluster of multiple TEEs, enabling various use cases focused on scalability, automation, trust, and confidentiality. The TEE ensures the execution of securely loaded and untampered executables, making it ideal for transactional programs and automating trusted decisions at scale. This chapter specifically covers the setup of the Transaction Security Broker within the Trusted Execution Environment. For complete setup instructions, please download the documentation from the Support Portal. If you have any questions or are interested in TEE, please reach out to our support team."}),"\n",(0,r.jsxs)(t.p,{children:["This is done in the application-tee.yml in a ",(0,r.jsx)(t.em,{children:"new"})," block named tee and general"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"...\ngeneral:\n  allowedTimestampSigningCertificates: # optional, configured certificates can fetch and delete all tasks for an approver\n    - file:/etc/app/config/approval_certs/TIMESTAMP KEY (IMUNES-TSB-PM).pem\n## tee\ntee:\n  approvalInformations:\n    -\n      # Identifier for which approver the information is valid\n      approvalCertificate: 'file:/etc/app/config/tee/TEE OUTPUT KEY.pem'\n      # TEE target system, e.g. 'vitosha.securosys.ch'\n      host: **'vitosha.securosys.ch'** # change to the\n      # TEE target system port, default is '8899'\n      port: '2801'\n      # Partition on the TEE target, e.g. 'USER0'\n      partition: IMUNES-TSB\n      # PEM file with the TLS trust certificate(s).\n      tlsTrustCertificates: 'file:/etc/app/configtee/tls_certificate.pem'\n      # PEM file with the client certificate.\n      clientCertificate: 'file:/etc/app/config/tee/client_certificate.pem'\n      # PEM file with the client key.\n      clientKey: 'file:/etc/app/config/tee/client_key.pem'\n  # The interval in which the TEE client should check for approvals, in milliseconds\n  approvalProcessingInterval: 60000\n...\n"})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Attributes"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Content description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"allowedTimestampSigningCertificate"}),(0,r.jsx)(t.td,{children:"List of configured certificates, which can fetch and delete all tasks for an approver"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"approvalCertificate"}),(0,r.jsx)(t.td,{children:"Identified for which approver the information is valid"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"host"}),(0,r.jsx)(t.td,{children:"The host of where Trusted Execution is running on"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"port"}),(0,r.jsx)(t.td,{children:"The port to be used for trusted execution, default is 2801"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"partition"}),(0,r.jsx)(t.td,{children:"The Partition which is configured for Trusted Execution Environment"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"tlsTrustCertificates"}),(0,r.jsx)(t.td,{children:"The Trust certificate issued by TEE deficedevice"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"clientCertificate"}),(0,r.jsx)(t.td,{children:"The client certificate in PEM format"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"clientKey"}),(0,r.jsx)(t.td,{children:"The client kKey for mTLS to connect to the TEE device in PEM format"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"approvalProcessingInterval"}),(0,r.jsx)(t.td,{children:"The interval in which the TEE client should check for approvals, in milisecondsmilliseconds"})]})]})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h1,{id:"10-docker-installation---linux",children:"10 Docker installation - Linux"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Install Docker Engine on Linux"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:':~/$ sudo apt-get update\n:~/$ sudo apt-get install ca-certificates curl gnupg lsb-release\n:~/$ sudo install -m 0755 -d /etc/apt/keyrings\n:~/$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n:~/$ sudo chmod a+r /etc/apt/keyrings/docker.gpg\n:~/$ **curl** -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n:~/$ echo "deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu "$(. /etc/os-release && echo "$VERSION\\_CODENAME")" stable" | sudo tee /etc/apt/sources.list.d/docker.list \\> /dev/null\n:~/$ sudo apt-get update\n:~/$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n:~/$ sudo **systemctl** enable docker\n:~/$ sudo **systemctl** restart docker\n'})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Create docker group and assign user, then ",(0,r.jsx)(t.strong,{children:"logout"})," and ",(0,r.jsx)(t.strong,{children:"login"})," again to take affect on the group changes"]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:":~/$ sudo groupadd docker\n:~/$ sudo usermod -aG docker <CURRENT_USERNAME_ON_HOST>\n:~/$ sudo usermod -aG docker <CURRENT_USERNAME_ON_HOST>\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Test Installation"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:":~/$ docker \u2013version\n:~/$ docker-compose -version\n:~/$ sudo docker run hello-world\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"11-testing-and-troubleshooting",children:"11 Testing and Troubleshooting"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"**Error **"}),(0,r.jsx)(t.th,{children:"**Possible solutions **"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"securosys_tsb container doesn't start"}),(0,r.jsxs)(t.td,{children:["1) Ensure, that mariadb container is running: docker container ls ",(0,r.jsx)("br",{})," 2) Check container logs for possible configuration/connection issues docker container logs securosys_tsb"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Cannot connect to the TSB API/Swagger"}),(0,r.jsxs)(t.td,{children:["1. By default, the TSB API is accessible through port 8080, so ensure that your requests are directed to this port unless you have made changes to the configuration. ",(0,r.jsx)("br",{}),'2. Test the local connection to the API by attempting to access it from your browser or Linux console using the command "wget ',(0,r.jsx)(t.a,{href:"http://localhost:8080/api",children:"http://localhost:8080/api"}),'". If successful, consider two possible solutions: create a host-only network in VirtualBox to connect from the host to the VirtualBox guest, or check for any firewall settings that may be blocking the connection to the specified port.']})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Caused by: com.securosys.primus.jce.spi0.SpiException: status: PKCS#11: GENERAL_ERROR; for key attestation-key"})}),(0,r.jsxs)(t.td,{children:["You will have to Install and setup Root Key Store, before TSB can create the required keys. ",(0,r.jsx)("br",{})," Connected with the HSM-Console type: ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," ",(0,r.jsx)(t.code,{children:"hsm_sec_install_rke"})," - Install root key element firmware (root key store and ais20/31-rng) ",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(t.code,{children:"hsm_sec_setup_rks"})," - Initialize new keys in the root key store"]})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"111-user-login-to-artifactory-but-fails-due-to-lack-or-misconfiguration-of-credential-store",children:"11.1 User Login to Artifactory but fails due to lack or misconfiguration of credential store."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:':~/securosys_tsb$ docker login securosys.jfrog.io -u robot.reader.tsb\nPassword:\nError saving credentials: error storing credentials - err: exit status 1, out: `Failed to execute child process "dbus-launch" (No such file or directory)`\n'})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Solution"})," : ",(0,r.jsx)(t.code,{children:"sudo apt install gnupg2 pass"})]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(t.h1,{id:"copyright-notice",children:"Copyright Notice"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsx)(t.tr,{children:(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Copyright Notice"})})})}),(0,r.jsx)(t.tbody,{children:(0,r.jsx)(t.tr,{children:(0,r.jsx)(t.td,{children:"Copyright \xa9 2018 - 2024 Securosys SA. All rights reserved. The programs (which include both the software and documentation) contain proprietary information of Securosys SA; they are provided under a license agreement containing restrictions on use and disclosure and are also protected by copyright, patent and other intellectual and industrial property law. Reverse engineering, disassembly or decompilation of the Programs is prohibited. Program documentation is licensed for use solely to support the deployment of the programs and not for any other purpose. The information contained in this document is subject to change without notice. If you find any problems in the documentation, please report them to us in writing. Securosys SA does not warrant that this document is error free and assumes no responsibility for any inaccuracies. Except as may be expressly permitted in your license agreement for these programs, no part of these programs may be reproduced or transmitted in any form or by any means, electronic or mechanical, for any purpose, without the express written permission of Securosys SA. Securosys SA reserves the right to change, modify, transfer, or otherwise revise this publication without notice.Copyright \xa9 2020 Securosys SA. All rights reserved.All information is subject to change without notice. Securosys SA assumes no responsibility for any inaccuracies in this document or for any obligation to update information in this document. Securosys SA reserves the right to change, modify, transfer, or otherwise revise this publication without notice."})})})]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);