"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[74377],{28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var r=n(96540);const l={},t=r.createContext(l);function a(e){const s=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),r.createElement(t.Provider,{value:s},e.children)}},73090:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Tutorials/manage_keys","title":"Manage Keys - Secrets Engine plugin for HashiCorp Vault","description":"Manage Keys for Securosy\' Secrets Engine plugin for HashiCorp Vault","source":"@site/hc_sse/Tutorials/manage_keys.md","sourceDirName":"Tutorials","slug":"/Tutorials/manage_keys","permalink":"/hc_sse/Tutorials/manage_keys","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Manage Keys - Secrets Engine plugin for HashiCorp Vault","sidebar_label":"Manage Keys","description":"Manage Keys for Securosy\' Secrets Engine plugin for HashiCorp Vault","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Tutorial","permalink":"/hc_sse/category/tutorial"},"next":{"title":"Cryptographic Operations","permalink":"/hc_sse/Tutorials/cryptographic_operations"}}');var l=n(74848),t=n(28453);const a={sidebar_position:1,title:"Manage Keys - Secrets Engine plugin for HashiCorp Vault",sidebar_label:"Manage Keys",description:"Manage Keys for Securosy' Secrets Engine plugin for HashiCorp Vault",keywords:["hsm","cloud hsm"]},i="Manage Keys",o={},c=[{value:"List all the keys",id:"list-all-the-keys",level:2},{value:"List the key versions",id:"list-the-key-versions",level:2},{value:"Read key information",id:"read-key-information",level:2},{value:"Write",id:"write",level:2},{value:"Register a key",id:"register-a-key",level:2},{value:"Create Key by Type Name",id:"create-key-by-type-name",level:2},{value:"Import a key",id:"import-a-key",level:2},{value:"Export a key",id:"export-a-key",level:2},{value:"Modify a key",id:"modify-a-key",level:2},{value:"Update the key password",id:"update-the-key-password",level:2},{value:"Rotate a Key",id:"rotate-a-key",level:2},{value:"Block a Key",id:"block-a-key",level:2},{value:"Unblock a key",id:"unblock-a-key",level:2},{value:"Delete a Key",id:"delete-a-key",level:2},{value:"Key attestation",id:"key-attestation",level:2}];function d(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"manage-keys",children:"Manage Keys"})}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.strong,{children:"Secrets Engine"})," plugin allows to create, modify, and manage keys on your Securosys Hardware Security Modules (HSMs), Cloud & On-premises, with the following command sets:"]}),"\n",(0,l.jsx)(s.h2,{id:"list-all-the-keys",children:"List all the keys"}),"\n",(0,l.jsxs)(s.p,{children:["List all the keys stored in the ",(0,l.jsx)(s.strong,{children:"Secrets Engine"})," plugin:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault list securosys-hsm/keys\n"})}),"\n",(0,l.jsx)(s.p,{children:"or for more a more detailed list:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault list -detailed securosys-hsm/keys\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request LIST '<server_addr>/v1/securosys-hsm/keys' \\\n--header 'X-Vault-Token: <vault_access_token>'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"list-the-key-versions",children:"List the key versions"}),"\n",(0,l.jsxs)(s.p,{children:["List all the key versions stored in the ",(0,l.jsx)(s.strong,{children:"Secrets Engine"})," plugin:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault list securosys-hsm/keys/{key-name}\n"})}),"\n",(0,l.jsx)(s.p,{children:"or for a more detailed list"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault list -detailed securosys-hsm/keys/{key-name}\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request LIST '<server_addr>/v1/securosys-hsm/keys' \\\n--header 'X-Vault-Token: <vault_access_token>'\n"})}),"\n",(0,l.jsx)(s.h2,{id:"read-key-information",children:"Read key information"}),"\n",(0,l.jsxs)(s.p,{children:["Read the stored key informaton such as ",(0,l.jsx)(s.strong,{children:"key label"}),", ",(0,l.jsx)(s.strong,{children:"policy"})," or ",(0,l.jsx)(s.strong,{children:"public key"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault read securosys-hsm/keys/{key-name} \n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request GET '<server_addr>/v1/securosys-hsm/keys/{key-name}' \\\n--header 'X-Vault-Token: <vault_access_token>'\n"})}),"\n",(0,l.jsx)(s.p,{children:"The result of this command will be"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{children:"Key           Value\n---           ---\nalgorithm     {key-type}            //For example: RSA, AES etc.\nattributes    {key-attributes}\nkey_size      {key-size}\nkeyLabel      {key-label-hsm}\npolicy        {policy}              //If exists\npublic_key    {public-key-from-hsm} //If exists. Only in asymetric key\ncurveOid      {cureveoid}           //If exists. Only in EC or ED algorithms\n...\n"})}),"\n",(0,l.jsx)(s.h2,{id:"write",children:"Write"}),"\n",(0,l.jsxs)(s.p,{children:["Create or update a key on your ",(0,l.jsx)(s.strong,{children:"Hardware Security Module (HSM)"})," and store the reference in ",(0,l.jsx)(s.strong,{children:"Secrets Engine"}),"."]}),"\n",(0,l.jsx)(s.p,{children:"Key types available:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"aes"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"keySize"}),"[128,192,256]\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"bls"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"})," and ",(0,l.jsx)(s.strong,{children:"attributes"}),"\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"policy"})," and ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"camellia"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"keySize"}),"[128,192,256]\n",(0,l.jsx)(s.em,{children:"Optionally:"}),"  ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"chacha20"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"})," and ",(0,l.jsx)(s.strong,{children:"attributes"}),"\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"dsa"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"keySize"}),"[512,1024,2048]\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"policy"})," and ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"ec"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"curveOid"}),"\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"policy"})," and ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"ed"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"curveOid"}),"\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"policy"})," and ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"rsa"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"})," and ",(0,l.jsx)(s.strong,{children:"keySize"}),"[1024,2048,3072,4096]\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"policy"})," and ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"tdea"})}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.em,{children:"Required:"})," ",(0,l.jsx)(s.strong,{children:"keyLabel"}),", ",(0,l.jsx)(s.strong,{children:"attributes"}),"\n",(0,l.jsx)(s.em,{children:"Optionally:"})," ",(0,l.jsx)(s.strong,{children:"password"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.admonition,{title:"Fields description",type:"info",children:(0,l.jsxs)(s.p,{children:["All the fields are described in ",(0,l.jsx)(s.a,{href:"/hc_sse/Tutorials/key_arguments",children:"this section"}),"."]})}),"\n",(0,l.jsx)(s.admonition,{title:"Important",type:"warning",children:(0,l.jsxs)(s.p,{children:["By default, all the keys created via ",(0,l.jsx)(s.strong,{children:"Secrets Engine"})," have set the key attributes [destroyable] and [modifiable]. These attributes can be changed or extended by defining them in the ",(0,l.jsx)(s.code,{children:"attributes"})," argument."]})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'$ vault write securosys-hsm/keys/{key-type}/{key-name} \nkeyLabel="{key-label-hsm}"\nkeySize={key-size} \n#{key-attriute}:{true/false}\nattributes=\'{"decrypt": true,"sign": false,"unwrap": true,"derive": true,"sensitive": true,"extractable": false,"modifiable": true,"copyable": false,"destroyable": true}\'\n'})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'curl --location --request PUT \'<server_addr>/v1/securosys-hsm/keys/{key-type}/{key-name}\' \\\n--header \'X-Vault-Token: <vault_access_token>\' \\\n--header \'Content-Type: application/x-www-form-urlencoded\' \\\n--data-urlencode \'keyLabel={key-label-hsm}\' \\\n--data-urlencode \'keySize={key-size}\' \\\n--data-urlencode \'attributes={\n    #{key-attriute}:{true/false}\n    "decrypt": true,\n    "sign": false,\n    "unwrap": true,\n    "derive": true,\n    "sensitive": true,\n    "alwaysSensitive": true,\n    "extractable": false,\n    "neverExtractable": true,\n    "modifiable": true,\n    "copyable": false,\n    "destroyable": true\n}\'\n'})}),"\n",(0,l.jsx)(s.p,{children:"Or here an example creating a key with attached simple ska policy:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'$ vault write securosys-hsm/keys/{key-type}/{key-name} \nkeyLabel="{key-label-hsm}"\nkeySize={key-size} \n#{key-attriute}:{true/false}\nattributes=\'{"decrypt": true,"sign": false,"unwrap": true,"derive": true,"sensitive": true,"extractable": false,"modifiable": true,"copyable": false,"destroyable": true}\' \nsimplePolicy=-<<EOF\n    {\n    "NameOfApprover": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArBohRHhXXjQMNlxWMmCX0fxbpcMyu3bwBerkfeTl8QoOZbDV003t1n9drCuGOJJP16sZRBkYa5C7QkFCyb10Lbp1sp8jqWVu5PQy9qEaLl4y2BW+AOs0pURv1nlyo+gFgJD6lX0QmtZDjaD98C/wC5RVXipr4nJmT5XvwCPmgz9TpgVgFMwrflPJK9mHgYKwvmPODLYSLbohkj4TWKAoL417URhPazNWJBC7fKRui3EA7a8yzuzOSVgGxjY3aeqitmZyCTJtWa2U2/UwLZRT2ISwXv0zvsBhRSbXXcFdCApgKiy9uL1tPq40DnT8cesZzKd8hDYJ5S34wwmSZKbtGwIDAQAB"\n    }\nEOF\n'})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'curl --location --request PUT \'<server_addr>/v1/securosys-hsm/keys/{key-type}/{key-name}\' \\\n--header \'X-Vault-Token: <vault_access_token>\' \\\n--header \'Content-Type: application/x-www-form-urlencoded\' \\\n--data-urlencode \'keyLabel={key-label-hsm}\' \\\n--data-urlencode \'keySize={key-size}\' \\\n--data-urlencode \'attributes={\n    #{key-attriute}:{true/false}\n    "decrypt": true,\n    "sign": false,\n    "unwrap": true,\n    "derive": true,\n    "sensitive": true,\n    "alwaysSensitive": true,\n    "extractable": false,\n    "neverExtractable": true,\n    "modifiable": true,\n    "copyable": false,\n    "destroyable": true\n}\' \\\n--data-urlencode \'simplePolicy={\n    #{name}:{public_key}\n    "NameOfApprover": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArBohRHhXXjQMNlxWMmCX0fxbpcMyu3bwBerkfeTl8QoOZbDV003t1n9drCuGOJJP16sZRBkYa5C7QkFCyb10Lbp1sp8jqWVu5PQy9qEaLl4y2BW+AOs0pURv1nlyo+gFgJD6lX0QmtZDjaD98C/wC5RVXipr4nJmT5XvwCPmgz9TpgVgFMwrflPJK9mHgYKwvmPODLYSLbohkj4TWKAoL417URhPazNWJBC7fKRui3EA7a8yzuzOSVgGxjY3aeqitmZyCTJtWa2U2/UwLZRT2ISwXv0zvsBhRSbXXcFdCApgKiy9uL1tPq40DnT8cesZzKd8hDYJ5S34wwmSZKbtGwIDAQAB"\n}\'\n'})}),"\n",(0,l.jsx)(s.p,{children:"Where:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"simplePolicy"})," has to be a ",(0,l.jsx)(s.strong,{children:"JSON"})," object in which ",(0,l.jsx)(s.strong,{children:"Key"})," is the name of the approval (or the approver) and"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Value"})," has to be a valid ",(0,l.jsx)(s.strong,{children:"RSA public key"}),' (without the "-- Begin..." and "-- End..." lines nor line breaks).']}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"The result of these commands will show information about the created key."}),"\n",(0,l.jsxs)(s.admonition,{title:"Tip",type:"tip",children:[(0,l.jsxs)(s.p,{children:["Full Smart Key Attribute (SKA) policy ",(0,l.jsx)(s.strong,{children:"json"})," can be provided by using the ",(0,l.jsx)(s.strong,{children:"policy"})," attribute in place of ",(0,l.jsx)(s.strong,{children:"simplePolicy"}),"."]}),(0,l.jsxs)(s.p,{children:["Since a policy JSON statement can be quite large, it may be challenging to edit it on the command line. In such case, it is recommended to attach a file with the json, using the attribute ",(0,l.jsx)(s.strong,{children:'"policy=@file.json"'}),"."]}),(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"/hc_sse/Tutorials/examples/policy_example",children:"View an example of a policy json file"}),"."]})]}),"\n",(0,l.jsx)(s.h2,{id:"register-a-key",children:"Register a key"}),"\n",(0,l.jsx)(s.p,{children:"Register an existing key stored on the Hardware Security Module (HSM) to Secrets Engine"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/register keyLabel={label-of-key-on-hsm}\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/register' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'keyLabel={label-of-key-on-hsm}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,l.jsxs)(s.p,{children:["This ",(0,l.jsx)(s.code,{children:"key"})," will be registered in Secrets Engine with the name ",(0,l.jsx)(s.code,{children:"{key-name}"})]})}),"\n",(0,l.jsx)(s.h2,{id:"create-key-by-type-name",children:"Create Key by Type Name"}),"\n",(0,l.jsxs)(s.p,{children:["Create a key using key types compatible with HashiCorp Key Management. (",(0,l.jsx)(s.a,{href:"https://developer.hashicorp.com/vault/api-docs/secret/key-management",children:"https://developer.hashicorp.com/vault/api-docs/secret/key-management"}),")"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Available key types:"})}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Key Type"}),(0,l.jsx)(s.th,{children:"Description"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"aes256-gcm96"}),(0,l.jsxs)(s.td,{children:["AES-GCM with a 256-bit AES key and a 96-bit nonce (",(0,l.jsx)(s.strong,{children:"symmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"rsa-2048"}),(0,l.jsxs)(s.td,{children:["RSA with bit size of 2048 (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"rsa-3072"}),(0,l.jsxs)(s.td,{children:["RSA with bit size of 3072 (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"rsa-4096"}),(0,l.jsxs)(s.td,{children:["RSA with bit size of 4096 (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"ecdsa-p256"}),(0,l.jsxs)(s.td,{children:["ECDSA using the P-256 elliptic curve (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"ecdsa-p384"}),(0,l.jsxs)(s.td,{children:["ECDSA using the P-384 elliptic curve (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"ecdsa-p521"}),(0,l.jsxs)(s.td,{children:["ECDSA using the P-521 elliptic curve (",(0,l.jsx)(s.strong,{children:"asymmetric"}),")"]})]})]})]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/type/{key-type-name}/{key-name} keyLabel={label-of-key-on-hsm}\nalgorithm={key-algorithm}\nattributes={key-attributes}\npassword={password}\nsimplePolicy={policy} or policy={full-policy} or policy=@policy-file.json\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/type/{key-type-name}/{key-name}' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'keyLabel={label-of-key-on-hsm}' \\\n--data-urlencode 'algorithm={key-algorithm}' \\\n--data-urlencode 'attributes={key-attributes}' \\\n--data-urlencode 'password={password}' \\\n--data-urlencode 'simplePolicy={policy}' or --data-urlencode 'policy={full-policy}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,l.jsxs)(s.p,{children:["This key will be generated in Secrets Engine with the name ",(0,l.jsx)(s.code,{children:"{key-name}"})]})}),"\n",(0,l.jsx)(s.h2,{id:"import-a-key",children:"Import a key"}),"\n",(0,l.jsx)(s.p,{children:"Import a new key into the HSM"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/import \nkeyLabel={label-of-key-on-hsm}\nprivateKey={private-key-base64}\npublicKey={public-key-base64}\nsecretKey={secret-key-base64}\ncertificate={certificate-base64}\nalgorithm={key-algorithm}\nattributes={key-attributes}\nsimplePolicy={policy} or policy={full-policy} or policy=@policy-file.json\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/import' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'keyLabel={label-of-key-on-hsm}' \\\n--data-urlencode 'privateKey={private-key-base64}' \\\n--data-urlencode 'publicKey={public-key-base64}' \\\n--data-urlencode 'secretKey={secret-key-base64}' \\\n--data-urlencode 'certificate={certificate-base64}' \\\n--data-urlencode 'algorithm={key-algorithm}' \\\n--data-urlencode 'attributes={key-attributes}' \\\n--data-urlencode 'simplePolicy={policy}' or --data-urlencode 'policy={full-policy}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,l.jsxs)(s.p,{children:["This key will be labeled in Secrets Engine with ",(0,l.jsx)(s.code,{children:"{key-name}"})]})}),"\n",(0,l.jsx)(s.h2,{id:"export-a-key",children:"Export a key"}),"\n",(0,l.jsx)(s.p,{children:"Export public_key, private_key, or secret from a key stored on the HSM"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/export [password={password-for-a-key}]\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/export' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'password={password-for-a-key}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Note",type:"note",children:(0,l.jsxs)(s.p,{children:["Omit the ",(0,l.jsx)(s.strong,{children:"password"})," parameter in case no password is set."]})}),"\n",(0,l.jsx)(s.h2,{id:"modify-a-key",children:"Modify a key"}),"\n",(0,l.jsxs)(s.p,{children:["Modify the Smart Key Attreibute (SKA) policy of a key stored on the Hardware Security Module (HSM).\nIn case the key has a policy attached, then a request-id is returned indicating the required approvals to collect. See section ",(0,l.jsx)(s.a,{href:"/hc_sse/Tutorials/requests",children:"Requests"}),"."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/modify     \n[simplePolicy={policy} | policy={full-policy} | policy=@policy-file.json]\n[password={password-for-a-key}]\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/modify' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'simplePolicy={policy}' or  --data-urlencode 'policy={full-policy}' \\\n--data-urlencode 'password={password-for-a-key}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Note",type:"note",children:(0,l.jsxs)(s.p,{children:["Omit the ",(0,l.jsx)(s.strong,{children:"password"})," parameter in case no password is set."]})}),"\n",(0,l.jsx)(s.h2,{id:"update-the-key-password",children:"Update the key password"}),"\n",(0,l.jsx)(s.p,{children:"Modify the password of a key on the HSM"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:'$ vault write securosys-hsm/keys/{key-name}/update-password password={current-password} newPassword="{new-password}"\n'})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/update-password' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'password={current-password}' \\\n--data-urlencode 'newPassword={new-password}' \\\n"})}),"\n",(0,l.jsx)(s.h2,{id:"rotate-a-key",children:"Rotate a Key"}),"\n",(0,l.jsx)(s.p,{children:"Rotate a key. A new key will be generated on the HSM with the same base name as the original key with an incremented version tag at the end of the original key name (_v2, _v3, ...). The previous key will remain on the HSM."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/rotate\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/rotate' \\\n--header 'X-Vault-Token: <vault_access_token>' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,l.jsxs)(s.p,{children:["Decrypt, verify, unwrap etc. is still possible by providing the parameter  ",(0,l.jsx)(s.strong,{children:"keyVersion"})," in the request. All other operations like encrypt, sign, wrap, block, unblock, password etc. will always use the last key version."]})}),"\n",(0,l.jsx)(s.h2,{id:"block-a-key",children:"Block a Key"}),"\n",(0,l.jsxs)(s.p,{children:["Block a key stored on the HSM\nIn case the key has a policy attached, then a request-id is returned indicating the required approvals to collect. See section ",(0,l.jsx)(s.a,{href:"/hc_sse/Tutorials/requests",children:"Requests"}),"."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/block [password={password-for-a-key}]\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/block' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'password={password-for-a-key}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Note",type:"note",children:(0,l.jsxs)(s.p,{children:["Omit the ",(0,l.jsx)(s.strong,{children:"password"})," parameter in case no password is set."]})}),"\n",(0,l.jsx)(s.h2,{id:"unblock-a-key",children:"Unblock a key"}),"\n",(0,l.jsxs)(s.p,{children:["Unblock a key stored on the HSM\nIn case the key has a policy attached, then a request-id is returned indicating the required approvals to collect. See section ",(0,l.jsx)(s.a,{href:"/hc_sse/Tutorials/requests",children:"Requests"}),"."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault write securosys-hsm/keys/{key-name}/unblock [password={password-for-a-key}]\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request PUT '<server_addr>/v1/securosys-hsm/keys/{key-name}/unblock' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--data-urlencode 'password={password-for-a-key}'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Note",type:"note",children:(0,l.jsxs)(s.p,{children:["Omit the ",(0,l.jsx)(s.strong,{children:"password"})," parameter in case no password is set."]})}),"\n",(0,l.jsx)(s.h2,{id:"delete-a-key",children:"Delete a Key"}),"\n",(0,l.jsxs)(s.p,{children:["Remove a key from the ",(0,l.jsx)(s.strong,{children:"HSM"})," and ",(0,l.jsx)(s.strong,{children:"Secrets Engine"})]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault delete securosys-hsm/keys/{key-name} [removeFromHSM=true]\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request DELETE '<server_addr>/v1/securosys-hsm/keys/{key-name}' \\\n--header 'X-Vault-Token: <vault_access_token>'\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,l.jsxs)(s.p,{children:["This operation removes the key only from the ",(0,l.jsx)(s.strong,{children:"Secrets Engine"}),". It does not remove the key from the ",(0,l.jsx)(s.strong,{children:"HSM"}),". To remove all key versions from the HSM as well, then add the property ",(0,l.jsx)(s.strong,{children:"removeFromHSM"})," with ",(0,l.jsx)(s.strong,{children:(0,l.jsx)(s.em,{children:"true"})})," value."]})}),"\n",(0,l.jsx)(s.h2,{id:"key-attestation",children:"Key attestation"}),"\n",(0,l.jsx)(s.p,{children:"Fetch a key attestation from the HSM in XML format, signed with the HSMs attestation key:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"$ vault read securosys-hsm/keys/{key-name}/xml\n"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"curl --location --request GET '<server_addr>/v1/securosys-hsm/keys/{key-name}/xml' \\\n--header 'X-Vault-Token: <vault_access_token>'\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n"})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);