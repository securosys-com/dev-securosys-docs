"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[76471],{4254:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/hgs_diagram-076e295aa1206279197216c438066ba6.jpg"},28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>o});var n=r(96540);const s={},i=n.createContext(s);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(i.Provider,{value:t},e.children)}},31430:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"overview","title":"Microsoft Host Guard Service - HSM Integration","description":"HSM Integration Guide","source":"@site/ms-hgs/overview.md","sourceDirName":".","slug":"/overview","permalink":"/ms-hgs/overview","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Microsoft Host Guard Service - HSM Integration","sidebar_label":"Overview","grid_title":"Microsoft Host Guardian Service (HGS)","grid_search_tags":["MSCNG"],"grid_description":"Secures private keys for Microsoft Host Guardian Service (HGS) with Securosys HSMs, ensuring protection of encryption keys for shielded VMs and compliance with trusted environments.","grid_categories":["MSCNG"],"grid_tile_logoUrl":"/img/company_logo/microsoft.png"},"sidebar":"tutorialSidebar","next":{"title":"Quickstart","permalink":"/ms-hgs/Quickstart"}}');var s=r(74848),i=r(28453);r(65537),r(79329);const a={sidebar_position:0,title:"Microsoft Host Guard Service - HSM Integration",sidebar_label:"Overview",grid_title:"Microsoft Host Guardian Service (HGS)",grid_search_tags:["MSCNG"],grid_description:"Secures private keys for Microsoft Host Guardian Service (HGS) with Securosys HSMs, ensuring protection of encryption keys for shielded VMs and compliance with trusted environments.",grid_categories:["MSCNG"],grid_tile_logoUrl:"/img/company_logo/microsoft.png"},o="Microsoft Host Guardian Service",l={},c=[{value:"HSM Integration Guide",id:"hsm-integration-guide",level:3},{value:"Attestation Workflow for Running Shielded VMs on HGS",id:"attestation-workflow-for-running-shielded-vms-on-hgs",level:2},{value:"Target Audience",id:"target-audience",level:2},{value:"Support Contact",id:"support-contact",level:2},{value:"What&#39;s Next",id:"whats-next",level:2}];function u(e){const t={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"microsoft-host-guardian-service",children:"Microsoft Host Guardian Service"})}),"\n",(0,s.jsx)(t.h3,{id:"hsm-integration-guide",children:"HSM Integration Guide"}),"\n",(0,s.jsxs)(t.p,{children:["This document describes how to secure private keys used by the ",(0,s.jsx)(t.strong,{children:"Microsoft Host Guardian"})," by using the Securosys Primus HSM or Securosys CloudHSM service."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows-server/security/guarded-fabric-shielded-vm/guarded-fabric-manage-hgs",children:"Microsoft Host Guardian Service (HGS)"})," is the centerpiece of the guarded fabric solution. It is responsible for ensuring that Hyper-V hosts in the fabric are known to the hoster or enterprise and running trusted software and for managing the keys used to start up shielded VMs."]}),"\n",(0,s.jsx)(t.p,{children:"Securosys Primus HSMs safeguard the keys used to encrypt and sign protected virtual machines (VMs). These keys are securely stored in an encrypted format on the Host Guardian Server (HGS). Guarded Hosts provide a trusted environment to create and run Shielded VMs. The HGS verifies the trustworthiness of a Guarded Host before releasing the decryption key necessary to unlock the VM."}),"\n",(0,s.jsx)(t.p,{children:"The decryption key is only released when the HGS confirms that the VM is in a verified clean state and has not been tampered with. This verification relies on a certificate issued by the HGS, attesting to the VM\u2019s integrity."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:r(4254).A+"",width:"827",height:"543"})}),"\n",(0,s.jsx)(t.p,{children:"The Primus HSMs are built to securely generate and store true random cryptographic keys, providing a central, certified secure storage. They also control and regulate access to the keys and the related cryptographic functionality. The Primus HSM combined with HGS meets or exceeds the best practice security requirements and is one step ahead of fulfilling your compliance demands by providing:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Hardware-based secure generation of true random cryptographic keys,"}),"\n",(0,s.jsx)(t.li,{children:"Central and highly secure storage of cryptographic keys,"}),"\n",(0,s.jsx)(t.li,{children:"Load balancing and fail-over by clustering the HSMs,"}),"\n",(0,s.jsx)(t.li,{children:"Controlled and regulated access to the keys,"}),"\n",(0,s.jsx)(t.li,{children:"Hardware acceleration of cryptographic operations such as encryption, authentication, and digital signatures, relieving the host server of processor intensive computations,"}),"\n",(0,s.jsx)(t.li,{children:"Scalable performance at manageable cost."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["All certificate issuance and validation processes occur within the protected confines of the HSM. Private keys are never accessible outside the HSM.\nThe Primus HSM can easily be integrated in a Microsoft Windows system by installing the ",(0,s.jsx)(t.a,{href:"../../mscng/overview",children:"Primus CNG Provider"}),". This enables all Windows servers and clients to generate and store their private keys and certificates securely in the HSMs, and perform all related cryptographic functionality, like signing or certificate validation, hardware accelerated on the Primus HSM."]}),"\n",(0,s.jsx)(t.h2,{id:"attestation-workflow-for-running-shielded-vms-on-hgs",children:"Attestation Workflow for Running Shielded VMs on HGS"}),"\n",(0,s.jsx)(t.p,{children:"The general workflow for running Shielded Virtual Machines on Guarded hosts:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"A user requests the Guarded Host to run the Shielded VM. The Guarded Host requests for a key."}),"\n",(0,s.jsx)(t.li,{children:"The HGS initially doubts the legitimacy of the host."}),"\n",(0,s.jsx)(t.li,{children:"The Guarded Host provides health data established during its initial setup."}),"\n",(0,s.jsx)(t.li,{children:"The HGS validates the host's health and issues a certificate."}),"\n",(0,s.jsx)(t.li,{children:"The Guarded Host sends a follow-up request with the certificate."}),"\n",(0,s.jsx)(t.li,{children:"The HGS delivers the encrypted key to the Guarded Host, enabling the VM to operate."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"target-audience",children:"Target Audience"}),"\n",(0,s.jsx)(t.p,{children:"This document is intended for Securosys Primus HSM or Microsoft administrators and IT professionals in charge of the Microsoft Windows Host Guardian Service administration. This guide requires that you are already familiar with Microsoft Windows Server as well as Host Guardian Service and Hyper-V administration."}),"\n",(0,s.jsx)(t.p,{children:"For on-premises HSM deployed operation administrative skills are required for Securosys Primus HSMs."}),"\n",(0,s.jsx)(t.h2,{id:"support-contact",children:"Support Contact"}),"\n",(0,s.jsxs)(t.p,{children:["If you encounter a problem while installing/configuring the provider or\nintegrating the HSM with Microsoft SignTool, make sure that you have read the\nreferenced documentation. If you cannot resolve the issue, please\ncontact Securosys Customer Support. For specific requests regarding\nSecurosys integration, the Securosys\nSupport Portal is reachable under ",(0,s.jsx)(t.a,{href:"https://support.securosys.com",children:"https://support.securosys.com"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"whats-next",children:"What's Next"}),"\n",(0,s.jsx)(t.p,{children:"For a smooth start integrating your Primus HSM with Microsoft HGS using the Primus CNG/KSP Provider:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Consult the ",(0,s.jsx)(t.a,{href:"/ms-hgs/Quickstart",children:"Quick Start"})," for a comprehensive task listing."]}),"\n",(0,s.jsxs)(t.li,{children:["For detailed instructions, read and follow the ",(0,s.jsx)(t.a,{href:"/ms-hgs/Installation/",children:"Installation"})," guide."]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},65537:(e,t,r)=>{r.d(t,{A:()=>w});var n=r(96540),s=r(34164),i=r(65627),a=r(56347),o=r(50372),l=r(30604),c=r(11861),u=r(78749);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:s}}=e;return{value:t,label:r,attributes:n,default:s}}))}(r);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function p(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:r}=e;const s=(0,a.W6)(),i=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l.aZ)(i),(0,n.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(s.location.search);t.set(i,e),s.replace({...s.location,search:t.toString()})}),[i,s])]}function g(e){const{defaultValue:t,queryString:r=!1,groupId:s}=e,i=h(e),[a,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:i}))),[c,d]=f({queryString:r,groupId:s}),[g,m]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,i]=(0,u.Dv)(r);return[s,(0,n.useCallback)((e=>{r&&i.set(e)}),[r,i])]}({groupId:s}),v=(()=>{const e=c??g;return p({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{v&&l(v)}),[v]);return{selectedValue:a,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,i]),tabValues:i}}var m=r(9136);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=r(74848);function b(e){let{className:t,block:r,selectedValue:n,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),u=e=>{const t=e.currentTarget,r=l.indexOf(t),s=o[r].value;s!==n&&(c(t),a(s))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;t=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;t=l[r]??l[l.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},t),children:o.map((e=>{let{value:t,label:r,attributes:i}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>{l.push(e)},onKeyDown:d,onClick:u,...i,className:(0,s.A)("tabs__item",v.tabItem,i?.className,{"tabs__item--active":n===t}),children:r??t},t)}))})}function S(e){let{lazy:t,children:r,selectedValue:i}=e;const a=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===i));return e?(0,n.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function x(e){const t=g(e);return(0,y.jsxs)("div",{className:(0,s.A)("tabs-container",v.tabList),children:[(0,y.jsx)(b,{...t,...e}),(0,y.jsx)(S,{...t,...e})]})}function w(e){const t=(0,m.A)();return(0,y.jsx)(x,{...e,children:d(e.children)},String(t))}},79329:(e,t,r)=>{r.d(t,{A:()=>a});r(96540);var n=r(34164);const s={tabItem:"tabItem_Ymn6"};var i=r(74848);function a(e){let{children:t,hidden:r,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.A)(s.tabItem,a),hidden:r,children:t})}}}]);