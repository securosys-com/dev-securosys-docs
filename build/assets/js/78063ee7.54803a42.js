"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[77452],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(96540);const s={},a=r.createContext(s);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:n},e.children)}},78727:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Installation/permanent_secret_management","title":"PKCS#11 - Permanent Secret Fetching","description":"On initial setup and configuration of a Primus HSM partition, the","source":"@site/pkcs/Installation/permanent_secret_management.md","sourceDirName":"Installation","slug":"/Installation/permanent_secret_management","permalink":"/pkcs/Installation/permanent_secret_management","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"PKCS#11 - Permanent Secret Fetching","sidebar_label":"Permanent Secret Fetching"},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/pkcs/Installation/pkcs11_provider_configuration"},"next":{"title":"Tutorial","permalink":"/pkcs/category/tutorial"}}');var s=t(74848),a=t(28453);const i={sidebar_position:3,title:"PKCS#11 - Permanent Secret Fetching",sidebar_label:"Permanent Secret Fetching"},o="Permanent Secret Fetching",c={},d=[{value:"Adding Permanent Secret",id:"adding-permanent-secret",level:2},{value:"Updating Permanent Secret",id:"updating-permanent-secret",level:2},{value:"Removing Permanent Secret",id:"removing-permanent-secret",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"permanent-secret-fetching",children:"Permanent Secret Fetching"})}),"\n",(0,s.jsxs)(n.p,{children:["On initial setup and configuration of a Primus HSM partition, the\ninstallation process (Security Officer of the HSMs) generates a\npartition ",(0,s.jsx)(n.strong,{children:"setup password"}),' for a given user. The setup password is a\n29-alphanumeric dash separated string in the form of\n"FXAJX-XWVQ3-DC0O5-3SLQF-LJ9L3" with ',(0,s.jsx)(n.strong,{children:"limited time validity"}),"\nstarting after first usage (HSM default: 3\xa0days; CloudHSM default:\n1\xa0week; developer account: 1\xa0year)."]}),"\n",(0,s.jsx)(n.p,{children:"This initial partition setup password is used to obtain or update a\npermanent secret stored in a ciphered form in the '.secrets.cfg' file\nusing the 'ppin' command line utility. From then on, the permanent\nsecret is used to establish the secure connection between the PKCS#11\nProvider and the user's HSM partition."}),"\n",(0,s.jsxs)(n.p,{children:["In case of ",(0,s.jsx)(n.strong,{children:"Service Proxy (CloudHSM)"})," the ",(0,s.jsx)(n.a,{href:"/pkcs/Tutorials/CloudHSM/proxy_management",children:"Service Proxy password\nmust be configured"}),", before fetching the HSM\npermanent secret."]}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsx)(n.p,{children:"Ensure that you have read/write access to the '.secrets.cfg' file when\nediting permanent secrets."}),(0,s.jsx)(n.p,{children:"The API login is protected against brute force attacks (setup password\nand permanent secret). After too many wrong trials the API login is\nlocked for some time. Wrong trials are reset after a defined\ntime. Restart of the device resets lockout and attempts."}),(0,s.jsx)(n.p,{children:"The PKCS#11 password is also protected against brute force attacks\nsimilar to above secrets. After too many wrong trials PKCS#11\nprivileged access is locked (API login is still possible). The same\nHSM timer configurations are shared."})]}),"\n",(0,s.jsx)(n.h2,{id:"adding-permanent-secret",children:"Adding Permanent Secret"}),"\n",(0,s.jsx)(n.p,{children:"Assume you have configured a partition for user 'HSM_USERNAME'. To\nfetch and add a permanent secret to your configuration, you execute\nthe following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ppin -a -e HSM_USERNAME\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"********************\nPrimus Permanent PIN\n********************\nProvide setup password for 'HSM_USERNAME': <enter User Setup Password, no echo>\nProvide PKCS11 password for 'HSM_USERNAME': <enter PKCS#11 PIN, no echo>\n********************\nPrimus Permanent PIN\n********************\n[01] slot-id 0: user 'HSM_USERNAME' permanent secret: Configured\n"})}),"\n",(0,s.jsx)(n.h2,{id:"updating-permanent-secret",children:"Updating Permanent Secret"}),"\n",(0,s.jsx)(n.p,{children:"In case the permanent secret was changed, you can update it using a\nnew setup password:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ppin -u -e HSM_USERNAME\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"********************\nPrimus Permanent PIN\n********************\nProvide setup password for 'HSM_USERNAME': <enter User Setup Password, no echo>\nProvide PKCS11 password for 'HSM_USERNAME': <enter PKCS#11 PIN, no echo>\n********************\nPrimus Permanent PIN\n********************\n[01] slot-id 0: user 'HSM_USERNAME' permanent secret: Configured\n"})}),"\n",(0,s.jsxs)(n.p,{children:['Note that update procedure failure removes the current permanent\nsecret entry. That means the next trial has to be done with "add\npermanent secret" (',(0,s.jsx)(n.code,{children:"ppin -a -e HSM_USERNAME"}),")."]}),"\n",(0,s.jsx)(n.h2,{id:"removing-permanent-secret",children:"Removing Permanent Secret"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ppin -r -e HSM_USERNAME\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"********************\nPrimus Permanent PIN\n********************\n[01] slot-id 0: user 'HSM_USERNAME' permanent secret: MISSING\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);