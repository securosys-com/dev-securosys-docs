"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[41882],{21482:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"Tutorials/Download-Pub-key","title":"AWS BYOK - Public Key Download & Import Token","description":"After creating a symmetric encryption AWS KMS key without key material it is necessary to download its public key and import token. Download both items in one step by using the AWS KMS console or the GetParametersForImport AWS API request. The public key that AWS KMS provides is a 2048-bit RSA public key that is unique to your AWS account.","source":"@site/aws-byok/Tutorials/Download-Pub-key.md","sourceDirName":"Tutorials","slug":"/Tutorials/Download-Pub-key","permalink":"/aws-byok/Tutorials/Download-Pub-key","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"AWS BYOK - Public Key Download & Import Token","sidebar_label":"Downloading Public Key & Import Token"},"sidebar":"tutorialSidebar","previous":{"title":"Create Key on HSM","permalink":"/aws-byok/Tutorials/Create-KMS-key"},"next":{"title":"Create Key on HSM","permalink":"/aws-byok/Tutorials/Create-key-HSM"}}');var o=n(74848),i=n(28453),a=n(65537),s=n(79329);const l={sidebar_position:4,title:"AWS BYOK - Public Key Download & Import Token",sidebar_label:"Downloading Public Key & Import Token"},c="Downloading Public Key & Import Token",d={},h=[];function u(e){const t={admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"downloading-public-key--import-token",children:"Downloading Public Key & Import Token"})}),"\n",(0,o.jsx)(t.p,{children:"After creating a symmetric encryption AWS KMS key without key material it is necessary to download its public key and import token. Download both items in one step by using the AWS KMS console or the GetParametersForImport AWS API request. The public key that AWS KMS provides is a 2048-bit RSA public key that is unique to your AWS account."}),"\n",(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsx)(t.p,{children:"The public key and import token are valid for only 24 hours. If you don't use them to import key material within 24 hours of downloading them, you must download new ones."})}),"\n",(0,o.jsxs)(t.p,{children:["To protect the key material during import, it is paramount to encrypt it using the downloaded public key and a supported wrapping algorithm. AWS offers RSA PKCS #1 encryption with one of three padding options, while the Primus Tools only support ",(0,o.jsx)(t.code,{children:"RSAES_OAEP_SHA_256"})," and ",(0,o.jsx)(t.code,{children:"RSAES_OAEP_SHA_1"}),". It is highly recommended to use the ",(0,o.jsx)(t.code,{children:"RSAES_OAEP_SHA_256"})," wrapping algorithm to wrap your key material."]}),"\n",(0,o.jsx)(t.p,{children:"The import token includes metadata that ensures that the key material is imported correctly. When uploading the en-crypted key material to AWS KMS, the same import token that was downloaded in this chapter must be uploaded."}),"\n",(0,o.jsx)(t.p,{children:"It is always possible to download these items again. Usually reimporting the same key material into a KMS key is used to change the expiration time for the key material, or to restore expired or deleted key material."}),"\n",(0,o.jsxs)(a.A,{groupId:"device-setup",children:[(0,o.jsxs)(s.A,{value:"ui",label:"Downloading (via API)",default:!0,children:[(0,o.jsxs)(t.p,{children:["To download the public key and import token, use the ",(0,o.jsx)(t.code,{children:"GetParametersForImport"})," API request. Specify the KMS key that will be associated with the imported key material. This KMS key must have an Origin value of ",(0,o.jsx)(t.code,{children:"EXTERNAL"}),"."]}),(0,o.jsx)(t.p,{children:"Example command using the AWS CLI:"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"$ aws kms get-parameters-for-import \\\n\t--key-id 1234abcd-12ab-34cd-56ef-1234567890ab \\\n\t--wrapping-algorithm RSAES_OAEP_SHA_256 \\\n\t--wrapping-key-spec RSA_2048\n"})}),(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Parameter"}),(0,o.jsx)(t.th,{children:"description"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"--key-id"})}),(0,o.jsxs)(t.td,{children:["Replace ",(0,o.jsx)(t.code,{children:"1234abcd-12ab-34cd-56ef-1234567890ab"})," variable with the key ID of the KMS key for which to download the public key and import token."]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"--wrapping-algorithm"})}),(0,o.jsxs)(t.td,{children:["Specify the used wrapping algorithm as either RSAES_OAEP_SHA_1 with ",(0,o.jsx)(t.code,{children:"RSAES_OAEP_SHA_256"})]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"--wrapping-key-spec"})}),(0,o.jsx)(t.td,{children:"Specify the wrapping (public) key algorithm. Only 2048-bit RSA public keys are supported."})]})]})]}),(0,o.jsx)(t.p,{children:"Example output:"}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:'{\n\t"ParametersValidTo": 1568290320.0,\n\t"PublicKey": "public key (base64 encoded)",\n\t"KeyId": "arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab",\n\t"ImportToken": "import token (base64 encoded)"\n}\n'})})]}),(0,o.jsxs)(s.A,{value:"console",label:"Downloading (via Console)",default:!0,children:[(0,o.jsx)(t.p,{children:"Use the AWS KMS console to download the public key and import token."}),(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["If you just completed the steps to create a KMS key with no key material and you are on the ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Download wrapping key and import token page"})}),", skip to Step 8."]}),"\n",(0,o.jsx)(t.li,{children:"Sign in to the AWS Management Console and open the AWS Key Management Service (AWS KMS) console."}),"\n",(0,o.jsx)(t.li,{children:"To change the AWS Region, use the Region selector in the upper-right corner of the page."}),"\n",(0,o.jsxs)(t.li,{children:["In the navigation pane, choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Customer managed keys"})}),"."]}),"\n",(0,o.jsx)(t.li,{children:"Choose the alias or key ID of the KMS key that is pending import."}),"\n",(0,o.jsxs)(t.li,{children:["Choose the ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Cryptographic configuration"})})," tab and view its values. The tabs are below the ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"General configuration"})})," section."]}),"\n",(0,o.jsxs)(t.li,{children:["Choose the ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Key material"})})," tab and then choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Download wrapping key and import token"})}),"."]}),"\n"]}),(0,o.jsx)(t.admonition,{type:"note",children:(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Key material"})})," tab appears only for symmetric encryption KMS keys that have an Origin value of ",(0,o.jsx)(t.code,{children:"EXTERNAL"}),"."]})}),(0,o.jsxs)(t.ol,{start:"8",children:["\n",(0,o.jsxs)(t.li,{children:["For ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Select wrapping algorithm"})}),", choose the option that you will use to encrypt your key material."]}),"\n",(0,o.jsxs)(t.li,{children:["Choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Download wrapping key and import token"})}),", and then save the file."]}),"\n"]}),(0,o.jsxs)(t.p,{children:["If you have a ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Next"})})," option, to continue the process now, choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Next"})}),". To continue later, choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Cancel"})}),". Otherwise, to close the window, choose ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"Cancel"})})," or click the ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.code,{children:"X"})}),"."]}),(0,o.jsxs)(t.ol,{start:"10",children:["\n",(0,o.jsxs)(t.li,{children:["Unzip the ",(0,o.jsx)(t.code,{children:".zip"})," file that was downloaded in the previous step (",(0,o.jsx)(t.code,{children:"ImportParameters.zip"}),")."]}),"\n"]}),(0,o.jsx)(t.p,{children:"The folder contains the following files:"}),(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"File"}),(0,o.jsx)(t.th,{children:"Description"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsxs)(t.td,{children:[(0,o.jsx)(t.code,{children:"wrappingKey_KMS"})," ",(0,o.jsx)(t.code,{children:"key_key_ID_timestamp"})]}),(0,o.jsx)(t.td,{children:"The 2048-bit RSA public key file."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsxs)(t.td,{children:[(0,o.jsx)(t.code,{children:"importToken_KMS"})," ",(0,o.jsx)(t.code,{children:"key_key_ID_timestamp"})]}),(0,o.jsx)(t.td,{children:"The import token file."})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsxs)(t.td,{children:[(0,o.jsx)(t.code,{children:"README_KMS"})," ",(0,o.jsx)(t.code,{children:"key_key_ID_timestamp.txt"})]}),(0,o.jsx)(t.td,{children:"This file contains information about the public key, the wrapping algorithm to use to encrypt the import key material, and the date and time when the wrapping key (public key) and import token expire."})]})]})]})]})]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var r=n(96540);const o={},i=r.createContext(o);function a(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(i.Provider,{value:t},e.children)}},65537:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(96540),o=n(34164),i=n(65627),a=n(56347),s=n(50372),l=n(30604),c=n(11861),d=n(78749);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:o}}=e;return{value:t,label:n,attributes:r,default:o}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const o=(0,a.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(o.location.search);t.set(i,e),o.replace({...o.location,search:t.toString()})}),[i,o])]}function y(e){const{defaultValue:t,queryString:n=!1,groupId:o}=e,i=u(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[c,h]=m({queryString:n,groupId:o}),[y,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[o,i]=(0,d.Dv)(n);return[o,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:o}),x=(()=>{const e=c??y;return p({value:e,tabValues:i})?e:null})();(0,s.A)((()=>{x&&l(x)}),[x]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),b(e)}),[h,b,i]),tabValues:i}}var b=n(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=n(74848);function g(e){let{className:t,block:n,selectedValue:r,selectValue:a,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),o=s[n].value;o!==r&&(c(t),a(o))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},t),children:s.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...i,className:(0,o.A)("tabs__item",x.tabItem,i?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function k(e){let{lazy:t,children:n,selectedValue:i}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function f(e){const t=y(e);return(0,j.jsxs)("div",{className:(0,o.A)("tabs-container",x.tabList),children:[(0,j.jsx)(g,{...t,...e}),(0,j.jsx)(k,{...t,...e})]})}function w(e){const t=(0,b.A)();return(0,j.jsx)(f,{...e,children:h(e.children)},String(t))}},79329:(e,t,n)=>{n.d(t,{A:()=>a});n(96540);var r=n(34164);const o={tabItem:"tabItem_Ymn6"};var i=n(74848);function a(e){let{children:t,hidden:n,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,a),hidden:n,children:t})}}}]);