"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[42803],{28453:(e,r,o)=>{o.d(r,{R:()=>a,x:()=>s});var n=o(96540);const i={},t=n.createContext(i);function a(e){const r=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(t.Provider,{value:r},e.children)}},57938:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"Tutorials/Standalone-Root-Ca/Install&Configure-ADCS-PS","title":"Configure Microsoft AD CS via PowerShell","description":"Configuring Microsoft Active Directory Certificate Services (AD CS) via PowerShell with Securosys Hardware Security Modules (HSMs)","source":"@site/ms-pki-adcs/Tutorials/Standalone-Root-Ca/Install&Configure-ADCS-PS.md","sourceDirName":"Tutorials/Standalone-Root-Ca","slug":"/Tutorials/Standalone-Root-Ca/Install&Configure-ADCS-PS","permalink":"/ms-pki-adcs/Tutorials/Standalone-Root-Ca/Install&Configure-ADCS-PS","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Configure Microsoft AD CS via PowerShell","sidebar_label":"Setup via PowerShell","description":"Configuring Microsoft Active Directory Certificate Services (AD CS) via PowerShell with Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Configuring AD CS","permalink":"/ms-pki-adcs/Tutorials/Standalone-Root-Ca/GUI-Setup/Configuring-CA-Properties"},"next":{"title":"Enterprise Subordinate CA","permalink":"/ms-pki-adcs/category/enterprise-subordinate-ca"}}');var i=o(74848),t=o(28453);const a={sidebar_position:4,title:"Configure Microsoft AD CS via PowerShell",sidebar_label:"Setup via PowerShell",description:"Configuring Microsoft Active Directory Certificate Services (AD CS) via PowerShell with Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},s="Setup Microsoft AD CS via PowerShell",l={},c=[];function d(e){const r={admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"setup-microsoft-ad-cs-via-powershell",children:"Setup Microsoft AD CS via PowerShell"})}),"\n",(0,i.jsx)(r.p,{children:"The following example shows the standalone root CA procedure done previously via GUI, now via Powershell."}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Run PowerShell as admin user."}),"\n",(0,i.jsx)(r.li,{children:"Install AD CS feature including management tools"}),"\n"]}),"\n",(0,i.jsx)(r.admonition,{type:"note",children:(0,i.jsx)(r.p,{children:"The following command installs only AD CS binaries. Almost everything on Windows Server can be configured via PowerShell, for more information refer to Microsoft documentation."})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:"Install-WindowsFeature AD-Certificate\nAdd-WindowsFeature Adcs-Cert-Authority -IncludeManagementTools\n"})}),"\n",(0,i.jsxs)(r.p,{children:["Configure AD CS with the below command examples. There are three parameter sets for the CA PowerShell deployment cmdlet (refer to Microsoft documentation for further parameters and details): ",(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsx)(r.li,{children:"Using new certificate and private key. Run the following command in PowerShell:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'Install-AdcsCertificationAuthority \u2013caType <CA-Type> -caCommonName "<CA-Name>" \u2013CryptoProviderName "<Key Storage Provider Name>" \u2013KeyLength <2048> \u2013HashAlgorithm <SHA256> [\u2026]\n'})}),"\n",(0,i.jsx)(r.p,{children:"Example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'Install-AdcsCertificationAuthority -CAType "StandaloneRootCa" -CryptoProviderName "RSA# Securosys Primus HSM Key Storage Provider" -KeyLength 4096 -HashAlgorithmName SHA256 -CACommonName myDemoCA -OverwriteExistingKey -Force\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsx)(r.li,{children:"Using existing private key. Run the following command in PowerShell:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'Install-AdcsCertificationAuthority \u2013caType <CA-Type> \u2013CryptoProviderName "<Key Storage Provider Name>" -caCommonName "<CA-Name>" \u2013KeyContainerName <NAME_OF_KEY> \u2013hashAlgorithm SHA256 [\u2026]\n'})}),"\n",(0,i.jsx)(r.p,{children:"Example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'Install-AdcsCertificationAuthority -CAType "StandaloneRootCa" -CryptoProviderName "RSA# Securosys Primus HSM Key Storage Provider" -KeyContainerName myDemoCA -HashAlgorithmName SHA256 -CACommonName myDemoCA\n'})}),"\n",(0,i.jsxs)(r.ol,{start:"3",children:["\n",(0,i.jsx)(r.li,{children:"Using existing certificate and private key. Using a certificate already present on local machine in MY store, run the command:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:"Install-AdcsCertificationAuthority \u2013AllowAdministratorInteraction \u2013caType <CA-Type> \u2013certificateID [cert hash | cert serial number] [\u2026]\n"})}),"\n",(0,i.jsx)(r.p,{children:"Example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sh",children:'Install-AdcsCertificationAuthority -CAType "StandaloneRootCa" -CryptoProviderName "RSA# Securosys Primus HSM Key Storage Provider" -certificateID CertSerial\n'})}),"\n",(0,i.jsx)(r.p,{children:"\u2003"})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);