"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[13502],{5030:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/generated-certs-124a0eee3ebf3d17efb7316c7c409a4c.png"},8449:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/issuance-req-09291193ecdb4b82bee60f46b7d58c10.png"},9505:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/certificate-properties-extensions2-90aad95fb56ff968fe9d3af5f56ce64f.png"},15353:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/cryptography-8e2009f6ce9e211fa698088eec8b98ea.png"},17661:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/extensions-c394f2c1ad86871f1ed6e72e49c13293.png"},18289:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/Certificate-Enrollment-8f0ad97dbf306fe7edc840556ed8922b.png"},28453:(e,i,t)=>{t.d(i,{R:()=>a,x:()=>c});var n=t(96540);const s={},r=n.createContext(s);function a(e){const i=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(r.Provider,{value:i},e.children)}},29536:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/Certificate-Enrollment-details-9818cb6c075a0cf8864c224837b14f6d.png"},30139:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/certificate-properties-extensions-be7815c3edbbd6fa2e6b2eb275539c5f.png"},30757:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/manage-cert-templates-1999b5ccfe6f661a33d000e47138ca93.png"},37274:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/Certificate-properties-353d77393d934b01d8e717ad9940721a.png"},37530:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/enrolement2-2c6df7d86323aa9892994cba9d4904b4.png"},40829:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/certificate-properties-key-options-19dff54dfd1386f79855cd62efc7d8b2.png"},41440:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/enable-cert-temp-a4aa85665a3f2eba08449a2631541e73.png"},41746:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/enrolement-c575118f317f932fbce3aef2c17d2d93.png"},41999:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/subject-name-d143d04be5b4a2e7b009f82ace9eaa02.png"},44361:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/certificate-properties-subject-3b5dbb1a90b5c24138b6f8c7bdc8a47e.png"},45956:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/request-handling-bced14c9c7b6c0051e08f511b559ed95.png"},53608:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/request-handling-encryption-70ddadefcceaa6834be1f2b9d7f5a46c.png"},59302:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/smime-templates-93526678b718e4ff3566dae7519ceaf4.png"},59963:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/cert-issue-f3c4c1f40a786e0fa2f3311085c0ed35.png"},62823:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/template-properties-9037c7de569c8722a29a3931b9bedf9e.png"},65537:(e,i,t)=>{t.d(i,{A:()=>v});var n=t(96540),s=t(34164),r=t(65627),a=t(56347),c=t(50372),l=t(30604),o=t(11861),d=t(78749);function h(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:i}=e;return!!i&&"object"==typeof i&&"value"in i}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:i,children:t}=e;return(0,n.useMemo)((()=>{const e=i??function(e){return h(e).map((e=>{let{props:{value:i,label:t,attributes:n,default:s}}=e;return{value:i,label:t,attributes:n,default:s}}))}(t);return function(e){const i=(0,o.XI)(e,((e,i)=>e.value===i.value));if(i.length>0)throw new Error(`Docusaurus error: Duplicate values "${i.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[i,t])}function g(e){let{value:i,tabValues:t}=e;return t.some((e=>e.value===i))}function p(e){let{queryString:i=!1,groupId:t}=e;const s=(0,a.W6)(),r=function(e){let{queryString:i=!1,groupId:t}=e;if("string"==typeof i)return i;if(!1===i)return null;if(!0===i&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:i,groupId:t});return[(0,l.aZ)(r),(0,n.useCallback)((e=>{if(!r)return;const i=new URLSearchParams(s.location.search);i.set(r,e),s.replace({...s.location,search:i.toString()})}),[r,s])]}function f(e){const{defaultValue:i,queryString:t=!1,groupId:s}=e,r=u(e),[a,l]=(0,n.useState)((()=>function(e){let{defaultValue:i,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(i){if(!g({value:i,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${i}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return i}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:i,tabValues:r}))),[o,h]=p({queryString:t,groupId:s}),[f,m]=function(e){let{groupId:i}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(i),[s,r]=(0,d.Dv)(t);return[s,(0,n.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:s}),x=(()=>{const e=o??f;return g({value:e,tabValues:r})?e:null})();(0,c.A)((()=>{x&&l(x)}),[x]);return{selectedValue:a,selectValue:(0,n.useCallback)((e=>{if(!g({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),m(e)}),[h,m,r]),tabValues:r}}var m=t(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(74848);function b(e){let{className:i,block:t,selectedValue:n,selectValue:a,tabValues:c}=e;const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,r.a_)(),d=e=>{const i=e.currentTarget,t=l.indexOf(i),s=c[t].value;s!==n&&(o(i),a(s))},h=e=>{let i=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;i=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;i=l[t]??l[l.length-1];break}}i?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},i),children:c.map((e=>{let{value:i,label:t,attributes:r}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:n===i?0:-1,"aria-selected":n===i,ref:e=>{l.push(e)},onKeyDown:h,onClick:d,...r,className:(0,s.A)("tabs__item",x.tabItem,r?.className,{"tabs__item--active":n===i}),children:t??i},i)}))})}function y(e){let{lazy:i,children:t,selectedValue:r}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(i){const e=a.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:a.map(((e,i)=>(0,n.cloneElement)(e,{key:i,hidden:e.props.value!==r})))})}function A(e){const i=f(e);return(0,j.jsxs)("div",{className:(0,s.A)("tabs-container",x.tabList),children:[(0,j.jsx)(b,{...i,...e}),(0,j.jsx)(y,{...i,...e})]})}function v(e){const i=(0,m.A)();return(0,j.jsx)(A,{...e,children:h(e.children)},String(i))}},69059:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/reqest-new-cert-298377bcea49aae25fe1a95ebb78d9a8.png"},78849:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/Security-4a788c2f3b96ca7fc8956a3ce0ac75e5.png"},79329:(e,i,t)=>{t.d(i,{A:()=>a});t(96540);var n=t(34164);const s={tabItem:"tabItem_Ymn6"};var r=t(74848);function a(e){let{children:i,hidden:t,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,n.A)(s.tabItem,a),hidden:t,children:i})}},83307:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/template-settings-3b21fe79afef42c790261ee01f194cb3.png"},84177:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>d,contentTitle:()=>o,default:()=>g,frontMatter:()=>l,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"Installation/digital-certificate","title":"Configuring a Certificate for Microsoft S/MIME","description":"Learn how to obtain and enroll digital certificates for Microsoft S/MIME with Primus HSM integration. This guide covers MS PKI (ADCS) and Public CA enrollment, creating certificate templates, publishing certificates, and configuring Outlook for secure email signing and encryption.","source":"@site/ms-smime/Installation/digital-certificate.md","sourceDirName":"Installation","slug":"/Installation/digital-certificate","permalink":"/ms-smime/Installation/digital-certificate","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Configuring a Certificate for Microsoft S/MIME","sidebar_label":"3. Digital Certificate","description":"Learn how to obtain and enroll digital certificates for Microsoft S/MIME with Primus HSM integration. This guide covers MS PKI (ADCS) and Public CA enrollment, creating certificate templates, publishing certificates, and configuring Outlook for secure email signing and encryption.","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"2. Install API provider","permalink":"/ms-smime/Installation/Provider"},"next":{"title":"4. Configure MS Outlook","permalink":"/ms-smime/Installation/using-certificates"}}');var s=t(74848),r=t(28453),a=t(65537),c=t(79329);const l={sidebar_position:2,title:"Configuring a Certificate for Microsoft S/MIME",sidebar_label:"3. Digital Certificate",description:"Learn how to obtain and enroll digital certificates for Microsoft S/MIME with Primus HSM integration. This guide covers MS PKI (ADCS) and Public CA enrollment, creating certificate templates, publishing certificates, and configuring Outlook for secure email signing and encryption.",keywords:["hsm","cloud hsm"]},o="Get your Digital Certificate",d={},h=[{value:"HSM Integration Guide",id:"hsm-integration-guide",level:3},{value:"Prepare the ADCS Templates",id:"prepare-the-adcs-templates",level:2},{value:"Signing Template",id:"signing-template",level:3},{value:"Encryption Template",id:"encryption-template",level:3},{value:"Publish Added Templates",id:"publish-added-templates",level:3},{value:"Request the Certificates",id:"request-the-certificates",level:2},{value:"Get your Digital Certificates from a Public CA",id:"get-your-digital-certificates-from-a-public-ca",level:2},{value:"Import PKCS#12 Certificate from CA (containing private key)",id:"import-pkcs12-certificate-from-ca-containing-private-key",level:2},{value:"Generate Key Pair Locally and Import Signed Public Certificate from CA",id:"generate-key-pair-locally-and-import-signed-public-certificate-from-ca",level:2},{value:"Install the Certificate",id:"install-the-certificate",level:2}];function u(e){const i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"get-your-digital-certificate",children:"Get your Digital Certificate"})}),"\n",(0,s.jsx)(i.h3,{id:"hsm-integration-guide",children:"HSM Integration Guide"}),"\n",(0,s.jsxs)(i.p,{children:["Before configuring Microsoft S/MIME to work with Primus HSMs, it is required to obtain ",(0,s.jsx)(i.strong,{children:"digital certificates"})," containing the encryption and signing keys."]}),"\n",(0,s.jsx)(i.p,{children:"There are two ways to achieve that, either via:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"MS PKI"})," (ADCS certificate enrollment)"]}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.strong,{children:"Public CA"})}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"In most cases, the MS PKI cannot issue public valid certificates (except if the MS CA is cross-signed), therefore such generated certificates are only valid within the company's internal domain."}),"\n",(0,s.jsx)(i.p,{children:"Additional MS PKI extensions (e.g. true-Xtender, Essendi XC) allow to sign and auto-enroll certificates via a public CA (e.g. SwissSign)."}),"\n",(0,s.jsxs)(a.A,{groupId:"Certificate-creation",children:[(0,s.jsxs)(c.A,{value:"Certificate 1",label:"Via MS PKI",default:!0,children:[(0,s.jsx)(i.h2,{id:"prepare-the-adcs-templates",children:"Prepare the ADCS Templates"}),(0,s.jsxs)(i.p,{children:["The procedures described below, assumes that the MS PKI environment is already setup and operational. For more information and an example setup of an MS AD CS see ",(0,s.jsx)(i.a,{href:"/ms-pki-adcs/overview",children:"Microsoft Active Directory Certificate Services (AD CS)"}),"."]}),(0,s.jsx)(i.p,{children:"To enroll certificates via MS AD CS, we have to generate and distribute the necessary certificate templates. We generate two new templates based on \u201cExchange Signature Only\u201d for authentication and \u201cExchange User\u201d for encryption (the \u201cUser\u201d template is made for further things). For archive retrieval purposes we just need to archive the encryption certificates."}),(0,s.jsx)(i.h3,{id:"signing-template",children:"Signing Template"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"On the subordinate CA server, open the CA console (certsrv), right-click Certificate Templates and select Manage."}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(30757).A+"",width:"251",height:"181"})}),(0,s.jsxs)(i.p,{children:["To generate the new ",(0,s.jsx)(i.strong,{children:"authentication template"}),", select the ",(0,s.jsx)(i.strong,{children:"Exchange Signature Only"})," template, right-click and select ",(0,s.jsx)(i.strong,{children:"Duplicate Template"}),"."]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Define the ",(0,s.jsx)(i.strong,{children:"Compatibility settings"})," and ",(0,s.jsx)(i.strong,{children:"General parameters"}),":","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Compatibility settings"}),": CNG requires compatibility settings for at least Windows Server 2008R2 or higher"]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(83307).A+"",width:"272",height:"323"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Name the template, define validity period and publish certificate in AD"}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(62823).A+"",width:"272",height:"324"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Define the ",(0,s.jsx)(i.strong,{children:"Request Handling"})," and ",(0,s.jsx)(i.strong,{children:"Cryptography parameters"}),", defining that only the Primus KSP is used:"]}),"\n"]}),(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{src:t(45956).A+"",width:"272",height:"335"}),"\n",(0,s.jsx)(i.img,{src:t(15353).A+"",width:"272",height:"335"})]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Define how the ",(0,s.jsx)(i.strong,{children:"Subject Name"})," is derived and the Permissions:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Build certificate from ",(0,s.jsx)(i.em,{children:"Active Directory information"})," (E-mail should be defined in AD)"]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(41999).A+"",width:"272",height:"335"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Add the following permissions (and user groups):","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Authenticated Users"}),":  Read, Enroll, Autoenroll"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Domain Users"}),":  Read, Enroll, Autoenroll"]}),"\n",(0,s.jsxs)(i.li,{children:["If there are any users in the domain you do not want to have autoenrolled, you can create a group in AD, add the user(s) to it, then add that group in the ",(0,s.jsx)(i.strong,{children:"Security"})," tab above, checking the ",(0,s.jsx)(i.strong,{children:"Deny"})," box for ",(0,s.jsx)(i.strong,{children:"Autoenroll"})," for that group."]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(78849).A+"",width:"272",height:"339"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Define the ",(0,s.jsx)(i.strong,{children:"Issuance Requirements"}),", e.g. if the CA certificate manager should approve:"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(8449).A+"",width:"272",height:"334"})}),(0,s.jsx)(i.h3,{id:"encryption-template",children:"Encryption Template"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"On the subordinate CA server, open the CA console (certsrv), right-click Certificate Templates and select Manage."}),"\n"]}),(0,s.jsxs)(i.p,{children:["For the new encryption template, select the ",(0,s.jsx)(i.strong,{children:"Exchange User"})," template, right-click and select\n",(0,s.jsx)(i.strong,{children:"Duplicate Template"}),"."]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Add all the settings as shown for the ",(0,s.jsx)(i.a,{href:"#signing-template",children:"Signing Template"}),", and amend the following differences:","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Purpose"}),": Encryption, Include Symmetric Algorithms allowed by the subject"]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(53608).A+"",width:"272",height:"338"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Key Usage"}),": Allow key exchange only with key encryption (key encipherment), allow encryption of user data"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(17661).A+"",width:"283",height:"275"})}),(0,s.jsx)(i.h3,{id:"publish-added-templates",children:"Publish Added Templates"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Publish the added templates for issuing certificates. This is done from ",(0,s.jsx)(i.strong,{children:"Certificate Templates"})," folder of CA console.\nRight-click ",(0,s.jsx)(i.strong,{children:"Certificate Templates"}),", click ",(0,s.jsx)(i.strong,{children:"Certificate Template to Issue"})," and select the templates to publish, then click ",(0,s.jsx)(i.strong,{children:"OK"}),". The steps are depicted below:"]}),"\n"]}),(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{src:t(59963).A+"",width:"283",height:"164"}),"\n",(0,s.jsx)(i.img,{src:t(41440).A+"",width:"283",height:"181"}),"\n\u2003"]}),(0,s.jsx)(i.h2,{id:"request-the-certificates",children:"Request the Certificates"}),(0,s.jsx)(i.p,{children:"If auto-enrollment is not configured by AD Group Policy, the user can request a new certificate based on the defined templates, using the certificate manager."}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Start the certificate manager, running ",(0,s.jsx)(i.code,{children:"certmgr.msc"})]}),"\n",(0,s.jsxs)(i.li,{children:["Select ",(0,s.jsx)(i.strong,{children:"Personal"}),",",(0,s.jsx)(i.strong,{children:"All Tasks"})," and ",(0,s.jsx)(i.strong,{children:"Request New Certificate"})," to start the enrollment process:"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(69059).A+"",width:"423",height:"176"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["To use the ",(0,s.jsx)(i.strong,{children:"Active Directory pre-defined templates"}),", select ",(0,s.jsx)(i.strong,{children:"Active Directory Enrollment Policy"})," and click ",(0,s.jsx)(i.strong,{children:"Next"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(37530).A+"",width:"427",height:"174"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Select the two defined ",(0,s.jsx)(i.strong,{children:"SMIME templates"})," and click ",(0,s.jsx)(i.strong,{children:"Enroll"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(59302).A+"",width:"427",height:"313"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Wait for successful enrollment, then click ",(0,s.jsx)(i.strong,{children:"Finish"})]}),"\n",(0,s.jsxs)(i.li,{children:["The two generated certificates should now be visible within the certificate manager and can be used by the Outlook e-mail application, see ",(0,s.jsx)(i.a,{href:"/ms-smime/Installation/using-certificates",children:"Configure the Outlook Client"})," for a walkthrough."]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(5030).A+"",width:"567",height:"116"})})]}),(0,s.jsxs)(c.A,{value:"cli",label:"Via Public CA",default:!0,children:[(0,s.jsx)(i.h2,{id:"get-your-digital-certificates-from-a-public-ca",children:"Get your Digital Certificates from a Public CA"}),(0,s.jsx)(i.p,{children:"To have public valid certificates they are usually signed by a public Certification Authority. There are two ways to apply for such a certificate:"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Generate a Certificate Request at the CAs Registration Authority (RA), receive and import an encrypted PKCS#12 container comprising the private key, public certificate and certificate chain."}),"\n",(0,s.jsxs)(i.li,{children:["Generate a private/public key pair, send the Certificate Signing Request (CSR) to the Registration Authority (RA), receive and import the signed public certificate.\nIn both cases the private key should be stored on the ",(0,s.jsx)(i.strong,{children:"Hardware Security Module"})," and not within the MS Software KSP. The import functions of the certificate manager (",(0,s.jsx)(i.code,{children:"certmgr.msc"}),") and Outlook do not support specifying the KSP during PKCS#12 import. But the import can be performed properly on the command-line using ",(0,s.jsx)(i.code,{children:"certutil.exe"}),"."]}),"\n"]}),(0,s.jsx)(i.h2,{id:"import-pkcs12-certificate-from-ca-containing-private-key",children:"Import PKCS#12 Certificate from CA (containing private key)"}),(0,s.jsxs)(i.p,{children:["Having a PKCS#12 container (p12/pfx) containing the private key should be imported on the command-line using ",(0,s.jsx)(i.code,{children:"certutil.exe"})," (as certificate manager import does not yet support KSP selection):"]}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'certutil -f -user -p <password> -csp "Securosys Primus HSM Key Storage Provider" -importPFX <certFileToImport.p12>\n'})}),(0,s.jsxs)(i.p,{children:["After successful import, the certificate is visible within the certificate manager and can be configured for use by Microsoft Outlook. For more information see ",(0,s.jsx)(i.a,{href:"/ms-smime/Installation/using-certificates",children:"Configure the Outlook Client"}),"."]}),(0,s.jsx)(i.h2,{id:"generate-key-pair-locally-and-import-signed-public-certificate-from-ca",children:"Generate Key Pair Locally and Import Signed Public Certificate from CA"}),(0,s.jsx)(i.p,{children:"The CSR can be generated in two ways:"}),(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["With the command-line tool ",(0,s.jsx)(i.code,{children:"certreq.exe"})," using an input text file, see our ",(0,s.jsx)(i.a,{href:"/ms-iis/Installation/Installation-Overview",children:"IIS Generating and Installing Certificate"})," for more information."]}),"\n",(0,s.jsxs)(i.li,{children:["Using the Certificate Manager (",(0,s.jsx)(i.code,{children:"certmgr.msc"}),"), setting the right attributes, e.g. as shown below for the SMIME signing certificate:"]}),"\n"]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Start the certificate manager by running ",(0,s.jsx)(i.code,{children:"certmgr.msc"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Select ",(0,s.jsx)(i.strong,{children:"Personal"}),", ",(0,s.jsx)(i.strong,{children:"All Tasks"}),", ",(0,s.jsx)(i.strong,{children:"Advanced Operations"})," and ",(0,s.jsx)(i.strong,{children:"Create Custom Request\u2026"})," to create a private/public key pair on the HSM and generate the CSR to be signed by the CA."]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(97511).A+"",width:"465",height:"190"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Select ",(0,s.jsx)(i.strong,{children:"Proceed without enrollment policy"})," and click ",(0,s.jsx)(i.strong,{children:"Next"}),"."]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(41746).A+"",width:"427",height:"206"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Click ",(0,s.jsx)(i.strong,{children:"Next"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(18289).A+"",width:"377",height:"189"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Click on Customer Request ",(0,s.jsx)(i.strong,{children:"Details"}),", and then click on ",(0,s.jsx)(i.strong,{children:"Properties"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(29536).A+"",width:"377",height:"181"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["On the ",(0,s.jsx)(i.strong,{children:"General"})," tab define the certificates ",(0,s.jsx)(i.strong,{children:"Friendly name"})," and add a ",(0,s.jsx)(i.strong,{children:"Description"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(37274).A+"",width:"327",height:"126"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["On tab ",(0,s.jsx)(i.strong,{children:"Subject"})," define the necessary parameters:"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Subject"}),", containing values Common name, Email, Organization, Location, Country"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Alternative name"}),", containing the value Email"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(44361).A+"",width:"327",height:"270"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["On the tab ",(0,s.jsx)(i.strong,{children:"Extensions"})," define the required key extensions, e.g. for email signing"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Key usage"}),", Digital signature, critical"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Extended Key Usage"}),", Secure Email, critical"]}),"\n"]}),(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.img,{src:t(30139).A+"",width:"341",height:"254"}),"\n",(0,s.jsx)(i.img,{src:t(9505).A+"",width:"342",height:"201"})]}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["On the tab ",(0,s.jsx)(i.strong,{children:"Private"})," Key define its properties"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Cryptographic Service Provider (CSP)"}),", choose one of the Securosys Primus HSM KSPs"]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(94347).A+"",width:"283",height:"190"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.strong,{children:"Key Options (key size)"})}),"\n",(0,s.jsxs)(i.li,{children:["Select ",(0,s.jsx)(i.strong,{children:"Hash Algorithm"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(40829).A+"",width:"283",height:"147"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Click ",(0,s.jsx)(i.strong,{children:"OK"})," and ",(0,s.jsx)(i.strong,{children:"Next"})]}),"\n",(0,s.jsxs)(i.li,{children:["Define where to store the Certificate Signing Request (CSR) and click ",(0,s.jsx)(i.strong,{children:"Finish"})]}),"\n"]}),(0,s.jsx)(i.p,{children:(0,s.jsx)(i.img,{src:t(90247).A+"",width:"427",height:"313"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Let the request file (CSR) validate and sign by your public CA (e.g. SwissSign)."}),"\n"]}),(0,s.jsx)(i.h2,{id:"install-the-certificate",children:"Install the Certificate"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Install the signed certificate, received from your public CA, via Windows Explorer (Install Certificate) or via command-line:"}),"\n"]}),(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"certreq.exe \u2013accept -machine <certificateFilename.cer>\n"})}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["After successful install, the certificate is visible within certificate manager and can be used within Microsoft Outlook. For more information see ",(0,s.jsx)(i.a,{href:"/ms-smime/Installation/using-certificates",children:"Configure the Outlook Client"}),"."]}),"\n"]})]})]}),"\n",(0,s.jsxs)(i.admonition,{title:"need help ?",type:"tip",children:[(0,s.jsx)(i.p,{children:"Contact our support team for further assistance:"}),(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://support.securosys.com",children:"Create a ticket (login required)"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"mailto:support@securosys.com",children:"Send an email"})}),"\n"]})]})]})}function g(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},90247:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/save-csr-48cbe4607fe9df7c56141c00a5faf99c.png"},94347:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/certificate-properties-KSP-509d62c1df9b9c10e795c9183520add0.png"},97511:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/CSR-b56dfff867b718c4b0d543e1cec16a47.png"}}]);