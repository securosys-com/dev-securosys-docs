"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[90452],{28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var t=n(96540);const a={},s=t.createContext(a);function i(e){const r=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:r},e.children)}},65537:(e,r,n)=>{n.d(r,{A:()=>j});var t=n(96540),a=n(34164),s=n(65627),i=n(56347),l=n(50372),c=n(30604),o=n(11861),u=n(78749);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:r,children:n}=e;return(0,t.useMemo)((()=>{const e=r??function(e){return d(e).map((e=>{let{props:{value:r,label:n,attributes:t,default:a}}=e;return{value:r,label:n,attributes:t,default:a}}))}(n);return function(e){const r=(0,o.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,n])}function h(e){let{value:r,tabValues:n}=e;return n.some((e=>e.value===r))}function y(e){let{queryString:r=!1,groupId:n}=e;const a=(0,i.W6)(),s=function(e){let{queryString:r=!1,groupId:n}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:r,groupId:n});return[(0,c.aZ)(s),(0,t.useCallback)((e=>{if(!s)return;const r=new URLSearchParams(a.location.search);r.set(s,e),a.replace({...a.location,search:r.toString()})}),[s,a])]}function m(e){const{defaultValue:r,queryString:n=!1,groupId:a}=e,s=p(e),[i,c]=(0,t.useState)((()=>function(e){let{defaultValue:r,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!h({value:r,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:r,tabValues:s}))),[o,d]=y({queryString:n,groupId:a}),[m,f]=function(e){let{groupId:r}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(r),[a,s]=(0,u.Dv)(n);return[a,(0,t.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:a}),g=(()=>{const e=o??m;return h({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{g&&c(g)}),[g]);return{selectedValue:i,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);c(e),d(e),f(e)}),[d,f,s]),tabValues:s}}var f=n(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(74848);function v(e){let{className:r,block:n,selectedValue:t,selectValue:i,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:o}=(0,s.a_)(),u=e=>{const r=e.currentTarget,n=c.indexOf(r),a=l[n].value;a!==t&&(o(r),i(a))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;r=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;r=c[n]??c[c.length-1];break}}r?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},r),children:l.map((e=>{let{value:r,label:n,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:t===r?0:-1,"aria-selected":t===r,ref:e=>{c.push(e)},onKeyDown:d,onClick:u,...s,className:(0,a.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":t===r}),children:n??r},r)}))})}function x(e){let{lazy:r,children:n,selectedValue:s}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(r){const e=i.find((e=>e.props.value===s));return e?(0,t.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,r)=>(0,t.cloneElement)(e,{key:r,hidden:e.props.value!==s})))})}function E(e){const r=m(e);return(0,b.jsxs)("div",{className:(0,a.A)("tabs-container",g.tabList),children:[(0,b.jsx)(v,{...r,...e}),(0,b.jsx)(x,{...r,...e})]})}function j(e){const r=(0,f.A)();return(0,b.jsx)(E,{...e,children:d(e.children)},String(r))}},77516:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>u,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Tutorials/Encryption/FileEncryption","title":"File Encryption Using ECIES and Cloud HSM","description":"Learn how to encrypt and decrypt files using ECIES with Cloud Hardware Security Modules (HSM).","source":"@site/tsb/Tutorials/Encryption/FileEncryption.md","sourceDirName":"Tutorials/Encryption","slug":"/Tutorials/Encryption/FileEncryption","permalink":"/tsb/Tutorials/Encryption/FileEncryption","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"File Encryption Using ECIES and Cloud HSM","sidebar_label":"File Encryption (ECIES)","description":"Learn how to encrypt and decrypt files using ECIES with Cloud Hardware Security Modules (HSM).","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","ECIES","file encryption","file decryption","elliptic curve cryptography","ECC encryption","symmetric encryption","HSM encryption","HSM decryption","HSM integration"]},"sidebar":"tutorialSidebar","previous":{"title":"Encryption & Decryption","permalink":"/tsb/Tutorials/Encryption/EncryptDecrypt"},"next":{"title":"Import from Bip32 Seed","permalink":"/tsb/Tutorials/Import/seeding"}}');var a=n(74848),s=n(28453),i=n(65537),l=n(79329);const c={sidebar_position:1,title:"File Encryption Using ECIES and Cloud HSM",sidebar_label:"File Encryption (ECIES)",description:"Learn how to encrypt and decrypt files using ECIES with Cloud Hardware Security Modules (HSM).",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","ECIES","file encryption","file decryption","elliptic curve cryptography","ECC encryption","symmetric encryption","HSM encryption","HSM decryption","HSM integration"]},o="File Encryption (ECIES)",u={},d=[{value:"Create EC Key",id:"create-ec-key",level:2},{value:"Encrypt a file",id:"encrypt-a-file",level:2},{value:"Decrypt a file",id:"decrypt-a-file",level:2}];function p(e){const r={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"file-encryption-ecies",children:"File Encryption (ECIES)"})}),"\n",(0,a.jsx)(r.p,{children:"ECIES is a hybrid encryption scheme which allows to encrypt data to an ECC public key but using symmetric cryptography for encryption and authentication. The symmetric keys are derived from the receiver's public key and an ephemeral private key of the sender with an ECDH agreement. The ephemeral key pair is used only for a single message: its private key will be deleted after encryption and the ephemeral public key is part of the cryptogram such that the receiver can perform the same ECDH agreement and get the same shared symmetric keys."}),"\n",(0,a.jsxs)(r.p,{children:["The ",(0,a.jsx)(r.code,{children:"REST_API"})," license is required to use ECIES."]}),"\n",(0,a.jsx)(r.h2,{id:"create-ec-key",children:"Create EC Key"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST"}),": ",(0,a.jsx)(r.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),"\n",(0,a.jsx)(r.p,{children:"Description: Create a Ec Key request"}),"\n",(0,a.jsxs)(r.p,{children:["Replace ",(0,a.jsx)(r.code,{children:"<keyname>"}),"."]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "label": "<keyname>",  \n  "algorithm": "EC",\n  "curveOid": "1.3.132.0.34",\n  "attributes": {\n    "decrypt": true,\n    "verify": false,\n    "sign": false,\n    "wrap": false,\n    "unwrap": false,\n    "derive": true,\n    "bip32": false,\n    "extractable": false,\n    "modifiable": true,\n    "destroyable": true,\n    "sensitive": true\n  },\n  "policy": null\n}\n'})}),"\n",(0,a.jsx)(r.h2,{id:"encrypt-a-file",children:"Encrypt a file"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST:"})," ",(0,a.jsx)(r.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/fileEncryption",children:"/v1/fileEncrypt"})]}),"\n",(0,a.jsxs)(i.A,{groupId:"device-setup",children:[(0,a.jsxs)(l.A,{value:"swagger",label:"Swagger",default:!0,children:[(0,a.jsxs)(r.p,{children:["Replace ",(0,a.jsx)(r.code,{children:"<keyname>"})]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "fileEncryptRequest": {\n    "encryptKeyName": "<keyName>"\n  }\n}\n'})})]}),(0,a.jsxs)(l.A,{value:"curl",label:"CURL",children:[(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"If you want to use the HSM inside your CI-CD pipeline for encrypting sensitive content you can do with CURL"})}),(0,a.jsxs)(r.p,{children:["Replace ",(0,a.jsx)(r.code,{children:"<bearer_token>"}),", ",(0,a.jsx)(r.code,{children:"<keyname>"})," and ",(0,a.jsx)(r.code,{children:"<filename.txt>"})," for the file to be encrypted."]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",metastring:"{2,4,8,11}",children:'curl --request POST \\\n    --url "https://primusdev.cloudshsm.com/v1/fileEncrypt" \\\n    --header \'accept: application/octet-stream\' \\\n    --header "Authorization: Bearer <bearer_token>" \\\n    --header \'Content-Type: multipart/form-data\' \\\n    --form \'SignedFileEncryptRequestDto={\n            "fileEncryptRequest": {\n                "encryptKeyName": "<keyname>"\n            }\n        }\' \\\n    --form \'file=@<filename.txt>\' --output test-2022-09-08_17-59-14.primus.encrypted\n'})})]})]}),"\n",(0,a.jsx)(r.h2,{id:"decrypt-a-file",children:"Decrypt a file"}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST:"})," ",(0,a.jsx)(r.a,{href:"https://tsb-demo.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/fileDecryption",children:"/v1/synchronousFileDecrypt"})]}),"\n",(0,a.jsxs)(i.A,{groupId:"device-setup",children:[(0,a.jsxs)(l.A,{value:"swagger",label:"Swagger",default:!0,children:[(0,a.jsxs)(r.p,{children:["Replace ",(0,a.jsx)(r.code,{children:"<keyname>"})]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "fileDecryptRequest": {\n    "decryptKeyName": "<keyname>"\n  }\n}\n'})})]}),(0,a.jsxs)(l.A,{value:"curl",label:"CURL",children:[(0,a.jsx)(r.p,{children:(0,a.jsx)(r.em,{children:"If you want to use the HSM inside your CI-CD pipeline for encrypting sensitive content you can do with CURL"})}),(0,a.jsxs)(r.p,{children:["Replace ",(0,a.jsx)(r.code,{children:"<bearer_token>"}),", ",(0,a.jsx)(r.code,{children:"<keyname>"})," and ",(0,a.jsx)(r.code,{children:"<encrypted_filename.txt>"})," for the file to be encrypted."]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",metastring:"{2,4,8,11}",children:'curl --request POST \\\n    --url "https://primusdev.cloudshsm.com/v1/synchronousFileDecrypt" \\\n    --header \'accept: application/octet-stream\' \\\n    --header "Authorization: Bearer <bearer_token>" \\\n    --header \'Content-Type: multipart/form-data\' \\\n    --form \'SignedFileDecryptRequestDto={ \n            "fileDecryptRequest": { \n                "decryptKeyName": "<keyname>" \n            } \n        }\' \\\n    --form \'file=@<encrypted_filename.txt>;type=text/json\' --output test.txt\n'})})]})]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},79329:(e,r,n)=>{n.d(r,{A:()=>i});n(96540);var t=n(34164);const a={tabItem:"tabItem_Ymn6"};var s=n(74848);function i(e){let{children:r,hidden:n,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,t.A)(a.tabItem,i),hidden:n,children:r})}}}]);