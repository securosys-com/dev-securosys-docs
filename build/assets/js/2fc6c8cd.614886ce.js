"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[53180],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(96540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}},75346:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>g,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Tutorials/Certificate/with-ska/CertificateSigningRequest","title":"Certificate Signing Requests with SKA-key","description":"Tutorial on creating a Certificate Signing Request (CSR) using Cloud HSM.","source":"@site/tsb/Tutorials/Certificate/with-ska/CertificateSigningRequest.md","sourceDirName":"Tutorials/Certificate/with-ska","slug":"/Tutorials/Certificate/with-ska/CertificateSigningRequest","permalink":"/tsb/Tutorials/Certificate/with-ska/CertificateSigningRequest","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Certificate Signing Requests with SKA-key","sidebar_label":"2. CSR Creation","description":"Tutorial on creating a Certificate Signing Request (CSR) using Cloud HSM.","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","certificate signing request","create key request","securosys","rsa algorithm","digital signature","code signing","csr sign request","security token","public key approval"]},"sidebar":"tutorialSidebar","previous":{"title":"1. Self-Signed Certificate SKA-Key","permalink":"/tsb/Tutorials/Certificate/with-ska/SelfSignedCertificate"},"next":{"title":"3. Issue Certificate","permalink":"/tsb/Tutorials/Certificate/with-ska/IssueCertificate"}}');var r=t(74848),i=t(28453);const a={sidebar_position:1,title:"Certificate Signing Requests with SKA-key",sidebar_label:"2. CSR Creation",description:"Tutorial on creating a Certificate Signing Request (CSR) using Cloud HSM.",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","certificate signing request","create key request","securosys","rsa algorithm","digital signature","code signing","csr sign request","security token","public key approval"]},o="2. Certificate Signing Request",c={},d=[{value:"Create key",id:"create-key",level:2},{value:"Create a CSR",id:"create-a-csr",level:2},{value:"Approve the CSR Request",id:"approve-the-csr-request",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"2-certificate-signing-request",children:"2. Certificate Signing Request"})}),"\n",(0,r.jsx)(n.h2,{id:"create-key",children:"Create key"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"POST"}),": ",(0,r.jsx)(n.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Create sub-key request."]}),"\n",(0,r.jsx)(n.admonition,{title:"Approver",type:"tip",children:(0,r.jsxs)(n.p,{children:["We are adding the same approver on the ",(0,r.jsx)(n.code,{children:"SUB.approver.securosys.com"}),". In production the approver on the SUB-Key must be different from the ",(0,r.jsx)(n.code,{children:"CA.approver.securosys.com"}),"!"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:"{2,30,52,74,96}",children:'{\n    "label": "SUB.approver.securosys.com",\n    "algorithm": "RSA",\n    "keySize": 2048,\n    "attributes": {\n        "decrypt": false,\n        "sign": true,\n        "unwrap": false,\n        "derive": false,\n        "bip32": false,\n        "extractable": false,\n        "modifiable": true,\n        "destroyable": true\n    },\n    "policy": {\n        "ruleUse": {\n            "tokens": [\n                {\n                    "name": "Token1",\n                    "timelock": 0,\n                    "timeout": 600,\n                    "groups": [\n                        {\n                            "name": "Group1",\n                            "quorum": 1,\n                            "approvals": [\n                                {\n                                    "type": "public_key",\n                                    "name": "ApproverKey1",\n                                    "value": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApLwHSQM4sd93UtEJ+t6G22sopYmL6roZxQGL0GWn7WAaiogfQ5EOM+sYQyeJgtuLQkdfwDBnScJx7IgBiOKFpXdaM9i08hSljFlbTT7zP0XjojtGD4U27nLuLqGUhmloLtc+6yBK2FL/7QWB2c9tyCgHiIhmXZesBhZRRFdrpwP66XoGIsgxt1AxFjV1z5MG0g7DULfUSqWG7gGOxvwITFwmqDwuA6rh952X5iJ7zopSSmGhrTeFrV/1Io0E8SsJhRM9m7BOdcg/X6X+5iqK5Obp6Js18Y7eddf/Q5amQSzwlXx6mJAyj2//1DnGz0UbacKStqgZZiC0xAhLEwo7XQIDAQAB"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        },\n        "ruleBlock": {\n            "tokens": [\n                {\n                    "name": "Token1",\n                    "timelock": 0,\n                    "timeout": 600,\n                    "groups": [\n                        {\n                            "name": "Group1",\n                            "quorum": 1,\n                            "approvals": [\n                                {\n                                    "type": "public_key",\n                                    "name": "ApproverKey1",\n                                    "value": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApLwHSQM4sd93UtEJ+t6G22sopYmL6roZxQGL0GWn7WAaiogfQ5EOM+sYQyeJgtuLQkdfwDBnScJx7IgBiOKFpXdaM9i08hSljFlbTT7zP0XjojtGD4U27nLuLqGUhmloLtc+6yBK2FL/7QWB2c9tyCgHiIhmXZesBhZRRFdrpwP66XoGIsgxt1AxFjV1z5MG0g7DULfUSqWG7gGOxvwITFwmqDwuA6rh952X5iJ7zopSSmGhrTeFrV/1Io0E8SsJhRM9m7BOdcg/X6X+5iqK5Obp6Js18Y7eddf/Q5amQSzwlXx6mJAyj2//1DnGz0UbacKStqgZZiC0xAhLEwo7XQIDAQAB"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        },\n        "ruleUnblock": {\n            "tokens": [\n                {\n                    "name": "Token1",\n                    "timelock": 0,\n                    "timeout": 600,\n                    "groups": [\n                        {\n                            "name": "Group1",\n                            "quorum": 1,\n                            "approvals": [\n                                {\n                                    "type": "public_key",\n                                    "name": "ApproverKey1",\n                                    "value": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApLwHSQM4sd93UtEJ+t6G22sopYmL6roZxQGL0GWn7WAaiogfQ5EOM+sYQyeJgtuLQkdfwDBnScJx7IgBiOKFpXdaM9i08hSljFlbTT7zP0XjojtGD4U27nLuLqGUhmloLtc+6yBK2FL/7QWB2c9tyCgHiIhmXZesBhZRRFdrpwP66XoGIsgxt1AxFjV1z5MG0g7DULfUSqWG7gGOxvwITFwmqDwuA6rh952X5iJ7zopSSmGhrTeFrV/1Io0E8SsJhRM9m7BOdcg/X6X+5iqK5Obp6Js18Y7eddf/Q5amQSzwlXx6mJAyj2//1DnGz0UbacKStqgZZiC0xAhLEwo7XQIDAQAB"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        },\n        "ruleModify": {\n            "tokens": [\n                {\n                    "name": "Token1",\n                    "timelock": 0,\n                    "timeout": 600,\n                    "groups": [\n                        {\n                            "name": "Group1",\n                            "quorum": 1,\n                            "approvals": [\n                                {\n                                    "type": "public_key",\n                                    "name": "ApproverKey1",\n                                    "value": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApLwHSQM4sd93UtEJ+t6G22sopYmL6roZxQGL0GWn7WAaiogfQ5EOM+sYQyeJgtuLQkdfwDBnScJx7IgBiOKFpXdaM9i08hSljFlbTT7zP0XjojtGD4U27nLuLqGUhmloLtc+6yBK2FL/7QWB2c9tyCgHiIhmXZesBhZRRFdrpwP66XoGIsgxt1AxFjV1z5MG0g7DULfUSqWG7gGOxvwITFwmqDwuA6rh952X5iJ7zopSSmGhrTeFrV/1Io0E8SsJhRM9m7BOdcg/X6X+5iqK5Obp6Js18Y7eddf/Q5amQSzwlXx6mJAyj2//1DnGz0UbacKStqgZZiC0xAhLEwo7XQIDAQAB"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        },\n        "keyStatus": {\n            "blocked": false\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"create-a-csr",children:"Create a CSR"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"POST"}),": ",(0,r.jsx)(n.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Certificate/signCsrWithSkaKey",children:"/v1/certificate/request"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": We are creating a CSR (Certificate Signing Request) for the key ",(0,r.jsx)(n.code,{children:"SUB.approver.securosys.com"}),". This CSR is to be signed by a Root or intermediate-CA ",(0,r.jsx)(n.code,{children:"CA.approver.securosys.com"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:"{3,6,8,11,14}",children:'{\n  "csrSignRequest": {\n  "signKeyName": "sub.approver.securosys.com",\n  "keyPassword": null,\n  "signatureAlgorithm": "SHA256_WITH_RSA",\n  "validity": 365,\n  "standardCertificateAttributes": {\n    "commonName": "Approver-Intermediate-SUB"\n  },\n  "keyUsage": [\n    "DIGITAL_SIGNATURE"\n  ],\n  "extendedKeyUsage": [\n    "CODE_SIGNING"\n  ]\n}\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'{\n  "signRequestId": "60ac4e54-be5a-4521-8cb2-3be8d452bb0e"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Remember the ",(0,r.jsx)(n.code,{children:"signRequestId"}),", to fetch the result once the approval is given."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"approve-the-csr-request",children:"Approve the CSR Request"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. Open the approval app from securosys:"})," ",(0,r.jsx)(n.a,{href:"https://approver.securosys.com/all",children:"https://approver.securosys.com"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["2. Approve the request: ",(0,r.jsx)(n.code,{children:"APPROVE"})]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:t(76400).A+"",width:"1012",height:"211"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Fetch the result:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"GET:"})," ",(0,r.jsx)(n.a,{href:"https://rest-api.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Requests/getRequestStatus",children:"/v1/request/60ac4e54-be5a-4521-8cb2-3be8d452bb0e"})]}),"\n",(0,r.jsxs)(n.p,{children:["Put the ",(0,r.jsx)(n.code,{children:"signRequestId"})," from before we have remembered: id=",(0,r.jsx)(n.code,{children:"60ac4e54-be5a-4521-8cb2-3be8d452bb0e"})]}),"\n",(0,r.jsx)(n.admonition,{title:"Request Status",type:"note",children:(0,r.jsxs)(n.p,{children:["If the status of the Request other than ",(0,r.jsx)(n.code,{children:"EXECUTED"})," the approval did not work."]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",metastring:"{3,10}",children:'{\n  "id": "c3f9de5a-0c2b-46d8-b610-01c50bdd457e",\n  "status": "EXECUTED",\n  "executionTime": "2024-01-23T11:27:12Z",\n  "approvedBy": [\n    "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApLwHSQM4sd93UtEJ+t6G22sopYmL6roZxQGL0GWn7WAaiogfQ5EOM+sYQyeJgtuLQkdfwDBnScJx7IgBiOKFpXdaM9i08hSljFlbTT7zP0XjojtGD4U27nLuLqGUhmloLtc+6yBK2FL/7QWB2c9tyCgHiIhmXZesBhZRRFdrpwP66XoGIsgxt1AxFjV1z5MG0g7DULfUSqWG7gGOxvwITFwmqDwuA6rh952X5iJ7zopSSmGhrTeFrV/1Io0E8SsJhRM9m7BOdcg/X6X+5iqK5Obp6Js18Y7eddf/Q5amQSzwlXx6mJAyj2//1DnGz0UbacKStqgZZiC0xAhLEwo7XQIDAQAB"\n  ],\n  "notYetApprovedBy": [],\n  "rejectedBy": [],\n  "result": "-----BEGIN NEW CERTIFICATE REQUEST-----\\nMIICwTCCAakCAQAwJDEiMCAGA1UEAxMZQXBwcm92ZXItSW50ZXJtZWRpYXRlLVNV\\nQjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANjDXt9f/RiTP/RTATm7\\nhTdx2/js6jKvyl7n2vGgAqTnf7CYgcMJxgAhDMxBp3DTxNGuX8xzmC+8Qa0h273w\\nxhk63lYnX4eZQ71Rj2JJgbMN3mkZBKk+B6u3SOzBrm9t6K6KRsrW9mkc+1VQhbq3\\nWgPKJj0idq6T7DJd5c2fHnSglCF9dqUoG1WmjZ+QHXDjX6taSONFDP4u62WJmrfg\\n852P4QY1DN4+ztPJdzi1ntwTFU5bmMsth+xAQwH0RlSfvYzntuaDlomMLw2d+Unf\\nIdGaOmLGexzRAWR8cvcHE0izabFTN4zM1Swwg+memtqI2JlPpIU9YVSYOsGJwruJ\\n17ECAwEAAaBYMFYGCSqGSIb3DQEJDjFJMEcwFgYDVR0lAQH/BAwwCgYIKwYBBQUH\\nAwMwDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBRVQ31xCrWXfYZuBDzpZNVGn4S7\\nyTANBgkqhkiG9w0BAQsFAAOCAQEAaeZMIUZfiiMKctVSxAxngTS6DdCHYPPArXsy\\nuFnpaeBxAk4AegAMf3SVsVFUQX7VFfSwh/sK5Hq6n2ARXiBHqFp7FlDGA8piCq+L\\nDhJ7gj0ZEmnrJrdpzHgwF9kEzwscXlev41SNDyANbIglZpXhALNmPZBzeG9Lu6Q7\\n9/XDKHkR6b1Klk/V6VPpoWjEqGdIxGg7t6DW2QolRoFdvu5qSB646mRPcmGqgblU\\n2kGTS294C9ZhjnZsc6YUP+5/sP9CNCPuZtAgHrP+t52EC7rAk1jRc+XGUp86pXDV\\n1nMrBAEQldIqCzXtYhSZKHgHEmi7M719tu+dFnSAVuXZxbfL2g==\\n-----END NEW CERTIFICATE REQUEST-----\\n"\n}\n'})})]})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},76400:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/approval_csr-73ce8ec278a38c92329774f304c8aa5a.png"}}]);