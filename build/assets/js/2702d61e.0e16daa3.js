"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[90728],{681:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/LoginWriteSample-1b9107f06921749b21a539909e056f0a.java"},6802:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Tutorials/LoginSample","title":"HSM Login with JCE/JCA API - Sample","description":"Login Sample with Java Cryptography Extension (JCE) and Java Cryptography Architecture (JCA) with Securosys Hardware Security Modules.","source":"@site/jce/Tutorials/LoginSample.md","sourceDirName":"Tutorials","slug":"/Tutorials/LoginSample","permalink":"/jce/Tutorials/LoginSample","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"HSM Login with JCE/JCA API - Sample","sidebar_label":"Login Sample","description":"Login Sample with Java Cryptography Extension (JCE) and Java Cryptography Architecture (JCA) with Securosys Hardware Security Modules.","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Tutorial","permalink":"/jce/category/tutorial"},"next":{"title":"Sign & Verify","permalink":"/jce/Tutorials/SignVerify"}}');var r=i(74848),t=i(28453);const o={sidebar_position:0,title:"HSM Login with JCE/JCA API - Sample",sidebar_label:"Login Sample",description:"Login Sample with Java Cryptography Extension (JCE) and Java Cryptography Architecture (JCA) with Securosys Hardware Security Modules.",keywords:["hsm","cloud hsm"]},l="Login Sample",a={},d=[{value:"Breakdown",id:"breakdown",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"login-sample",children:"Login Sample"})}),"\n",(0,r.jsx)(n.p,{children:"This Java code is a sample implementation for logging into the Securosys Primus Hardware Security Module (HSM) using the Java Cryptography Extension (JCE) provider. The code demonstrates the process of installing the Primus JCE provider, configuring it with HSM details, logging in with a setup password, fetching and blinding a permanent secret, writing the blinded secret to a file, and finally, logging in again using the file-based credentials."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(681).A+"",children:"LoginSample.java"})}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsx)(n.p,{children:"This and the remaining samples assume direct connection to the HSM without reverse proxy.\nIf you are using Securosys CloudHSM, other HSM as a service using reverse proxy,\nor your own reverse proxy, you will need to apply the lesson from CloudHSMSample in the remaining samples."})]}),"\n",(0,r.jsx)(n.h2,{id:"breakdown",children:"Breakdown"}),"\n",(0,r.jsx)(n.p,{children:"Here is a breakdown of the key functionalities:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"HSM Configuration:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The user specifies the HSM host, TCP port, user/partition, and login credentials (setup password) for authentication."}),"\n",(0,r.jsx)(n.li,{children:"Optional configurations include proxy user and password for CloudHSM service."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Primus JCE Provider Installation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The Primus JCE provider is instantiated (",(0,r.jsx)(n.code,{children:"PrimusProvider"}),") and registered with the Java Security framework (",(0,r.jsx)(n.code,{children:"Security.addProvider(primusProvider)"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"HSM Configuration and Login:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["HSM host, port, and user are configured using ",(0,r.jsx)(n.code,{children:"PrimusConfiguration.setHsmHost"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Optionally, CloudHSM proxy credentials are configured."}),"\n",(0,r.jsx)(n.li,{children:"The login state is checked, and the setup password is used for the initial login."}),"\n",(0,r.jsx)(n.li,{children:"Information about the device (HSM) is retrieved, such as the device name and version."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Fetching and Blinding Permanent Secret:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The permanent secret is fetched using ",(0,r.jsx)(n.code,{children:"PrimusLogin.getUserSecretChars"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The fetched secret is blinded using the AES blinding algorithm (",(0,r.jsx)(n.code,{children:"PrimusBlinding.blindChars"}),")."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logging Out:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The user logs out from the HSM using ",(0,r.jsx)(n.code,{children:"PrimusLogin.logout"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Writing Blinded Permanent Secret to File:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The blinded permanent secret is written to a file with owner-only permissions."}),"\n",(0,r.jsx)(n.li,{children:"File permissions are set to read and write for the owner only."}),"\n",(0,r.jsxs)(n.li,{children:["The blinded secret is encoded to bytes and written to the file using ",(0,r.jsx)(n.code,{children:"Files.write"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logging In Again Using File-based Credentials:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The user logs in again using the file-based credentials."}),"\n",(0,r.jsx)(n.li,{children:"Device information is retrieved again after successful login."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Logging Out Again:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The user logs out again to ensure a clean exit."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sample Completion:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The sample concludes, and a message is printed indicating the completion of the process."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The code is heavily commented, providing detailed explanations for each step.\nIt showcases various operations related to HSM interaction, user authentication, and secure handling of credentials."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(96540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);