"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[79358],{8272:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Installation/Installation","title":"Configuring Microsoft SignTool & Security HSM","description":"Configuring Microsoft SignTool with Securosys Hardware Security Modules (HSMs)","source":"@site/ms-signtool/Installation/Installation.md","sourceDirName":"Installation","slug":"/Installation/","permalink":"/ms-signtool/Installation/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Configuring Microsoft SignTool & Security HSM","sidebar_label":"3. Configuration","description":"Configuring Microsoft SignTool with Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"2. Installing the API provider","permalink":"/ms-signtool/Installation/Provider"},"next":{"title":"Tutorial","permalink":"/ms-signtool/category/tutorial"}}');var i=t(74848),a=t(28453);t(65537),t(79329);const s={sidebar_position:2,title:"Configuring Microsoft SignTool & Security HSM",sidebar_label:"3. Configuration",description:"Configuring Microsoft SignTool with Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},l="Installation",o={},c=[{value:"Preparing Signing Key Request File",id:"preparing-signing-key-request-file",level:2},{value:"Generating Signing Key and Self-Signed Certificate",id:"generating-signing-key-and-self-signed-certificate",level:2},{value:"Generating Signing Key and Public Signed Certificate",id:"generating-signing-key-and-public-signed-certificate",level:2},{value:"Validate the Certificate",id:"validate-the-certificate",level:2},{value:"Next steps",id:"next-steps",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,i.jsx)(n.p,{children:"This procedure provides a straightforward integration process. Please take notice that there may be other ways to achieve interoperability."}),"\n",(0,i.jsx)(n.p,{children:"This guide assumes that you are familiar with the Primus HSM and the Microsoft Windows SDK signing tool and does not cover every step of the hardware and software setup process."}),"\n",(0,i.jsx)(n.h2,{id:"preparing-signing-key-request-file",children:"Preparing Signing Key Request File"}),"\n",(0,i.jsxs)(n.p,{children:["Prepare the input file for the certreq.exe tool (sample ",(0,i.jsx)(n.code,{children:"request.inf"})," file):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'[Version]\nSignature= "$Windows NT$"\n[NewRequest]\nValidityPeriod = Years\nValidityPeriodUnits = 1\nSubject = "CN=signtooldemo.hsmdemo.test"\nFriendlyName = "Signtool Demo Key"\nMachineKeySet = True\nRequestType = Cert\nExportable = FALSE\nHashAlgorithm = SHA256\nKeyAlgorithm = RSA\nKeyLength = 4096\nKeyUsage = 0xf0\nProviderName = "Securosys Primus HSM Key Storage Provider"\nKeyContainer = "signtooldemokey"\n;[EnhancedKeyUsageExtension]\n;OID=1.3.6.1.5.5.7.3.1\n;[RequestAttributes]\n;CertificateTemplateName = <yourADCSTemplate>\n'})}),"\n",(0,i.jsx)(n.p,{children:"Update the following values:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Subject"}),", replace with your real data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ValidityPeriod"}),", ValidityPeriodUnits \u2013 replace according to your requirements"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"KeyContainer"}),", define your key container ID or remove the line for default values"]}),"\n",(0,i.jsx)(n.li,{children:"Adapt the algorithms according to your requirements"}),"\n",(0,i.jsx)(n.li,{children:"Define additional extensions and CertificateTemplateName if required"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RequestType"}),", adapt e.g. if you want to use a publicly signed certificate (PKCS10)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"generating-signing-key-and-self-signed-certificate",children:"Generating Signing Key and Self-Signed Certificate"}),"\n",(0,i.jsxs)(n.p,{children:["Use the below command to generate a new signing key and self-signed certificate according to the previously prepared sample ",(0,i.jsx)(n.code,{children:"request.inf"})," file."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"certreq -new request.inf SigningCertificate.cer\n\nInstalled Certificate:\n  Serial Number: 1aaa8bbcd7c98cb74c9dff9f9e40cf10\n  Subject: CN=signtooldemo.hsmdemo.test\n  NotBefore: 14/02/2024 16:21\n  NotAfter: 14/02/2025 16:31\n  Thumbprint: cb1a55f6ab8ccacedab3fcd9de48bd69be16b88d\n  Friendly Name: Signtool Demo Key\n  Securosys Primus HSM Key Storage Provider\n  signtooldemokey\n\n\nCertReq: Certificate Created and Installed\n"})}),"\n",(0,i.jsx)(n.h2,{id:"generating-signing-key-and-public-signed-certificate",children:"Generating Signing Key and Public Signed Certificate"}),"\n",(0,i.jsxs)(n.p,{children:["When a publicly signed certificate is required, adapt the ",(0,i.jsx)(n.code,{children:"RequestType"})," to ",(0,i.jsx)(n.strong,{children:"\u201cPKCS10\u201d"})," and generate the Certificate Signing Request (CSR) to be signed by a public Certification Authority (CA):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"certreq -new request.inf SigningCertificate.csr\n"})}),"\n",(0,i.jsx)(n.p,{children:"To make the public signed certificate available for use, execute the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"certreq.exe \u2013accept -machine <certificateFilename.cer>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Where ",(0,i.jsx)(n.code,{children:"<certificateFilename.cer>"})," is the binary signed certificate received from the CA/SubCA."]}),"\n",(0,i.jsx)(n.h2,{id:"validate-the-certificate",children:"Validate the Certificate"}),"\n",(0,i.jsx)(n.p,{children:"Verify your signing certificate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'certutil -store -v my "<Certificate_serial_number_or_thumbprint>"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Example of the self-signed certificate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'certutil -store -v my "1aaa8bbcd7c98cb74c9dff9f9e40cf10"\n\nmy "Personal"\n================ Certificate 0 ================\nX509 Certificate:\nVersion: 3\nSerial Number: 1aaa8bbcd7c98cb74c9dff9f9e40cf10\nSignature Algorithm:\n    Algorithm ObjectId: 1.2.840.113549.1.1.11 sha256RSA\n    Algorithm Parameters:\n    05 00\nIssuer:\n    CN=signtooldemo.hsmdemo.test\n  Name Hash(sha1): e0f35912a4d53f78e8443f219d77c57b79c65759\n  Name Hash(md5): e066872e7bef87abba6bb1f1a4512d94\n\n NotBefore: 14/02/2024 16:21\n NotAfter: 14/02/2025 16:31\n\nSubject:\n    CN=signtooldemo.hsmdemo.test\n  Name Hash(sha1): e0f35912a4d53f78e8443f219d77c57b79c65759\n  Name Hash(md5): e066872e7bef87abba6bb1f1a4512d94\n\nPublic Key Algorithm:\n\u2026\n'})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"../Tutorials/Signing-files",children:"Tutorial - How to sign files with Microsoft SignTool?"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var r=t(96540);const i={},a=r.createContext(i);function s(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:n},e.children)}},65537:(e,n,t)=>{t.d(n,{A:()=>j});var r=t(96540),i=t(34164),a=t(65627),s=t(56347),l=t(50372),o=t(30604),c=t(11861),u=t(78749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function f(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const i=(0,s.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(i.location.search);n.set(a,e),i.replace({...i.location,search:n.toString()})}),[a,i])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,a=h(e),[s,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!f({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[c,d]=g({queryString:t,groupId:i}),[m,p]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,a]=(0,u.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:i}),b=(()=>{const e=c??m;return f({value:e,tabValues:a})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!f({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),p(e)}),[d,p,a]),tabValues:a}}var p=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(74848);function x(e){let{className:n,block:t,selectedValue:r,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),u=e=>{const n=e.currentTarget,t=o.indexOf(n),i=l[t].value;i!==r&&(c(n),s(i))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{o.push(e)},onKeyDown:d,onClick:u,...a,className:(0,i.A)("tabs__item",b.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function S(e){let{lazy:n,children:t,selectedValue:a}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function v(e){const n=m(e);return(0,y.jsxs)("div",{className:(0,i.A)("tabs-container",b.tabList),children:[(0,y.jsx)(x,{...n,...e}),(0,y.jsx)(S,{...n,...e})]})}function j(e){const n=(0,p.A)();return(0,y.jsx)(v,{...e,children:d(e.children)},String(n))}},79329:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var r=t(34164);const i={tabItem:"tabItem_Ymn6"};var a=t(74848);function s(e){let{children:n,hidden:t,className:s}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,s),hidden:t,children:n})}}}]);