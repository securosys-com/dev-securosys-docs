"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[84840],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(96540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}},65537:(e,n,t)=>{t.d(n,{A:()=>T});var i=t(96540),r=t(34164),o=t(65627),s=t(56347),a=t(50372),l=t(30604),c=t(11861),d=t(78749);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:r}}=e;return{value:n,label:t,attributes:i,default:r}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const r=(0,s.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(o),(0,i.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(r.location.search);n.set(o,e),r.replace({...r.location,search:n.toString()})}),[o,r])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=h(e),[s,l]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:o}))),[c,u]=g({queryString:t,groupId:r}),[f,m]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,o]=(0,d.Dv)(t);return[r,(0,i.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:r}),x=(()=>{const e=c??f;return p({value:e,tabValues:o})?e:null})();(0,a.A)((()=>{x&&l(x)}),[x]);return{selectedValue:s,selectValue:(0,i.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),m(e)}),[u,m,o]),tabValues:o}}var m=t(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=t(74848);function y(e){let{className:n,block:t,selectedValue:i,selectValue:s,tabValues:a}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),d=e=>{const n=e.currentTarget,t=l.indexOf(n),r=a[t].value;r!==i&&(c(n),s(r))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:a.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>{l.push(e)},onKeyDown:u,onClick:d,...o,className:(0,r.A)("tabs__item",x.tabItem,o?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function b(e){let{lazy:n,children:t,selectedValue:o}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===o));return e?(0,i.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function v(e){const n=f(e);return(0,j.jsxs)("div",{className:(0,r.A)("tabs-container",x.tabList),children:[(0,j.jsx)(y,{...n,...e}),(0,j.jsx)(b,{...n,...e})]})}function T(e){const n=(0,m.A)();return(0,j.jsx)(v,{...e,children:u(e.children)},String(n))}},67708:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Installation/Plugin-Installation/AlternativeWays/PluginConfiguration","title":"Docker Signing Plugin configuration","description":"Docker Signing Plugin configuration","source":"@site/docker_signing/Installation/Plugin-Installation/AlternativeWays/PluginConfiguration.md","sourceDirName":"Installation/Plugin-Installation/AlternativeWays","slug":"/Installation/Plugin-Installation/AlternativeWays/PluginConfiguration","permalink":"/docker_signing/Installation/Plugin-Installation/AlternativeWays/PluginConfiguration","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Docker Signing Plugin configuration","sidebar_label":"Configuration","description":"Docker Signing Plugin configuration","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/docker_signing/Installation/Plugin-Installation/AlternativeWays/Installation"},"next":{"title":"5. Verify Setup","permalink":"/docker_signing/Installation/VerifyPlugin"}}');var r=t(74848),o=t(28453);t(65537),t(79329);const s={sidebar_position:2,title:"Docker Signing Plugin configuration",sidebar_label:"Configuration",description:"Docker Signing Plugin configuration",keywords:["hsm","cloud hsm"]},a="Plugin configuration",l={},c=[{value:"Securosys Docker Signing Notation Plugin",id:"securosys-docker-signing-notation-plugin",level:3},{value:"Plugin configuration",id:"plugin-configuration-1",level:2},{value:"Configure Securosys plugin configuration file",id:"configure-securosys-plugin-configuration-file",level:3},{value:"Create Securosys plugin configuration environment variable and directory (optional)",id:"create-securosys-plugin-configuration-environment-variable-and-directory-optional",level:3}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"plugin-configuration",children:"Plugin configuration"})}),"\n",(0,r.jsx)(n.h3,{id:"securosys-docker-signing-notation-plugin",children:"Securosys Docker Signing Notation Plugin"}),"\n",(0,r.jsx)(n.admonition,{title:"Caution",type:"tip",children:(0,r.jsx)(n.p,{children:"In this guide we will use the Linux Ubuntu 22 (amd 64), for other operating systems and Linux distributions please refer to the referenced guides."})}),"\n",(0,r.jsx)(n.admonition,{title:"Reminder",type:"danger",children:(0,r.jsx)(n.p,{children:"Note on some occasion's commands may require root permissions. Your system and docker user permissions should be configured beforehand to avoid any potential permission issues."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"plugin-configuration-1",children:"Plugin configuration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"config.json"})," file, extracted from the downloaded ",(0,r.jsx)(n.strong,{children:"Securosys Docker Signing"})," configuration files in ",(0,r.jsx)(n.a,{href:"../../../Installation/DonwloadPlugin#unzip-securosys-docker-signing-notation-plugin-configuration-file",children:"chapter"}),", is used to configure the ",(0,r.jsx)(n.a,{href:"/docker_signing/Concepts/DockerSigningConcept",children:"Securosys Docker Signing Notation Plugin"})," connection between:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["the ",(0,r.jsx)(n.em,{children:"Notation CLI"})]}),"\n",(0,r.jsxs)(n.li,{children:["Securosys Transaction Security Broker (TSB), as linking element to the ",(0,r.jsx)(n.a,{href:"/cloudhsm/overview/",children:"CloudHSM"})," or on-prem Primus HSM."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"config.json"})," file contains the Transaction Security Broker (TSB) connection parameters:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"URL,"}),"\n",(0,r.jsx)(n.li,{children:"authentication method,"}),"\n",(0,r.jsx)(n.li,{children:"authentication token / TLS parameters."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Add the Transaction Security Broker (TSB) connection parameters provided by the Securosys ",(0,r.jsx)(n.a,{href:"/cloudhsm/overview/",children:"CloudHSM"})," operations team or by your HSM/TSB administrator."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"configure-securosys-plugin-configuration-file",children:"Configure Securosys plugin configuration file"}),"\n",(0,r.jsxs)(n.p,{children:["After completing the ",(0,r.jsxs)(n.a,{href:"/docker_signing/Installation/Plugin-Installation/RecommendedOption",children:["automatic ",(0,r.jsx)(n.strong,{children:"notation-securosys"})," install"]}),",\nor manually creating and copying of the necessary files and setting the environment variables, copy the Docker Signing Notation Plugin ",(0,r.jsx)(n.code,{children:"config.json"})," configuration file to the ",(0,r.jsx)(n.code,{children:"{BINARY_PATH}"})," and edit using your preferred editor."]}),"\n",(0,r.jsx)(n.admonition,{title:"CAUTION",type:"danger",children:(0,r.jsxs)(n.p,{children:["The notation-securosys plugin defaults to searching for the ",(0,r.jsx)(n.code,{children:"config.json"})," file in the ",(0,r.jsx)(n.code,{children:"{BINARY_PATH}"}),". To use a different directory, set the ",(0,r.jsx)(n.code,{children:"CONFIG_PATH"})," environment variable."]})}),"\n",(0,r.jsxs)(n.p,{children:["Copy ",(0,r.jsx)(n.code,{children:"config.json"})," to ",(0,r.jsx)(n.code,{children:"BINARY_PATH"})," and start editing:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"cp ./config.json BINARY_PATH/config.json \n\nvi {BINARY_PATH}/config.json\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The default ",(0,r.jsx)(n.code,{children:"config.json"})," configuration file must be adapted according to your parameters.\nReplace the variables on the right side with your parameters."]}),"\n",(0,r.jsxs)(n.p,{children:["You may replace the link ",(0,r.jsx)(n.code,{children:"https://primusdev.cloudshsm.com/"})," ",(0,r.jsx)(n.em,{children:"below"}),"  by a ",(0,r.jsx)(n.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"TSBaaS - Connectivity Details"})," for accurate API-Endpoint URI."]}),"\n",(0,r.jsxs)(n.p,{children:["Example default ",(0,r.jsx)(n.code,{children:"config.json"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'{ \n\n  "restApi": "https://primusdev.cloudshsm.com", \n\n  "authType": "TOKEN", \n\n  "token": "TSBtoken", \n\n  "apiKeys": {\n        "KeyManagementToken": ["TSB-TOKEN_1...", "TSB-TOKEN_2..."],\n        "KeyOperationToken": ["TSB-TOKEN_3..", "TSB-TOKEN_4.."],\n        "ServiceToken": ["TSB-TOKEN_5...", "TSB-TOKEN_6.."]\n    },\n    "applicationKeyPair": {\n        "publicKey": "PUBLIC_KEY",\n        "privateKey": "PRIVATE_KEY"\n    },\n\n  "metaData": { \n\n    "UserMetadata": "example of metaData" \n\n  } \n\n} \n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Config.json"})," configuration parameters:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Configuration Parameters"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"restApi":"https://primusdev.cloudshsm.com"'})}),(0,r.jsx)(n.td,{children:"Replace the variable with your connection parameter for CloudsHSM's REST API service or for the customer's on-prem deployment."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"authType":"authType"'})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:'"authType":"TOKEN"'}),":",(0,r.jsx)("br",{})," Authentication based on JWT token, standard value for CloudHSM's REST/TSB API service.",(0,r.jsx)("br",{})," ",(0,r.jsx)(n.code,{children:'"authType":"CERT"'}),":",(0,r.jsx)("br",{})," Authentication based on mutual TLS. Used for CloudHSM Platinum REST/TSB API service or on-premises deployments."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"token":"TSBtoken"'})}),(0,r.jsxs)(n.td,{children:["For ",(0,r.jsx)(n.code,{children:'"authType":"TOKEN"'}),": Replace the variable with your own TSB JWT token. Omit in case of ",(0,r.jsx)(n.code,{children:'"authType":"CERT"'}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"certpath": "PathToCrt"'})}),(0,r.jsxs)(n.td,{children:["For ",(0,r.jsx)(n.code,{children:'"authType":"CERT"'}),": Provide the full path of the server certificate file. Omit in case of ",(0,r.jsx)(n.code,{children:'"authType":"TOKEN"'}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"keypath": "PathToKey"'})}),(0,r.jsxs)(n.td,{children:["For ",(0,r.jsx)(n.code,{children:'"authType":"CERT"'}),": Provide the full path of the client key file. Omit in case of ",(0,r.jsx)(n.code,{children:'"authType":"TOKEN"'}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"apiKeys": {...}'})}),(0,r.jsxs)(n.td,{children:["Additional authentication for TSB, set correct api keys values for specific operations, more than one token can be provided for each field. This is optional and will not break existing deployments. For more info visit ",(0,r.jsx)(n.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/PrimusAuthorizationApp/approver-mangement-api",children:"page"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"applicationKeyPair":{...}'})}),(0,r.jsx)(n.td,{children:"Pair of public and private key (base64 encoded) used to calculate the signature."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"metaData":{"UserMetadata":"example of metaData"}'})}),(0,r.jsx)(n.td,{children:"Optional, add any user metadata, e.g. description."})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["Example configured ",(0,r.jsx)(n.code,{children:"config.json"})," file for shared (token-based) CloudHSM setup:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'{ \n\n  "restApi": "https://primusdev.cloudshsm.com", \n\n  "authType": "TOKEN", \n\n  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJwcmltdXNkZXYiLCJ2ZXIiOjEsIm5iZiI6MTY4MDUxNT\u2026", \n\n  "apiKeys": {\n        "KeyManagementToken": ["tsb-x-token_1...", "tsb-x-token_2..."],\n        "KeyOperationToken": ["tsb-x-token_3..", "tsb-x-token_4.."],\n        "ServiceToken": ["tsb-x-token_5...", "tsb-x-token_6.."]\n    },\n    "applicationKeyPair": {\n        "publicKey": "MIIBIjANBgkqhk...",\n        "privateKey": "MIIEvgIBADANBgkqhkiG9w0BAQE..."\n    },\n\n  "metaData": { \n\n    "UserMetadata": "example of metaData" \n\n  } \n\n} \n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"create-securosys-plugin-configuration-environment-variable-and-directory-optional",children:"Create Securosys plugin configuration environment variable and directory (optional)"}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"tip",children:(0,r.jsxs)(n.p,{children:["In case you want to store the ",(0,r.jsx)(n.code,{children:"config.json"})," file in a different directory than ",(0,r.jsx)(n.code,{children:"{BINARY_PATH}"}),", the environment variable ",(0,r.jsx)(n.code,{children:"CONIFG_PATH"})," must be set.",(0,r.jsx)(n.br,{}),"\n","You may use this to set up communication with different HSM partitions."]})}),"\n",(0,r.jsxs)(n.p,{children:["Choose one of the options to set the ",(0,r.jsx)(n.code,{children:"CONFIG_PATH"})," variable:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Set an environment variable pointing to the configuration path and add it to ",(0,r.jsx)(n.code,{children:"~/.bashrc"}),", then reload in the shell:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"echo 'export CONFIG_PATH=PLUGIN_CONFIG_PATH' >> ~/.bashrc \n\nsource ~/.bashrc\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Refresh the terminal window or source ",(0,r.jsx)(n.code,{children:"~/.bashrc"})," to confirm the changes to the file and set the environment variable.\nExample:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"Echo 'export CONFIG_PATH=\"${HOME}/.config/notation/plugins/securosys/config.json\"' >> ~/.bashrc \n\nsource ~/.bashrc\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Alternatively, add this variable temporarily to the system environment with the following command:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'export CONFIG_PATH="${HOME}/.config/notation/plugins/securosys/config.json" \n'})}),"\n",(0,r.jsxs)(n.admonition,{title:"Warning",type:"danger",children:[(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["In case the variable is not set in the system environment, ",(0,r.jsx)(n.code,{children:"CONFIG_PATH={PLUGIN_CONFIG_PATH}"})," must be applied before every command, e.g."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"CONFIG_PATH=$CONFIG_PATH/config.json ./notation-securosys describe-key\n"})})]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},79329:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var i=t(34164);const r={tabItem:"tabItem_Ymn6"};var o=t(74848);function s(e){let{children:n,hidden:t,className:s}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,i.A)(r.tabItem,s),hidden:t,children:n})}}}]);