"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[88467],{28453:(n,e,i)=>{i.d(e,{R:()=>o,x:()=>l});var s=i(96540);const r={},t=s.createContext(r);function o(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),s.createElement(t.Provider,{value:e},n.children)}},94277:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Installation/installation-multi","title":"Installing Multiple Microsoft CNG Provider Instances","description":"Installing Microsoft CNG via Active Directory Group Policy for Securosys Hardware Security Modules (HSMs)","source":"@site/mscng/Installation/installation-multi.md","sourceDirName":"Installation","slug":"/Installation/installation-multi","permalink":"/mscng/Installation/installation-multi","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Installing Multiple Microsoft CNG Provider Instances","sidebar_label":"Installing Multiple Provider Instances","description":"Installing Microsoft CNG via Active Directory Group Policy for Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Installing via Group Policy","permalink":"/mscng/Installation/installation-AD"},"next":{"title":"Configuring the HSM","permalink":"/mscng/Installation/Configuring"}}');var r=i(74848),t=i(28453);const o={sidebar_position:4,title:"Installing Multiple Microsoft CNG Provider Instances",sidebar_label:"Installing Multiple Provider Instances",description:"Installing Microsoft CNG via Active Directory Group Policy for Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},l="Installing Multiple CNG/KSP Provider Instances",a={},c=[{value:"Installation Steps",id:"installation-steps",level:2},{value:"Steps to Increase Provider Instances",id:"steps-to-increase-provider-instances",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"installing-multiple-cngksp-provider-instances",children:"Installing Multiple CNG/KSP Provider Instances"})}),"\n",(0,r.jsxs)(e.p,{children:["Starting from CNG/KSP Provider ",(0,r.jsx)(e.strong,{children:"version 1.40"}),", multiple provider instances can be installed."]}),"\n",(0,r.jsxs)(e.p,{children:["These can only be installed using procedures based on the ",(0,r.jsxs)(e.strong,{children:[(0,r.jsx)(e.code,{children:"KspCfg.ini"})," configuration file"]})," and the number of provider instances can only be changed via the installation procedure."]}),"\n",(0,r.jsx)(e.h2,{id:"installation-steps",children:"Installation Steps"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["Adapt the ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," sample file, located within the setup folder.\nThe section ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"PROVIDERS"})})," of the ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," configuration file defines how many provider instances will be installed including their naming:"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"[PROVIDERS]\n\nPROVIDER_1 = Securosys Primus HSM Key Storage Provider 1\n\nPROVIDER_2 = Securosys Primus HSM Key Storage Provider 2\n\nPROVIDER_3 = Securosys Primus HSM MyPartition\n\nPROVIDER_4 = Customer ABC\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:'Delete further sections in case you configure the provider instances via the graphical Securosys "Key Storage Provider Configuration" tool.'}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["To configure the provider during the installation procedure (e.g. Active Directory), define the other sections with the necessary configuration parameters per provider instance. See ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," sample file for explanations."]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["The following example shows the configuration for a provider using a developer account and a second provider using a ",(0,r.jsx)(e.a,{href:"/cloudhsm/Packages/sandbox",children:"CloudHSM Sandbox (SBX)"})," partition:"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"[PROVIDERS]\n\nPROVIDER_1 = Primus Dev MY-PARTITION\n\nPROVIDER_2 = Primus Sandbox TEST-PARTITION\n\n[PROVIDER_1.HSM_1]\n\nID = Grimsel_MY-Partition\n\nHOSTNAME = grimsel.securosys.ch\n\nPORTNUMBER = 2320\n\nPRIORITY = 0\n\nHSM_USERNAME = MY-PARTITION\n\nHSM_PASSWORD = KC5b2-VX5NZ-\u2026-8CbGZ-1NCre\n\n[PROVIDER_2.HSM_1]\n\nID = CloudHSM-Sandbox_TEST-PARTITION\n\nHOSTNAME = a-api.cloudshsm.com\n\nPORTNUMBER = 2320\n\nPRIORITY = 0\n\nHSM_USERNAME = TEST-PARTITION\n\nHSM_PASSWORD = KC5b2-VX5NZ-\u2026-8CbGZ-1NCre\n\nPROXY_USERNAME = myServiceUserName\n\nPROXY_PASSWORD = ivd0rra\u2026s4mpgb7\n\n[PROVIDER_2.HSM_2]\n\nID = CloudHSM-Sandbox_TEST-PARTITION\n\nHOSTNAME = b-api.cloudshsm.com\n\nPORTNUMBER = 2320\n\nPRIORITY = 0\n\nHSM_USERNAME = TEST-PARTITION\n\nHSM_PASSWORD = KC5b2-VX5NZ-\u2026-8CbGZ-1NCre\n\nPROXY_USERNAME = myServiceUserName\n\nPROXY_PASSWORD = ivd0rra\u2026s4mpgb7\n\n"})}),"\n",(0,r.jsx)(e.h2,{id:"steps-to-increase-provider-instances",children:"Steps to Increase Provider Instances"}),"\n",(0,r.jsx)(e.p,{children:"The number of provider instances can only be changed by reinstalling the providers. We suggest the following procedure (requiring administrator rights, but no new setup password):"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["First, update to CNG/KSP Provider ",(0,r.jsx)(e.strong,{children:"V1.41+"}),", the regular way (if an older version is installed)."]}),"\n",(0,r.jsx)(e.li,{children:"Open a CMD shell with administrator rights and export the current configuration with the following command (contains blinded secrets!):"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:'"%ProgramFiles%\\Securosys\\PrimusHsmKsp\\kspcfgcons.exe" ExportCfg OldConfig.ini\n'})}),"\n",(0,r.jsxs)(e.ol,{start:"3",children:["\n",(0,r.jsxs)(e.li,{children:["Copy this configuration file OldConfig.ini to ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," within your setup folder."]}),"\n",(0,r.jsxs)(e.li,{children:["Adapt the configuration, section ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"PROVIDERS"})}),", by adding the providers according to your needs (quantity and provider naming). Add the new configuration parameters as shown in ",(0,r.jsx)(e.a,{href:"/mscng/Installation/installation-multi#installation-steps",children:"this section"})," or configure them later via the GUI."]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Example:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"[PROVIDERS]\n\nPROVIDER_1 = Securosys Primus HSM Key Storage Provider\n\nPROVIDER_2 = Securosys Primus HSM New Partition\n\n[PROVIDER_1.HSM_1]\n\nID = Grimsel Internal\n\nDEVICENAME = GRIMSEL\n\nHOSTNAME = grimsel.securosys.ch\n\nPORTNUMBER = 2320\n\nPRIORITY = 0\n\nCLI = C91C506A5C34BDE8889372FB332A\u2026EC81BD43033915DA486D7C549C261CA79CF6D9F137\n\nCLS = C61C563490E894930BFB202A29F879\u20260FC42DC39D1798E653C13E57F7983ECE4E12FF99\n\nCLC = 2077E78A123096DA4F588BEAD395\u20261B691D095E2C9B606215762D8AF2A5CA20F4FD52A5\n\n\u2026\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"5",children:["\n",(0,r.jsx)(e.li,{children:"Uninstall the current CNG/KSP Provider"}),"\n",(0,r.jsxs)(e.li,{children:["Install the CNG/KSP Provider again by applying the following command, using the configuration file ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," ",(0,r.jsx)(e.strong,{children:"located within your setup folder"})," :"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-js",children:"MsiExec /quiet /i setup_x64.msi INSTALLCFG=1\n"})}),"\n",(0,r.jsx)(e.admonition,{title:"Error Warning",type:"caution",children:(0,r.jsxs)(e.p,{children:["Please note that any errors in the ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"KspCfg.ini"})})," file will result in a failed installation of the providers."]})})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}}}]);