"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[98338],{28453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>l});var n=t(96540);const a={},s=n.createContext(a);function i(e){const r=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(s.Provider,{value:r},e.children)}},49002:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"Tutorials/Import/importKey","title":"Import Locally Generated Keys","description":"Learn how to import keys using Cloud Hardware Security Modules (HSM).","source":"@site/tsb/Tutorials/Import/importKey.md","sourceDirName":"Tutorials/Import","slug":"/Tutorials/Import/importKey","permalink":"/tsb/Tutorials/Import/importKey","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Import Locally Generated Keys","sidebar_label":"Import Locally Generated Keys","description":"Learn how to import keys using Cloud Hardware Security Modules (HSM).","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","BIP32 seed","BTC address generation","key import","HSM key import","ECC cryptography","elliptic curve cryptography","key attributes","HSM policies"]},"sidebar":"tutorialSidebar","previous":{"title":"Import from Bip32 Seed","permalink":"/tsb/Tutorials/Import/seeding"},"next":{"title":"HMAC Signing","permalink":"/tsb/Tutorials/Mac/hmac"}}');var a=t(74848),s=t(28453),i=t(65537),l=t(79329);const o={sidebar_position:1,title:"Import Locally Generated Keys",sidebar_label:"Import Locally Generated Keys",description:"Learn how to import keys using Cloud Hardware Security Modules (HSM).",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","BIP32 seed","BTC address generation","key import","HSM key import","ECC cryptography","elliptic curve cryptography","key attributes","HSM policies"]},c=void 0,u={},p=[{value:"Generate KeyPair (Locally)",id:"generate-keypair-locally",level:2},{value:"Get the private key",id:"get-the-private-key",level:2},{value:"Get the public key",id:"get-the-public-key",level:2},{value:"Import the Private &amp; Public Key into the HSM",id:"import-the-private--public-key-into-the-hsm",level:2},{value:"Usage",id:"usage",level:2}];function d(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.p,{children:"When working with Cloud Hardware Security Modules (HSM), you may need to import cryptographic keys for secure operations such as encryption, decryption, signing, or key wrapping. This guide walks you through the process of generating and importing RSA keys\u2014both public and private\u2014into the HSM."}),"\n",(0,a.jsxs)(r.p,{children:["For scenarios where only encryption or key wrapping is required, you can import the ",(0,a.jsx)(r.strong,{children:"public key"})," to the HSM, allowing you to encrypt data or symmetric keys securely without exposing private key information. Alternatively, if decryption or signing is required, you can import a full key pair (private and public keys) into the HSM to leverage its secure key management and cryptographic capabilities."]}),"\n",(0,a.jsx)(r.p,{children:"This page details how to:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Generate RSA key pairs locally."}),"\n",(0,a.jsx)(r.li,{children:"Extract and clean keys for compatibility with the HSM."}),"\n",(0,a.jsx)(r.li,{children:"Import keys (both public-only and key pairs) into the HSM using the appropriate API."}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"generate-keypair-locally",children:"Generate KeyPair (Locally)"}),"\n",(0,a.jsx)(r.p,{children:"To create a new RSA key pair locally, use the following command. This will generate a private key (private_key.pem) with a length of 4096 bits."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:"openssl genrsa -out private_key.pem 4096\n"})}),"\n",(0,a.jsx)(r.h2,{id:"get-the-private-key",children:"Get the private key"}),"\n",(0,a.jsx)(r.admonition,{title:"Get Private Key",type:"note",children:(0,a.jsx)(r.p,{children:"After generating the private key, it needs to be base64 encoded and cleaned up by removing the header/footer and newline characters. This step ensures compatibility with the HSM API."})}),"\n",(0,a.jsxs)(i.A,{groupId:"prepare-key",children:[(0,a.jsx)(l.A,{value:"bash",label:"Linux (Bash)",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:"sed '/-----BEGIN PRIVATE KEY-----/d; /-----END PRIVATE KEY-----/d' private_key.pem | tr -d '\\n'\n"})})}),(0,a.jsx)(l.A,{value:"powershell",label:"Windows (PowerShell)",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:'(Get-Content private_key.pem | Where-Object {$_ -notmatch "-----BEGIN PRIVATE KEY-----|-----END PRIVATE KEY-----"} | Out-String).Replace("`n", "").Replace("`r", "")\n'})})})]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Response"}),":"]}),"\n",(0,a.jsx)(r.p,{children:"The output will be a single-line, base64-encoded private key string."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"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\n"})}),"\n",(0,a.jsx)(r.h2,{id:"get-the-public-key",children:"Get the public key"}),"\n",(0,a.jsx)(r.p,{children:"To derive the public key from the private key and save it to a file:"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Write the Public-Key to a file"})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:"openssl rsa -in private_key.pem -pubout -out public_key.pem\n"})}),"\n",(0,a.jsx)(r.p,{children:"Next, extract and clean the public key, as done for the private key."}),"\n",(0,a.jsxs)(i.A,{groupId:"prepare-key",children:[(0,a.jsx)(l.A,{value:"bash",label:"Linux (Bash)",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:"sed '/-----BEGIN PUBLIC KEY-----/d; /-----END PUBLIC KEY-----/d' public_key.pem | tr -d '\\n'\n"})})}),(0,a.jsx)(l.A,{value:"powershell",label:"Windows (PowerShell)",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-sh",children:'(Get-Content public_key.pem | Where-Object {$_ -notmatch "-----BEGIN PUBLIC KEY-----|-----END PUBLIC KEY-----"} | Out-String).Replace("`n", "").Replace("`r", "")\n'})})})]}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Response"}),":"]}),"\n",(0,a.jsx)(r.p,{children:"The response is the Public-Key withouth prefix."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA1fbXG+hHasG7C+mKlgd9xn+VsCJTJgIczGGSEPivGGMW5y1GRnPbZfMOfRVJGmMSLPntFS7Lazmb3U2vyCvWB0ovRtRTOWsInLr8FKaF1Cb4j2R0Rrfh4ZVOvyKdIWvFo5jBPqCMmT7DonKJ/TrFx/IlR1eweLnqK+mSsWUgbgTfq2tPRJBeV3mHDREzl++CtG6BRBBnzi3sb12lxOsoGpoXGUcrOpd+eDjIzD664uYz7eV8b+s8nwNWw38jiGpqiu/MU/wdaWFGht91uWE0NNhV5Vb88Rb+Ge90SP4capDbYN33Q5mSHBLA7yGF6+AgXFGjQfHA8p7cVy5jhKtarVFCN1in0DYj8aKYRW+QbPRBwveU36ogg/gZEvoGRTVI55RuLHHR2EtLyRuVH4f0bMBcMD53CEJMBSTrrkg42bmr79OToek6MnxwYMIRg803Y6y6HTOvNC7+bUTCdNVb7D2kKZgebSqK2qg1voHxnmMLeMf/Csi6sS9O18DUjahotfo79SQV7Pa7h21n3G5K0BOrUWMTaH4vY3IsOHjo3fFwr/uJ0KMXGFZgBVcw7lkEZy4A7p0hKhkHB9ldlFMq8jT7lXRz3Jo8VxGmIOWCzDrru1VRg80nIqZa/RPue7LF6+pQveZKyhZg3A80tgydeDiJL5WJ9A8aoBAOPREHassCAwEAAQ==\n"})}),"\n",(0,a.jsx)(r.h2,{id:"import-the-private--public-key-into-the-hsm",children:"Import the Private & Public Key into the HSM"}),"\n",(0,a.jsx)(r.p,{children:"Use the following API to import the generated private and public keys into the HSM. Ensure that the appropriate key strings are inserted into the JSON payload."}),"\n",(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST"}),": ",(0,a.jsx)(r.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/importPlainKey",children:"/v1/importedKey"})]}),"\n",(0,a.jsxs)(i.A,{groupId:"import-private-public-key",children:[(0,a.jsx)(l.A,{value:"import-private-key",label:"Import KeyPair",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "label": "import_keypair",\n  "algorithm": "RSA",  \n  "privateKey": "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",\n  "publicKey": "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA1fbXG+hHasG7C+mKlgd9xn+VsCJTJgIczGGSEPivGGMW5y1GRnPbZfMOfRVJGmMSLPntFS7Lazmb3U2vyCvWB0ovRtRTOWsInLr8FKaF1Cb4j2R0Rrfh4ZVOvyKdIWvFo5jBPqCMmT7DonKJ/TrFx/IlR1eweLnqK+mSsWUgbgTfq2tPRJBeV3mHDREzl++CtG6BRBBnzi3sb12lxOsoGpoXGUcrOpd+eDjIzD664uYz7eV8b+s8nwNWw38jiGpqiu/MU/wdaWFGht91uWE0NNhV5Vb88Rb+Ge90SP4capDbYN33Q5mSHBLA7yGF6+AgXFGjQfHA8p7cVy5jhKtarVFCN1in0DYj8aKYRW+QbPRBwveU36ogg/gZEvoGRTVI55RuLHHR2EtLyRuVH4f0bMBcMD53CEJMBSTrrkg42bmr79OToek6MnxwYMIRg803Y6y6HTOvNC7+bUTCdNVb7D2kKZgebSqK2qg1voHxnmMLeMf/Csi6sS9O18DUjahotfo79SQV7Pa7h21n3G5K0BOrUWMTaH4vY3IsOHjo3fFwr/uJ0KMXGFZgBVcw7lkEZy4A7p0hKhkHB9ldlFMq8jT7lXRz3Jo8VxGmIOWCzDrru1VRg80nIqZa/RPue7LF6+pQveZKyhZg3A80tgydeDiJL5WJ9A8aoBAOPREHassCAwEAAQ==",  \n  "attributes": {\n    "encrypt": true,\n    "decrypt": true,\n    "verify": true,\n    "sign": true,\n    "wrap": true,\n    "unwrap": true,\n    "derive": false,\n    "extractable": false,\n    "modifiable": true,\n    "destroyable": true,\n    "sensitive": true,\n    "copyable": false\n  }\n}\n'})})}),(0,a.jsx)(l.A,{value:"import-public-key",label:"Import PublicKey (only)",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "label": "import_public_key",\n  "algorithm": "RSA",    \n  "publicKey": "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA1fbXG+hHasG7C+mKlgd9xn+VsCJTJgIczGGSEPivGGMW5y1GRnPbZfMOfRVJGmMSLPntFS7Lazmb3U2vyCvWB0ovRtRTOWsInLr8FKaF1Cb4j2R0Rrfh4ZVOvyKdIWvFo5jBPqCMmT7DonKJ/TrFx/IlR1eweLnqK+mSsWUgbgTfq2tPRJBeV3mHDREzl++CtG6BRBBnzi3sb12lxOsoGpoXGUcrOpd+eDjIzD664uYz7eV8b+s8nwNWw38jiGpqiu/MU/wdaWFGht91uWE0NNhV5Vb88Rb+Ge90SP4capDbYN33Q5mSHBLA7yGF6+AgXFGjQfHA8p7cVy5jhKtarVFCN1in0DYj8aKYRW+QbPRBwveU36ogg/gZEvoGRTVI55RuLHHR2EtLyRuVH4f0bMBcMD53CEJMBSTrrkg42bmr79OToek6MnxwYMIRg803Y6y6HTOvNC7+bUTCdNVb7D2kKZgebSqK2qg1voHxnmMLeMf/Csi6sS9O18DUjahotfo79SQV7Pa7h21n3G5K0BOrUWMTaH4vY3IsOHjo3fFwr/uJ0KMXGFZgBVcw7lkEZy4A7p0hKhkHB9ldlFMq8jT7lXRz3Jo8VxGmIOWCzDrru1VRg80nIqZa/RPue7LF6+pQveZKyhZg3A80tgydeDiJL5WJ9A8aoBAOPREHassCAwEAAQ==",  \n  "attributes": {\n    "encrypt": true,\n    "decrypt": true,\n    "verify": true,\n    "sign": true,\n    "wrap": true,\n    "unwrap": true,\n    "derive": false,\n    "extractable": false,\n    "modifiable": true,\n    "destroyable": true,\n    "sensitive": true,\n    "copyable": false\n  }\n}\n'})})})]}),"\n",(0,a.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsx)(r.p,{children:"Use the following API calls to perform cryptographic operations (encryption or key wrapping) using the imported public keys stored in the HSM."}),"\n",(0,a.jsxs)(i.A,{groupId:"import-private-public-key",children:[(0,a.jsxs)(l.A,{value:"encrypt-public-key",label:"Encrypt with PublicKey",default:!0,children:[(0,a.jsx)(r.p,{children:"This command encrypts a payload using the public key imported into the HSM. The encrypted output can only be decrypted using the corresponding private key."}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST"}),": ",(0,a.jsx)(r.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/encrypt",children:"/v1/encrypt"})]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",metastring:"{4}",children:'{\n  "encryptRequest": {\n    "payload": "cGF5bG9hZCB0byBiZSBlbmNyeXB0ZWQ=",\n    "encryptKeyName": "import_public_key",\n    "cipherAlgorithm": "RSA_PADDING_OAEP_WITH_SHA512"\n  }\n}\n'})}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Response"}),":"]}),(0,a.jsx)(r.p,{children:"The response will contain the encryptedPayload, which is the Base64-encoded result of the encryption process."}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "encryptedPayload": "m7FCNVKIZgN78XQiRUlCZs8OAoSzScYLvm+G0L0WiNsE+E6x9iaCKM0DTkzdhKcnG1X6PHLw4kC0dZ1zoa45PFKSfSd42cL0I8Ha6sv0mu7sMcp0jYNcTJvbfZ3NYZNagFxbfMiYGF0xfMshvs355YXzwGqZNko/r6voOwF3s44gy+n0DZdeA6/MqqettI1FZS2Rvnxlqr/lWF3nHqlr4IS1L6sIXCHc7uYQF0bw/vks7h+u9xwwkBt+N5wgRvmGGB2C/qmVDLKYafq3QgCgWo432Usp1U943WQGgikCi1TNd0/L16QZQ4LN9H7oX17xNrm5Yf6xmlli5LgcvesaJ2Z46dK5CORdCQSALRKQRDHzb8O2N27sExZMBzF/K/14bETT9O0rcgI6p5IUnj3KALL9SBGmKNCKCk/U4ttjNFI7PljTpNqMEPQJE4G4xIr/RHrnLToeL1G+gqw1sTx6ke9jxnyGx2S0mo/x67ruZ41TSwGmI68CudHlpRNpNCHVv7JT/oMpXMVB2UDQZYooYbQag6Fi4OU99PVubIVbFqNFk9BRczLyD8YXLC4k/3FEBSPtSFYDnbnCBy6EgCUdnMgjk4P2BWA7goehEk+aSPGdi7xnjxagpxwFskOsXWL5E95B+ftZHp8oJVRQYBH9Ij5dU+x0DJHSMAIwekJWey4="  \n}\n'})})]}),(0,a.jsxs)(l.A,{value:"wrap-public-key",label:"Wrap with PublicKey",children:[(0,a.jsx)(r.p,{children:"Before wrapping, you need to create a symmetric key (e.g., AES) in the HSM. This key will later be encrypted (wrapped) using the previously imported RSA public key."}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST"}),": ",(0,a.jsx)(r.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"/v1/key"})]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n    "label": "key_to_be_wrapped",\n    "algorithm": "AES",\n    "keySize": 256,\n    "attributes": {\n        "encrypt": true,\n        "decrypt": true,\n        "verify": true,\n        "sign": false,\n        "wrap": true,\n        "unwrap": true,\n        "derive": false,\n        "bip32": false,\n        "slip10": false,\n        "extractable": true,\n        "modifiable": true,\n        "destroyable": true,\n        "sensitive": true,\n        "copyable": true\n    }\n}\n'})}),(0,a.jsx)(r.p,{children:(0,a.jsx)(r.strong,{children:"Create Wrap Request (RSA Wraps AES)"})}),(0,a.jsx)(r.p,{children:"This command uses the RSA public key to encrypt (wrap) the AES key. The wrapped key can then be securely transmitted or stored."}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"POST"}),": ",(0,a.jsx)(r.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Synchronous%20Key%20Operations/wrap",children:"/v1/wrap"})]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "wrapKeyRequest": {\n    "keyToBeWrapped": "key_to_be_wrapped",\n    "wrapKeyName": "import_public_key_4",\n    "wrapMethod": "RSA_WRAP_OAEP"\n  }\n}\n'})}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)(r.strong,{children:"Response"}),":"]}),(0,a.jsx)(r.p,{children:"The response will contain the wrappedKey, which is the Base64-encoded encrypted version of the AES key."}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-js",children:'{\n  "wrappedKey": "1B0/R3QbhBXCf1O6gyVKIovkAMwtJSVnBDnC8euzVGkiAnhVkb4V1wqhbUYos93gY6wnxJOgox+u6er35ctNMnOkzT0V3S8aodDEbR0xerjxHuV3RZM7Nlc0QTYL1pJWct0xEvcet9Uaa4fD4v4mfcpKUjC76HTGkZ/qxJFNPOZ1kMjCQV5vDAEyOyf7kM1WUIZHB+1E7o80GNXaRtLCOWvaxArM/ecft+T/0GUDVMuyCxvNehem4LWkUidxoOMVOKUZ+kgzWvJn8jJHO8sC6oibEmLWUprWaXbgqHmwKCGC6US/EqjREZDtz6UTHtmHpCGTKG8owyYQ8LuU4SmfRNyM46s6cR1wpCmUUqZJz8QotKJ+RFDnK5yTePx1/mWCHjGdh2p7VPT06+Y3BW1n8vwG9ji/QSfxXPV0JAPqu4ZZS25fSKMfCul5UqfXMadKeHcXu3Jn8CPGlKh0V0vlKtDs+y2NvdUpGlb76Z9OKFMlguYAUNYWDqaYkCxEInAsaZkD+wefWk3ryQSMylMt6TubSYZZOLYyeijNtyVfRrFdilHJ5XhRMpwatcaOiXalp094bL6fZm46XaYZK5c3fQ5xnzwQDPzyweQa64Obk27C+H2QubUP5DaNcXY/Jv/RiQBfVbps+LKtuLpRzXfL45rbhqWawcHC2Kt4+0H0law="\n}\n'})})]})]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},65537:(e,r,t)=>{t.d(r,{A:()=>j});var n=t(96540),a=t(34164),s=t(65627),i=t(56347),l=t(50372),o=t(30604),c=t(11861),u=t(78749);function p(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function d(e){const{values:r,children:t}=e;return(0,n.useMemo)((()=>{const e=r??function(e){return p(e).map((e=>{let{props:{value:r,label:t,attributes:n,default:a}}=e;return{value:r,label:t,attributes:n,default:a}}))}(t);return function(e){const r=(0,c.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function h(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function y(e){let{queryString:r=!1,groupId:t}=e;const a=(0,i.W6)(),s=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,o.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const r=new URLSearchParams(a.location.search);r.set(s,e),a.replace({...a.location,search:r.toString()})}),[s,a])]}function g(e){const{defaultValue:r,queryString:t=!1,groupId:a}=e,s=d(e),[i,o]=(0,n.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!h({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:r,tabValues:s}))),[c,p]=y({queryString:t,groupId:a}),[g,m]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[a,s]=(0,u.Dv)(t);return[a,(0,n.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:a}),b=(()=>{const e=c??g;return h({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),p(e),m(e)}),[p,m,s]),tabValues:s}}var m=t(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function v(e){let{className:r,block:t,selectedValue:n,selectValue:i,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const r=e.currentTarget,t=o.indexOf(r),a=l[t].value;a!==n&&(c(r),i(a))},p=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;r=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;r=o[t]??o[o.length-1];break}}r?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":t},r),children:l.map((e=>{let{value:r,label:t,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:n===r?0:-1,"aria-selected":n===r,ref:e=>{o.push(e)},onKeyDown:p,onClick:u,...s,className:(0,a.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":n===r}),children:t??r},r)}))})}function f(e){let{lazy:r,children:t,selectedValue:s}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=i.find((e=>e.props.value===s));return e?(0,n.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map(((e,r)=>(0,n.cloneElement)(e,{key:r,hidden:e.props.value!==s})))})}function k(e){const r=g(e);return(0,x.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,x.jsx)(v,{...r,...e}),(0,x.jsx)(f,{...r,...e})]})}function j(e){const r=(0,m.A)();return(0,x.jsx)(k,{...e,children:p(e.children)},String(r))}},79329:(e,r,t)=>{t.d(r,{A:()=>i});t(96540);var n=t(34164);const a={tabItem:"tabItem_Ymn6"};var s=t(74848);function i(e){let{children:r,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(a.tabItem,i),hidden:t,children:r})}}}]);