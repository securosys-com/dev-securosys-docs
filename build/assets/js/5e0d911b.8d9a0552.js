"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[63998],{28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>c});var i=r(96540);const s={},n=i.createContext(s);function a(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(n.Provider,{value:t},e.children)}},60526:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Tutorials/Migrating-MPKI-to-HSM/Delete-Key&Cert","title":"Deletion of Microsoft AD CS keys and certificates","description":"Deleting the Key and Certificate  for Securosys Hardware Security Modules (HSMs)","source":"@site/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Delete-Key&Cert.md","sourceDirName":"Tutorials/Migrating-MPKI-to-HSM","slug":"/Tutorials/Migrating-MPKI-to-HSM/Delete-Key&Cert","permalink":"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Delete-Key&Cert","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Deletion of Microsoft AD CS keys and certificates","sidebar_label":"Delete Key/Certificate","description":"Deleting the Key and Certificate  for Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Backup","permalink":"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Backup-ADCS"},"next":{"title":"Import a private key","permalink":"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Import-PrivKey-toHSM"}}');var s=r(74848),n=r(28453);const a={sidebar_position:2,title:"Deletion of Microsoft AD CS keys and certificates",sidebar_label:"Delete Key/Certificate",description:"Deleting the Key and Certificate  for Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},c="Deleting the Key and Certificate",o={},l=[];function d(e){const t={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"deleting-the-key-and-certificate",children:"Deleting the Key and Certificate"})}),"\n",(0,s.jsx)(t.p,{children:"Locate and remove the key(s) and certificate(s) from the old key storage provider and certificate store."}),"\n",(0,s.jsx)(t.p,{children:"Please note that there may be several keys and certificates involved in case the CA certificate was already renewed."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Locate the old key(s) and certificate(s)"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'certutil -store my myDemoCA\n\nmy "Personal"\n================ Certificate 43 ================\nSerial Number: 3aa837d2cf1289b241b9ee87a5474b4f\nIssuer: CN=myDemoCA\n NotBefore: 10.08.2021 14:14\n NotAfter: 10.08.2026 14:22\nSubject: CN=myDemoCA\nCA Version: V0.0\nSignature matches Public Key\nRoot Certificate: Subject matches Issuer\nCert Hash(sha1): 19f647a3f4e60eabc126d73ef1ef6e9f84224997\n  Key Container = myDemoCA\n  Unique container name: f7717552e9ac0bf2063dc0c18c29c08c_92adcd87-1855-4c11-89be-680e114a784c\n  Provider = Microsoft Software Key Storage Provider\nPrivate key is NOT plain text exportable\nSignature test passed\nCertUtil: -store command completed successfully.\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Stop the CA service"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"net stop certsvc\n\nThe Active Directory Certificate Services service is stopping.\nThe Active Directory Certificate Services service was stopped successfully.\n"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Delete the old certificate(s) from the personal and CA store. Make sure that you reference the right store and use the certificate hash:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'certutil -delstore my 19f647a3f4e60eabc126d73ef1ef6e9f84224997\n\nmy "Personal"\nDeleting Certificate 43: CN=myDemoCA:19f647a3f4e60eabc126d73ef1ef6e9f84224997\nCertUtil: -delstore command completed successfully.\n'})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'certutil -delstore CA 19f647a3f4e60eabc126d73ef1ef6e9f84224997\nCA "Intermediate Certification Authorities"\nDeleting Certificate 54: CN=myDemoCA:19f647a3f4e60eabc126d73ef1ef6e9f84224997\nCertUtil: -delstore command completed successfully.\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Delete the old private key(s). Make sure that you reference the right CSP/KSP store:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'certutil -csp "Microsoft Software Key Storage Provider" -delkey myDemoCA\n\n  myDemoCA\nCertUtil: -delkey command completed successfully.\n'})})]})}function f(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);