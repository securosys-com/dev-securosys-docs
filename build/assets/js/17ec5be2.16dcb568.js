"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[44859],{28453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>o});var n=t(96540);const r={},i=n.createContext(r);function a(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:s},e.children)}},47862:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Tutorials/Blockchain/sign","title":"Create Signature for Ethereum Blockchain","description":"Guide on creating Ethereum blockchain signatures using Securosys Primus HSM, including key generation, address extraction, and signing operations.","source":"@site/tsb/Tutorials/Blockchain/sign.md","sourceDirName":"Tutorials/Blockchain","slug":"/Tutorials/Blockchain/sign","permalink":"/tsb/Tutorials/Blockchain/sign","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Create Signature for Ethereum Blockchain","sidebar_label":"Ethereum Blockchain Signature","description":"Guide on creating Ethereum blockchain signatures using Securosys Primus HSM, including key generation, address extraction, and signing operations.","keywords":["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","Ethereum","blockchain","signature creation","key generation","address extraction","signing operation","SmartKeyAttributes","SKA","TSB","JSON Web Tokens","JWT","mTLS","Mutual TLS","eIDAS","qualified digital certificates","CSR generation","OpenSSL verification"]},"sidebar":"tutorialSidebar","previous":{"title":"Create Master Key (Bitcoin)","permalink":"/tsb/Tutorials/Blockchain/CreateBitcoinMasterKey"},"next":{"title":"Supported Cryptocurrencies","permalink":"/tsb/Tutorials/Blockchain/supported-currency"}}');var r=t(74848),i=t(28453);const a={sidebar_position:0,title:"Create Signature for Ethereum Blockchain",sidebar_label:"Ethereum Blockchain Signature",description:"Guide on creating Ethereum blockchain signatures using Securosys Primus HSM, including key generation, address extraction, and signing operations.",keywords:["cybersecurity","data security","key management","cloud hsm","hsm key management","hsm cloud","hsm as a service","cloud based hsm","hsm digital signature","hsm services","hsm service","hsm","hardware security module","Ethereum","blockchain","signature creation","key generation","address extraction","signing operation","SmartKeyAttributes","SKA","TSB","JSON Web Tokens","JWT","mTLS","Mutual TLS","eIDAS","qualified digital certificates","CSR generation","OpenSSL verification"]},o=void 0,c={},d=[{value:"Create Key",id:"create-key",level:2},{value:"Extract Address",id:"extract-address",level:2},{value:"1. Create Key Response",id:"1-create-key-response",level:3},{value:"2. Get Attributes",id:"2-get-attributes",level:3},{value:"3. Get the address",id:"3-get-the-address",level:3},{value:"Sign a payload",id:"sign-a-payload",level:2},{value:"Verify Signature",id:"verify-signature",level:2}];function l(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"Ethereum has a dedicated signature format which allows to recover the public-key and subsequently the address based on the signature.\nThis format reduces the payload-size of the Transaction and improves speed, dedicated for the Ethereum Blockchain."}),"\n",(0,r.jsx)(s.p,{children:"The following example creates a SKA-Key, extracts the wallets address and produces a valid signature."}),"\n",(0,r.jsx)(s.h2,{id:"create-key",children:"Create Key"}),"\n",(0,r.jsx)(s.p,{children:"Creating a Key on the HSM, which is not destroyable (e.g. cannot be deleted), and uses SmartKeyAttributes."}),"\n",(0,r.jsxs)(s.admonition,{title:"ADDRESS GENERATION",type:"tip",children:[(0,r.jsx)(s.p,{children:"If your subscription Type includes SmartKeyAttributes, the HSM is generating the Wallet-Address for you, by specifying in the request below."}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:'    "addressFormat": {\n        "format": "ETH"\n    },\n'})}),(0,r.jsxs)(s.p,{children:["If you do not have a ",(0,r.jsx)(s.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/smart-key-attributes",children:"SmartKeyAttributes"})," subscription, you must remove the ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"policy"})})," and the ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"addressFormat"})})," from the request below. Be careful, you have to generate the address by yourself!"]})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:"{2,6}",children:'{\n    "label": "ether_Transaction_signing_key",\n    "algorithm": "EC",\n    "curveOid": "1.3.132.0.10",\n    "addressFormat": {\n        "format": "ETH"\n    },\n    "attributes": {\n        "decrypt": false,\n        "sign": true,\n        "unwrap": false,\n        "destroyable": false,\n        "modifiable": true,\n        "derive": true,\n        "bip32": true\n    },\n    "policy": {\n        "keyStatus": {\n            "blocked": false\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:["The SKA-Policy above is empty, which means the request does not need any approvals. For a more comprehensive policy, checkout ",(0,r.jsx)(s.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/smart-key-attributes",children:"this"})," sample."]}),"\n",(0,r.jsx)(s.h2,{id:"extract-address",children:"Extract Address"}),"\n",(0,r.jsx)(s.p,{children:"With an SKA License you have three possibilities to get the wallet-address."}),"\n",(0,r.jsx)(s.h3,{id:"1-create-key-response",children:"1. Create Key Response"}),"\n",(0,r.jsxs)(s.p,{children:["Fetch the address from the ",(0,r.jsx)(s.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/createKey",children:"Create Key Response"})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Response:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:'    "addressTruncated": {\n      "address": "B476FABAAB46013A7DB5193378BABE674166CE61",\n      "format": "ETH"\n    },\n'})}),"\n",(0,r.jsx)(s.h3,{id:"2-get-attributes",children:"2. Get Attributes"}),"\n",(0,r.jsxs)(s.p,{children:["Fetch the address from the ",(0,r.jsx)(s.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/getKeyAttributesWithKeyPassword",children:"Get Key Attributes Response"})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Response:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:'    "addressTruncated": {\n      "address": "B476FABAAB46013A7DB5193378BABE674166CE61",\n      "format": "ETH"\n    },\n'})}),"\n",(0,r.jsx)(s.h3,{id:"3-get-the-address",children:"3. Get the address"}),"\n",(0,r.jsxs)(s.p,{children:["Fetch the address from the ",(0,r.jsx)(s.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/getKeyAddressWithKeyPassword",children:"Get Address Response"})]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Response:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:'{\n  "address": "tHb6uqtGATp9tRkzeLq+Z0FmzmE="\n}\n'})}),"\n",(0,r.jsx)(s.admonition,{title:"Tip",type:"tip",children:(0,r.jsxs)(s.p,{children:["For method 2, 3 you can use ",(0,r.jsx)(s.a,{href:"/tsb/Concepts/key/Derivation/KeyDerivation",children:"temporary key derivation"})," to generate addresses and signatures withouth filling the HSM-Storage."]})}),"\n",(0,r.jsx)(s.h2,{id:"sign-a-payload",children:"Sign a payload"}),"\n",(0,r.jsx)(s.admonition,{title:"tip",type:"tip",children:(0,r.jsxs)(s.p,{children:["Use the ",(0,r.jsx)(s.a,{href:"https://primusdev.cloudshsm.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config#/Keys/getKeyAddressWithKeyPassword",children:"Generate a signature"})," with the request-body below to sign a transaction with the HSM-backed private key."]})}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"singnatureType"})})," tells TSB to produce a valid signature for the Ethereum Blockchain. If the Type ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"ETH"})})," is specified the signature must be ",(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.code,{children:"KECCAK256_WITH_ECDSA"})})," as the ethereum blockchain uses Keccak256 as default."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:"{6,7}",children:'{\n  "signRequest": {\n    "payload": "YXNk",\n    "payloadType": "UNSPECIFIED",\n    "signKeyName": "ether_Transaction_signing_key",\n    "signatureType": "ETH",\n    "signatureAlgorithm": "KECCAK256_WITH_ECDSA"\n  }\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"verify-signature",children:"Verify Signature"}),"\n",(0,r.jsx)(s.p,{children:"The signature can be verified with the etherscans verification tool:"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.a,{href:"https://etherscan.io/verifiedSignatures#",children:"https://etherscan.io/verifiedSignatures#"})," (make sure you have base64 decoded the signature result)"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Etherscan: Verify Success",src:t(95749).A+"",width:"641",height:"842"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},95749:(e,s,t)=>{t.d(s,{A:()=>n});const n=t.p+"assets/images/etherscan_verify_success-73150d7a5b652e3e73f1be34177c67d7.png"}}]);