"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[72761],{19775:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Installation/Installation","title":"Installing Microsoft HGS","description":"Configuring Microsoft HGS with Securosys Hardware Security Modules (HSMs)","source":"@site/ms-hgs/Installation/Installation.md","sourceDirName":"Installation","slug":"/Installation/","permalink":"/ms-hgs/Installation/","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Installing Microsoft HGS","sidebar_label":"3. Installation","description":"Configuring Microsoft HGS with Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"1. Prerequisites","permalink":"/ms-hgs/Installation/prerequisites"},"next":{"title":"2. Installing the API provider","permalink":"/ms-hgs/Installation/Provider"}}');var s=r(74848),a=r(28453);r(65537),r(79329);const i={sidebar_position:1,title:"Installing Microsoft HGS",sidebar_label:"3. Installation",description:"Configuring Microsoft HGS with Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},o="Installation",l={},d=[{value:"Host Guardian Service",id:"host-guardian-service",level:2},{value:"Arhitecture",id:"arhitecture",level:3},{value:"Microsoft HGS installation",id:"microsoft-hgs-installation",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"installation",children:"Installation"})}),"\n",(0,s.jsx)(t.p,{children:"This procedure provides a straightforward integration process."}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["This guide provides an example installation and architecture. Please adapt the parameters and variables according your environment requirements and details. Additionally there are other ways to install HGS. For more details see ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows-server/security/guarded-fabric-shielded-vm/guarded-fabric-manage-hgs",children:"HGS documentation"}),"."]})}),"\n",(0,s.jsx)(t.h2,{id:"host-guardian-service",children:"Host Guardian Service"}),"\n",(0,s.jsxs)(t.p,{children:["For more detail about Microsoft HGS features, Shielded VMs, guarded fabric, guarded hosts, pre-requisites and\ndeployment please read ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows-server/security/guarded-fabric-shielded-vm/guarded-fabric-manage-hgs",children:"Microsoft online documentation"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"This guide provides steps required to integrate Microsoft HGS with Securosys HSM."}),"\n",(0,s.jsx)(t.h3,{id:"arhitecture",children:"Arhitecture"}),"\n",(0,s.jsx)(t.p,{children:"Within this documentation the following virtual machines (VMs) were installed and configured as an example HGS domain."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Create a Windows Server 2019 machine named ",(0,s.jsx)(t.strong,{children:"CONTROL_AD"}),". It becomes your fabric AD domain controller with\ndomain name ",(0,s.jsx)(t.code,{children:"control_am.com"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Create a Windows Server 2019 machine named ",(0,s.jsx)(t.strong,{children:"HOST_GS_AD"}),". It becomes your HGS Server with domain name\n",(0,s.jsx)(t.code,{children:"relecloud.com"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Create a Windows Server 2019 machine named ",(0,s.jsx)(t.strong,{children:"HOST_1"}),". Configure it as a Hyper-V server that will join the\n",(0,s.jsx)(t.code,{children:"control_am"})," domain to become the guarded host."]}),"\n",(0,s.jsxs)(t.li,{children:["Create a Windows Server 2019 machine named ",(0,s.jsx)(t.strong,{children:"HOST_2"}),". Configure it as a Hyper-V server that is used to\ndeploy the VM and this VM is migrated to the guarded host to demonstrate the shielded VM protected by\nHGS server."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Microsoft HGS supports two modes of attestation:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Admin-Trusted Attestation based on Active Directory"}),"\n",(0,s.jsx)(t.li,{children:"TPM Attestation"}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["This guide is used to setup the HGS in Admin Trusted Attestation only. In case you require TPM Attestation, please\nfollow the ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows-server/security/guarded-fabric-shielded-vm/guarded-fabric-manage-hgs",children:"Microsoft online documentation"})," for prerequisites, hardware requirements and deployment information."]})}),"\n",(0,s.jsx)(t.h3,{id:"microsoft-hgs-installation",children:"Microsoft HGS installation"}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["This guide provides a shortened process on how to install Microsoft HGS. For a more detailed guide please see, ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows-server/security/guarded-fabric-shielded-vm/guarded-fabric-deploying-hgs-overview",children:"Deploying the Host Guardian Service"})]})}),"\n",(0,s.jsx)(t.p,{children:"To set up Microsoft HGS with Securosys HSM, please follow the next steps:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Install Active Directory Domain Services on ",(0,s.jsx)(t.strong,{children:"CONTROL_AD"})," and promote this server to Domain Controller."]}),"\n",(0,s.jsxs)(t.li,{children:["Add ",(0,s.jsx)(t.strong,{children:"HOST_1"})," into the ",(0,s.jsx)(t.strong,{children:"control_am"})," domain."]}),"\n",(0,s.jsxs)(t.li,{children:["Log on to the ",(0,s.jsx)(t.strong,{children:"HOST_GS_AD"})," as a user with administrative privileges."]}),"\n",(0,s.jsx)(t.li,{children:"On the HGS Server run the following command in Windows PowerShell console to add the HGS Role."}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"Install-WindowsFeature -Name HostGuardianServiceRole -IncludeManagementTools \u2013Restart\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The server will automatically restart after installing the role.\n5. Log on to the ",(0,s.jsx)(t.strong,{children:"HOST_GS_AD"})," again as a user with administrative privileges.\n6. In an elevated Windows PowerShell console, run the following commands to install the Host Guardian\nService and configure its domain."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$adminPassword = ConvertTo-SecureString -string \"replace_me\" -AsPlainText -force\n\nInstall-HgsServer -HgsDomainName 'relecloud.com' -SafeModeAdministratorPassword $adminPassword -Restart\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The password specified here will only apply to the ",(0,s.jsx)(t.strong,{children:"Directory Services Restore Mode password"})," and will not change the password you log in for ",(0,s.jsx)(t.strong,{children:"Active Directory"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["After the sever restarts, log in as the ",(0,s.jsx)(t.strong,{children:"RELECLOUD"})," domain administrator using the same password you\npreviously used as the local administrator (regardless of the password you specified in the previous step)."]})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var n=r(96540);const s={},a=n.createContext(s);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(a.Provider,{value:t},e.children)}},65537:(e,t,r)=>{r.d(t,{A:()=>j});var n=r(96540),s=r(34164),a=r(65627),i=r(56347),o=r(50372),l=r(30604),d=r(11861),c=r(78749);function u(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:s}}=e;return{value:t,label:r,attributes:n,default:s}}))}(r);return function(e){const t=(0,d.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function m(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function p(e){let{queryString:t=!1,groupId:r}=e;const s=(0,i.W6)(),a=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l.aZ)(a),(0,n.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(s.location.search);t.set(a,e),s.replace({...s.location,search:t.toString()})}),[a,s])]}function f(e){const{defaultValue:t,queryString:r=!1,groupId:s}=e,a=h(e),[i,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:a}))),[d,u]=p({queryString:r,groupId:s}),[f,g]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,a]=(0,c.Dv)(r);return[s,(0,n.useCallback)((e=>{r&&a.set(e)}),[r,a])]}({groupId:s}),v=(()=>{const e=d??f;return m({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{v&&l(v)}),[v]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),g(e)}),[u,g,a]),tabValues:a}}var g=r(9136);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=r(74848);function x(e){let{className:t,block:r,selectedValue:n,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),c=e=>{const t=e.currentTarget,r=l.indexOf(t),s=o[r].value;s!==n&&(d(t),i(s))},u=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;t=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;t=l[r]??l[l.length-1];break}}t?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},t),children:o.map((e=>{let{value:t,label:r,attributes:a}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>{l.push(e)},onKeyDown:u,onClick:c,...a,className:(0,s.A)("tabs__item",v.tabItem,a?.className,{"tabs__item--active":n===t}),children:r??t},t)}))})}function w(e){let{lazy:t,children:r,selectedValue:a}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function S(e){const t=f(e);return(0,b.jsxs)("div",{className:(0,s.A)("tabs-container",v.tabList),children:[(0,b.jsx)(x,{...t,...e}),(0,b.jsx)(w,{...t,...e})]})}function j(e){const t=(0,g.A)();return(0,b.jsx)(S,{...e,children:u(e.children)},String(t))}},79329:(e,t,r)=>{r.d(t,{A:()=>i});r(96540);var n=r(34164);const s={tabItem:"tabItem_Ymn6"};var a=r(74848);function i(e){let{children:t,hidden:r,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,n.A)(s.tabItem,i),hidden:r,children:t})}}}]);