"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[94813],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var r=i(96540);const t={},o=r.createContext(t);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(o.Provider,{value:n},e.children)}},39499:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"Installation/configuration","title":"Docker Encryption Plugin - Installation & Configuration","description":"Installation & Configuration","source":"@site/docker_encryption/Installation/configuration.md","sourceDirName":"Installation","slug":"/Installation/configuration","permalink":"/docker_encryption/Installation/configuration","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Docker Encryption Plugin - Installation & Configuration","sidebar_label":"4. Configuration","description":"Installation & Configuration","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"3. Create A Key","permalink":"/docker_encryption/Installation/createEncryptionKey"},"next":{"title":"Tutorial","permalink":"/docker_encryption/category/tutorial"}}');var t=i(74848),o=i(28453);const s={sidebar_position:3,title:"Docker Encryption Plugin - Installation & Configuration",sidebar_label:"4. Configuration",description:"Installation & Configuration",keywords:["hsm","cloud hsm"]},c="Installation & Configuration",l={},a=[{value:"Securosys Docker Image Encryption Plugin configuration",id:"securosys-docker-image-encryption-plugin-configuration",level:2},{value:"Install the Securosys Docker Image Encryption Plugin binary",id:"install-the-securosys-docker-image-encryption-plugin-binary",level:3},{value:"Install the Securosys Docker Image Encryption Plugin config file",id:"install-the-securosys-docker-image-encryption-plugin-config-file",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"installation--configuration",children:"Installation & Configuration"})}),"\n",(0,t.jsx)(n.h2,{id:"securosys-docker-image-encryption-plugin-configuration",children:"Securosys Docker Image Encryption Plugin configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Create a directory in which the ",(0,t.jsx)(n.code,{children:"ocicrypt.conf"})," configuration file will be stored."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mkdir ${HOME}/Securosys/skopeo\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Note",type:"note",children:(0,t.jsxs)(n.p,{children:["There is no default ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"${BINARY_PATH}"})})," for the skopeo plugin at user level since the skopeo-securosys binary can be put anywhere. In the context of this guide, the plugin ",(0,t.jsx)(n.code,{children:"${BINARY_PATH}"})," is set to be under directory ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"${HOME}/Securosys/skopeo/"})}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"install-the-securosys-docker-image-encryption-plugin-binary",children:"Install the Securosys Docker Image Encryption Plugin binary"}),"\n",(0,t.jsxs)(n.p,{children:["Navigate to the directory where the default Securosys Docker Image Encryption plugin configuration file was downloaded and extracted in ",(0,t.jsx)(n.a,{href:"/docker_encryption/Installation/unpacking#download-securosys-docker-image-encryption-plugin-files",children:"Unpacking - Download Securosys Docker Image Encryption Plugin files"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Copy the skopeo-securosys binary file to the previously created directory."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"cp skopeo-securosys ${BINARY_PATH}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"install-the-securosys-docker-image-encryption-plugin-config-file",children:"Install the Securosys Docker Image Encryption Plugin config file"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"ocicrypt.config"})," file, extracted from the downloaded Securosys Docker Image Encryption configuration files in ",(0,t.jsx)(n.a,{href:"http://localhost:3000/docker_encryption/Installation/unpacking#download-and-install-skopeo",children:"Unpacking - Unzip Securosys Docker Image Encryption Plugin configuration file"})," is used to configure the Securosys Docker Image Encryption Plugin connection between the OCIcrypt CLI and Securosys ",(0,t.jsx)(n.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/transaction-security-broker",children:"Transaction Security Broker"})," as linking element to the ",(0,t.jsx)(n.a,{href:"/cloudhsm/overview",children:"CloudHSM"})," or on-prem Primus HSM."]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"ocicrypt.config"})," file contains:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Transaction Security Broker (TSB) connection parameters","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"URL"}),"\n",(0,t.jsx)(n.li,{children:"authentication method"}),"\n",(0,t.jsx)(n.li,{children:"authentication token / TLS parameters"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Encryption key reference (label, password)"}),"\n",(0,t.jsxs)(n.li,{children:["Path to ",(0,t.jsx)(n.code,{children:"skopeo-securosy"})," plugin"]}),"\n"]}),"\n",(0,t.jsxs)(n.admonition,{title:"TIP",type:"tip",children:[(0,t.jsxs)(n.p,{children:["Add the ",(0,t.jsx)(n.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/transaction-security-broker",children:"TSB"})," connection parameters provided by the Securosys CloudHSM operations team or by your HSM/TSB administrator."]}),(0,t.jsxs)(n.p,{children:["Please replace the link ",(0,t.jsx)(n.code,{children:"<TSB_APIendpoint>"})," ",(0,t.jsx)(n.em,{children:"below"}),"  by a ",(0,t.jsx)(n.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"TSBaaS - Connectivity Details"})," for accurate API-Endpoint URI."]})]}),"\n",(0,t.jsxs)(n.p,{children:["Navigate to the directory where the default Securosys Docker Image Encryption plugin configuration file was downloaded and extracted in ",(0,t.jsx)(n.a,{href:"/docker_encryption/Installation/unpacking#unzip-securosys-docker-image-encryption-plugin-configuration-file",children:"Unpacking - Unzip Securosys Docker Image Encryption Plugin configuration file"}),"."]}),"\n",(0,t.jsx)(n.admonition,{title:"NOTE",type:"note",children:(0,t.jsxs)(n.p,{children:["There is no default ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"${CONFIG_PATH}"})})," for the skopeo plugin at user level since the skopeo- securosys binary can be put anywhere. In the context of this guide, the plugin config ",(0,t.jsx)(n.code,{children:"${CONFIG_PATH}"})," is to be under directory ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"${HOME}/Securosys/skopeo/"})}),"."]})}),"\n",(0,t.jsx)(n.p,{children:"Copy the ocicrypt.conf file to the previously created directory."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"cp ocicrypt.conf ${CONFIG_PATH}\n"})}),"\n",(0,t.jsx)(n.p,{children:"The ocicrypt.conf file is used to configure the Securosys Docker Image Encryption Plugin."}),"\n",(0,t.jsxs)(n.p,{children:["The default ocicrypt.conf file can be seen below, please adapt the parameters ",(0,t.jsx)(n.code,{children:"pathToExecutable"}),", ",(0,t.jsx)(n.code,{children:"-cipher-algorithm"}),", ",(0,t.jsx)(n.code,{children:"tsb-api-endpoint"}),", ",(0,t.jsx)(n.code,{children:"-auth"}),", ",(0,t.jsx)(n.code,{children:"-token"}),", ",(0,t.jsx)(n.code,{children:"-keyOperationToken"}),", ",(0,t.jsx)(n.code,{children:"-publicKey"}),", ",(0,t.jsx)(n.code,{children:"-privateKey"})," according to your environment:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",metastring:"{5,7,8,9,10,11,12,13,14,15}",children:'{ \n    "key-providers": { \n        "securosys_encryption": { \n            "cmd": { \n            "path":"/<pathToExecutable>/Skopeo-securosys",\n            "args":  [ \n                "-cipher-algorithm <yourCipherAlgorithm>",\n                "-tsb-api-endpoint <TSB_APIendpoint>",\n                "-auth <TOKEN>",\n                "-token <yourToken>",\n                "-certpath <PathToCrt>",\n                "-keypath <PathToKey>",\n                "-keyOperationToken <TSB-TOKEN>",\n                "-publicKey <PUBLIC_KEY>",\n                "-privateKey <PRIVATE_KEY>"\n                ] \n            } \n        } \n    } \n} \n'})}),"\n",(0,t.jsx)(n.p,{children:"Please see below the configuration parameters:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Configuration Parameters:"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Description"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"path":"',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<pathToExecutable>"})}),'/skopeo-securosys",']}),(0,t.jsxs)(n.td,{children:["Replace the variable with your path to the ",(0,t.jsx)(n.code,{children:"securosys-encryption"})," plugin binary, i.e. ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"{BINARY_PATH}"})}),". The naming of the plugin must stay the same!"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-cipher-algorithm ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<yourCipherAlgorithm>"})}),'",']}),(0,t.jsxs)(n.td,{children:["Replace the variable with the Cipher Algorithm of your encryption key. Possible values: ",(0,t.jsx)("br",{})," - RSA"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-tsb-api-endpoint ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<TSB_APIendpoint>"})}),'",']}),(0,t.jsxs)(n.td,{children:["Replace the variable with your TSB endpoint URI.  Visit ",(0,t.jsx)(n.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"Securosys CloudHSM Connectivity Details"})," for CloudHSM TSB as a Service deployments."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<TOKEN>"})}),'",']}),(0,t.jsxs)(n.td,{children:["Specifies the authentication type. Keep the value as: ",(0,t.jsx)("br",{})," - TOKEN for JWT based authentication ",(0,t.jsx)("br",{})," - CERT for mTLS"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-token ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<yourToken>"})}),'"']}),(0,t.jsxs)(n.td,{children:['Replace the variable with your TSB JWT authentication token.  For "-auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"TOKEN"})}),'": Replace the variable with your own TSB JWT token. Omit entirely in case of "auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"CERT"})}),'" (mTLS)']})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-certpath ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<PathToCrt>"})}),'"']}),(0,t.jsxs)(n.td,{children:['For "auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"CERT"})}),'": ',(0,t.jsx)("br",{})," Provide the full path of the server certificate file. ",(0,t.jsx)("br",{}),' Omit entirely in case of "auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"TOKEN"})}),'"']})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-keypath ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<PathToKey>"})}),'"']}),(0,t.jsxs)(n.td,{children:['For "auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"CERT"})}),'": ',(0,t.jsx)("br",{}),"Provide the full path of the client key file. ",(0,t.jsx)("br",{}),'Omit entirely in case of "auth ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"TOKEN"})}),'".']})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-keyOperationToken ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<TSB-TOKEN>"})}),'"']}),(0,t.jsxs)(n.td,{children:["Additional authentication for TSB, set correct api key value for specific operation. This is optional and will not break existing deployments. For more info visit ",(0,t.jsx)(n.a,{href:"/tsb/Tutorials/TransactionSecurityBroker/PrimusAuthorizationApp/approver-mangement-api",children:"page"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-publicKey ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<PUBLIC_KEY>"})}),'"']}),(0,t.jsx)(n.td,{children:"The public key (base64 encoded) that belongs to the private key used to calculate the signature."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:['"-privateKey ',(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"<PRIVATE_KEY>"})}),'"']}),(0,t.jsx)(n.td,{children:"Private key (base64 encoded) used to calculate the signature."})]})]})]}),"\n",(0,t.jsx)(n.admonition,{title:"NOTE",type:"note",children:(0,t.jsxs)(n.p,{children:["When utilizing ",(0,t.jsx)(n.a,{href:"../../cloudhsm/overview",children:"CloudHSM service"}),", refer to ",(0,t.jsx)(n.a,{href:"/connectivity-details/cloudhsm-connectivity-details",children:"Cloud Connectivity Details"})," for accurate API-Endpoint URI. For on-premise deployments, verify API-Endpoint URI with your administrator, ontact your service administrator for authentication credentials in any setup (on-prem or cloud)."]})}),"\n",(0,t.jsx)(n.p,{children:"Example using JWT-based authentication, for key without password:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'{ \n    "key-providers": { \n        "securosys\\_encryption": { \n            "cmd": { \n                "path":"/home/securosys/skopeo/securosys\\_encryption", \n                "args": [ \n                    "-key-label SecurosysEncKey01", \n                    `"-cipher-algorithm RSA",  \n                    "-tsb-api-endpoint https://primusdev.cloudshsm.com",  \n                    "-auth TOKEN",  \n                    "-token ergq0ejgadjlfkgjaldfjgaodf9gjad0f9hgadfhgadhfogiah\u2026" ],\n                    "-keyOperationToken <tsb-x-token_...>",\n                    "-publicKey <MIIBIjANBgkqhk...>",\n                    "-privateKey <MIIEvgIBADANBgkqhkiG9w0BAQE...>" \n            }\n        } \n    } \n} \n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);