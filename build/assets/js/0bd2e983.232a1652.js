"use strict";(self.webpackChunksecurosys_docs=self.webpackChunksecurosys_docs||[]).push([[86662],{28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var r=i(96540);const s={},n=r.createContext(s);function o(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(n.Provider,{value:t},e.children)}},72457:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Tutorials/Migrating-MPKI-to-HSM/Migrating-MPKI-toHSM","title":"Migrating an AD CS private key to the HSM","description":"Migrating a Microsoft AD CS private key to Securosys Hardware Security Modules (HSMs)","source":"@site/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Migrating-MPKI-toHSM.md","sourceDirName":"Tutorials/Migrating-MPKI-to-HSM","slug":"/Tutorials/Migrating-MPKI-to-HSM/Migrating-MPKI-toHSM","permalink":"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Migrating-MPKI-toHSM","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1741162132000,"sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Migrating an AD CS private key to the HSM","sidebar_label":"Overview","description":"Migrating a Microsoft AD CS private key to Securosys Hardware Security Modules (HSMs)","keywords":["hsm","cloud hsm"]},"sidebar":"tutorialSidebar","previous":{"title":"Key Migration","permalink":"/ms-pki-adcs/category/key-migration"},"next":{"title":"Backup","permalink":"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Backup-ADCS"}}');var s=i(74848),n=i(28453);const o={sidebar_position:0,title:"Migrating an AD CS private key to the HSM",sidebar_label:"Overview",description:"Migrating a Microsoft AD CS private key to Securosys Hardware Security Modules (HSMs)",keywords:["hsm","cloud hsm"]},a="How to migrate a private key to the HSM?",l={},c=[];function d(e){const t={a:"a",admonition:"admonition",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"how-to-migrate-a-private-key-to-the-hsm",children:"How to migrate a private key to the HSM?"})}),"\n",(0,s.jsx)(t.p,{children:"There are several ways to migrate an existing Microsoft Certification Authority (AD CS) to use the private keys from the Primus HSM or CloudHSM service, either:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Migrating the existing private key(s) and certificate from the Microsoft CSP or CNG/KSP to the Primus HSM CNG/KSP key storage provider. Requirement: private key must be exportable in wrapped format, e.g. PKCS#8."}),"\n",(0,s.jsx)(t.li,{children:"Using the existing private key and renew the certificate and private key, storing them on Primus HSM CNG/KSP."}),"\n",(0,s.jsx)(t.li,{children:"Setting up a new AD CS instance (side-by-side), e.g. to use newer algorithms."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Migrating existing AD CS key material from CSP or CNG/KSP to Securosys Primus HSM CNG/KSP requires the following steps (valid for Windows Server 2012R2/2016/2019):"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Install Securosys Primus HSM and CNG/KSP Provider Software (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Installation/Provider-Setup",children:"Installing CNG Provider"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Backup AD CS including private key and configuration (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Backup-ADCS",children:"Backup AD CS"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Delete the key(s) and certificate(s) from the old key store (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Delete-Key&Cert",children:"Delete the Key and Certificate"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Import the private key to your Primus HSM or CloudHSM (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Import-PrivKey-toHSM",children:"Import Private Key to Primus HSM/CloudHSM"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Reconfigure the AD CS to use the key from the new location (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Reconfigure-ADCS-Registry",children:"Reconfigure AD CS Registry"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Test and cleanup procedures (see ",(0,s.jsx)(t.a,{href:"/ms-pki-adcs/Tutorials/Migrating-MPKI-to-HSM/Test&Cleanup",children:"Test and Cleanup"}),")"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"For further information refer to the guidelines provided by Microsoft, e.g.:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://techcommunity.microsoft.com/t5/itops-talk-blog/step-by-step-migrating-the-active-directory-certificate-service/ba-p/697674",children:"Step by Step Migrating AD CS"})}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsxs)(t.p,{children:["The following examples are related to the example ",(0,s.jsx)(t.strong,{children:"Standalone root CA"})," setup in this guide. Migrations of operational CAs should be tested thoroughly in a lab environment and are not covered in this guide."]})})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);